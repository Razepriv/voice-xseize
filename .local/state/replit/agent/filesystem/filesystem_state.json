{"file_contents":{"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ThemeToggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTheme } from \"@/contexts/ThemeContext\";\n\nexport function ThemeToggle() {\n  const { theme, toggleTheme } = useTheme();\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      data-testid=\"button-theme-toggle\"\n      aria-label=\"Toggle theme\"\n    >\n      {theme === \"light\" ? (\n        <Moon className=\"h-5 w-5\" />\n      ) : (\n        <Sun className=\"h-5 w-5\" />\n      )}\n    </Button>\n  );\n}\n","size_bytes":535},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":483},"server/storage.ts":{"content":"// Reference: javascript_log_in_with_replit and javascript_database integrations\nimport {\n  users,\n  organizations,\n  aiAgents,\n  phoneNumbers,\n  leads,\n  calls,\n  knowledgeBase,\n  usageTracking,\n  type User,\n  type UpsertUser,\n  type AiAgent,\n  type InsertAiAgent,\n  type CreateAiAgentInput,\n  type UpdateAiAgentInput,\n  type PhoneNumber,\n  type InsertPhoneNumber,\n  type Lead,\n  type InsertLead,\n  type Call,\n  type InsertCall,\n  type KnowledgeBase,\n  type InsertKnowledgeBase,\n  type CreateKnowledgeBaseInput,\n  type UpdateKnowledgeBaseInput,\n  type UsageTracking,\n  type InsertUsageTracking,\n  type DashboardMetrics,\n  type CallMetrics,\n  type AgentPerformance,\n  type AnalyticsMetrics,\n  type BillingMetrics,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc, gte, sql } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations (required for Replit Auth)\n  getUser(id: string, organizationId?: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  getUsersByOrganization(organizationId: string): Promise<User[]>;\n\n  // Organization operations\n  upsertOrganization(org: { name: string; domain: string }): Promise<{ id: string; name: string; domain: string | null }>;\n\n  // AI Agent operations (tenant-safe types - never accept organizationId from client)\n  getAIAgents(organizationId: string): Promise<AiAgent[]>;\n  getAIAgent(id: string, organizationId: string): Promise<AiAgent | undefined>;\n  createAIAgent(agent: InsertAiAgent): Promise<AiAgent>;\n  updateAIAgent(id: string, organizationId: string, agent: UpdateAiAgentInput): Promise<AiAgent | undefined>;\n  deleteAIAgent(id: string, organizationId: string): Promise<boolean>;\n\n  // Phone Number operations\n  getPhoneNumbers(organizationId: string): Promise<PhoneNumber[]>;\n  getPhoneNumber(id: string, organizationId: string): Promise<PhoneNumber | undefined>;\n  createPhoneNumber(phone: InsertPhoneNumber): Promise<PhoneNumber>;\n  updatePhoneNumber(id: string, organizationId: string, phone: Partial<InsertPhoneNumber>): Promise<PhoneNumber | undefined>;\n\n  // Lead operations\n  getLeads(organizationId: string): Promise<Lead[]>;\n  getLead(id: string, organizationId: string): Promise<Lead | undefined>;\n  createLead(lead: InsertLead): Promise<Lead>;\n  createLeadsBulk(leads: InsertLead[], organizationId: string): Promise<Lead[]>;\n  updateLead(id: string, organizationId: string, lead: Partial<InsertLead>): Promise<Lead | undefined>;\n\n  // Call operations\n  getCalls(organizationId: string): Promise<Call[]>;\n  getCallsByAgent(agentId: string, organizationId: string): Promise<Call[]>;\n  getCall(id: string, organizationId: string): Promise<Call | undefined>;\n  createCall(call: InsertCall): Promise<Call>;\n  updateCall(id: string, organizationId: string, call: Partial<InsertCall>): Promise<Call | undefined>;\n\n  // Knowledge Base operations (tenant-safe types)\n  getKnowledgeBase(organizationId: string): Promise<KnowledgeBase[]>;\n  getKnowledgeBaseByAgent(agentId: string, organizationId: string): Promise<KnowledgeBase[]>;\n  getKnowledgeBaseItem(id: string, organizationId: string): Promise<KnowledgeBase | undefined>;\n  createKnowledgeBase(knowledge: InsertKnowledgeBase): Promise<KnowledgeBase>;\n  updateKnowledgeBase(id: string, organizationId: string, knowledge: UpdateKnowledgeBaseInput): Promise<KnowledgeBase | undefined>;\n  deleteKnowledgeBase(id: string, organizationId: string): Promise<boolean>;\n\n  // Usage Tracking operations\n  getUsageTracking(organizationId: string, daysAgo?: number): Promise<UsageTracking[]>;\n  createUsageTracking(usage: InsertUsageTracking): Promise<UsageTracking>;\n\n  // Analytics operations\n  getDashboardMetrics(organizationId: string): Promise<DashboardMetrics>;\n  getAnalyticsMetrics(organizationId: string, daysAgo: number): Promise<AnalyticsMetrics>;\n  getCallMetrics(organizationId: string, daysAgo: number): Promise<CallMetrics[]>;\n  getAgentPerformance(organizationId: string, daysAgo: number): Promise<AgentPerformance[]>;\n  \n  // Billing operations\n  getBillingMetrics(organizationId: string): Promise<BillingMetrics>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations\n  async getUser(id: string, organizationId?: string): Promise<User | undefined> {\n    if (organizationId) {\n      const [user] = await db.select().from(users)\n        .where(and(eq(users.id, id), eq(users.organizationId, organizationId)));\n      return user || undefined;\n    }\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  async getUsersByOrganization(organizationId: string): Promise<User[]> {\n    return await db.select().from(users).where(eq(users.organizationId, organizationId));\n  }\n\n  // Organization operations\n  async upsertOrganization(org: { name: string; domain: string }): Promise<{ id: string; name: string; domain: string | null }> {\n    const [existingOrg] = await db.select().from(organizations).where(eq(organizations.domain, org.domain));\n    if (existingOrg) {\n      return existingOrg;\n    }\n    const [newOrg] = await db.insert(organizations).values(org).returning();\n    return newOrg;\n  }\n\n  // AI Agent operations\n  async getAIAgents(organizationId: string): Promise<AiAgent[]> {\n    return await db.select().from(aiAgents)\n      .where(eq(aiAgents.organizationId, organizationId))\n      .orderBy(desc(aiAgents.createdAt));\n  }\n\n  async getAIAgent(id: string, organizationId: string): Promise<AiAgent | undefined> {\n    const [agent] = await db.select().from(aiAgents)\n      .where(and(eq(aiAgents.id, id), eq(aiAgents.organizationId, organizationId)));\n    return agent || undefined;\n  }\n\n  async createAIAgent(agent: InsertAiAgent): Promise<AiAgent> {\n    const [newAgent] = await db.insert(aiAgents).values(agent).returning();\n    return newAgent;\n  }\n\n  async updateAIAgent(id: string, organizationId: string, agent: UpdateAiAgentInput): Promise<AiAgent | undefined> {\n    // Only update fields from validated input (organizationId excluded by type system)\n    const [updated] = await db\n      .update(aiAgents)\n      .set({ ...agent, updatedAt: new Date() })\n      .where(and(eq(aiAgents.id, id), eq(aiAgents.organizationId, organizationId)))\n      .returning();\n    return updated || undefined;\n  }\n\n  async deleteAIAgent(id: string, organizationId: string): Promise<boolean> {\n    const result = await db\n      .delete(aiAgents)\n      .where(and(eq(aiAgents.id, id), eq(aiAgents.organizationId, organizationId)))\n      .returning();\n    return result.length > 0;\n  }\n\n  // Phone Number operations\n  async getPhoneNumbers(organizationId: string): Promise<PhoneNumber[]> {\n    return await db.select().from(phoneNumbers)\n      .where(eq(phoneNumbers.organizationId, organizationId))\n      .orderBy(desc(phoneNumbers.createdAt));\n  }\n\n  async getPhoneNumber(id: string, organizationId: string): Promise<PhoneNumber | undefined> {\n    const [phone] = await db.select().from(phoneNumbers)\n      .where(and(eq(phoneNumbers.id, id), eq(phoneNumbers.organizationId, organizationId)));\n    return phone || undefined;\n  }\n\n  async createPhoneNumber(phone: InsertPhoneNumber): Promise<PhoneNumber> {\n    const [newPhone] = await db.insert(phoneNumbers).values(phone).returning();\n    return newPhone;\n  }\n\n  async updatePhoneNumber(id: string, organizationId: string, phone: Partial<InsertPhoneNumber>): Promise<PhoneNumber | undefined> {\n    const [updated] = await db\n      .update(phoneNumbers)\n      .set({ ...phone, updatedAt: new Date() })\n      .where(and(eq(phoneNumbers.id, id), eq(phoneNumbers.organizationId, organizationId)))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Lead operations\n  async getLeads(organizationId: string): Promise<Lead[]> {\n    return await db.select().from(leads)\n      .where(eq(leads.organizationId, organizationId))\n      .orderBy(desc(leads.createdAt));\n  }\n\n  async getLead(id: string, organizationId: string): Promise<Lead | undefined> {\n    const [lead] = await db.select().from(leads)\n      .where(and(eq(leads.id, id), eq(leads.organizationId, organizationId)));\n    return lead || undefined;\n  }\n\n  async createLead(lead: InsertLead): Promise<Lead> {\n    const [newLead] = await db.insert(leads).values(lead).returning();\n    return newLead;\n  }\n\n  async createLeadsBulk(leadsData: InsertLead[], organizationId: string): Promise<Lead[]> {\n    if (leadsData.length === 0) return [];\n    const safeData = leadsData.map(lead => ({ ...lead, organizationId }));\n    return await db.insert(leads).values(safeData).returning();\n  }\n\n  async updateLead(id: string, organizationId: string, lead: Partial<InsertLead>): Promise<Lead | undefined> {\n    const [updated] = await db\n      .update(leads)\n      .set({ ...lead, updatedAt: new Date() })\n      .where(and(eq(leads.id, id), eq(leads.organizationId, organizationId)))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Call operations\n  async getCalls(organizationId: string): Promise<Call[]> {\n    return await db.select().from(calls)\n      .where(eq(calls.organizationId, organizationId))\n      .orderBy(desc(calls.createdAt));\n  }\n\n  async getCallsByAgent(agentId: string, organizationId: string): Promise<Call[]> {\n    return await db.select().from(calls).where(\n      and(\n        eq(calls.organizationId, organizationId),\n        eq(calls.agentId, agentId)\n      )\n    ).orderBy(desc(calls.createdAt));\n  }\n\n  async getCall(id: string, organizationId: string): Promise<Call | undefined> {\n    const [call] = await db.select().from(calls)\n      .where(and(eq(calls.id, id), eq(calls.organizationId, organizationId)));\n    return call || undefined;\n  }\n\n  async createCall(call: InsertCall): Promise<Call> {\n    const [newCall] = await db.insert(calls).values(call).returning();\n    return newCall;\n  }\n\n  async updateCall(id: string, organizationId: string, call: Partial<InsertCall>): Promise<Call | undefined> {\n    const [updated] = await db\n      .update(calls)\n      .set({ ...call, updatedAt: new Date() })\n      .where(and(eq(calls.id, id), eq(calls.organizationId, organizationId)))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Knowledge Base operations\n  async getKnowledgeBase(organizationId: string): Promise<KnowledgeBase[]> {\n    return await db.select().from(knowledgeBase)\n      .where(eq(knowledgeBase.organizationId, organizationId))\n      .orderBy(desc(knowledgeBase.createdAt));\n  }\n\n  async getKnowledgeBaseByAgent(agentId: string, organizationId: string): Promise<KnowledgeBase[]> {\n    return await db.select().from(knowledgeBase)\n      .where(and(eq(knowledgeBase.agentId, agentId), eq(knowledgeBase.organizationId, organizationId)));\n  }\n\n  async createKnowledgeBase(knowledge: InsertKnowledgeBase): Promise<KnowledgeBase> {\n    const [newKnowledge] = await db.insert(knowledgeBase).values(knowledge).returning();\n    return newKnowledge;\n  }\n\n  async getKnowledgeBaseItem(id: string, organizationId: string): Promise<KnowledgeBase | undefined> {\n    const [item] = await db.select().from(knowledgeBase)\n      .where(and(eq(knowledgeBase.id, id), eq(knowledgeBase.organizationId, organizationId)));\n    return item || undefined;\n  }\n\n  async updateKnowledgeBase(id: string, organizationId: string, knowledge: UpdateKnowledgeBaseInput): Promise<KnowledgeBase | undefined> {\n    const [updated] = await db\n      .update(knowledgeBase)\n      .set({ ...knowledge, updatedAt: new Date() })\n      .where(and(eq(knowledgeBase.id, id), eq(knowledgeBase.organizationId, organizationId)))\n      .returning();\n    return updated || undefined;\n  }\n\n  async deleteKnowledgeBase(id: string, organizationId: string): Promise<boolean> {\n    const result = await db\n      .delete(knowledgeBase)\n      .where(and(eq(knowledgeBase.id, id), eq(knowledgeBase.organizationId, organizationId)))\n      .returning();\n    return result.length > 0;\n  }\n\n  // Usage Tracking operations\n  async getUsageTracking(organizationId: string, daysAgo: number = 30): Promise<UsageTracking[]> {\n    const dateThreshold = new Date();\n    dateThreshold.setDate(dateThreshold.getDate() - daysAgo);\n\n    return await db.select().from(usageTracking)\n      .where(and(\n        eq(usageTracking.organizationId, organizationId),\n        gte(usageTracking.date, dateThreshold)\n      ))\n      .orderBy(desc(usageTracking.date));\n  }\n\n  async createUsageTracking(usage: InsertUsageTracking): Promise<UsageTracking> {\n    const [newUsage] = await db.insert(usageTracking).values(usage).returning();\n    return newUsage;\n  }\n\n  // Analytics operations\n  async getDashboardMetrics(organizationId: string): Promise<DashboardMetrics> {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    // Get call statistics with proper null handling\n    const [callStats] = await db\n      .select({\n        totalCalls: sql<number>`count(*)::int`,\n        avgDuration: sql<number>`coalesce(avg(${calls.duration}), 0)::int`,\n        todayCalls: sql<number>`count(case when ${calls.createdAt} >= ${today} then 1 end)::int`,\n        successfulCalls: sql<number>`count(case when ${calls.outcome} = 'success' then 1 end)::int`,\n      })\n      .from(calls)\n      .where(eq(calls.organizationId, organizationId));\n\n    // Get agent statistics\n    const [agentStats] = await db\n      .select({\n        totalAgents: sql<number>`count(*)::int`,\n        activeAgents: sql<number>`count(case when ${aiAgents.status} = 'active' then 1 end)::int`,\n      })\n      .from(aiAgents)\n      .where(eq(aiAgents.organizationId, organizationId));\n\n    // Get today's usage cost with proper aggregation\n    const [todayUsage] = await db\n      .select({\n        cost: sql<number>`coalesce(sum(${usageTracking.totalCost}), 0)`,\n      })\n      .from(usageTracking)\n      .where(and(\n        eq(usageTracking.organizationId, organizationId),\n        gte(usageTracking.date, today)\n      ));\n\n    const totalCalls = callStats?.totalCalls ?? 0;\n    const successfulCalls = callStats?.successfulCalls ?? 0;\n\n    return {\n      totalCalls,\n      totalAgents: agentStats?.totalAgents ?? 0,\n      activeAgents: agentStats?.activeAgents ?? 0,\n      successRate: totalCalls > 0 ? (successfulCalls / totalCalls) * 100 : 0,\n      conversationsToday: callStats?.todayCalls ?? 0,\n      usageCostToday: todayUsage?.cost ?? 0,\n      avgCallDuration: callStats?.avgDuration ?? 0,\n    };\n  }\n\n  async getAnalyticsMetrics(organizationId: string, daysAgo: number): Promise<AnalyticsMetrics> {\n    const dateThreshold = new Date();\n    dateThreshold.setDate(dateThreshold.getDate() - daysAgo);\n\n    const [callStats] = await db\n      .select({\n        totalCalls: sql<number>`count(*)::int`,\n      })\n      .from(calls)\n      .where(and(\n        eq(calls.organizationId, organizationId),\n        gte(calls.createdAt, dateThreshold)\n      ));\n\n    const [leadStats] = await db\n      .select({\n        totalLeads: sql<number>`count(*)::int`,\n        contacted: sql<number>`count(case when ${leads.lastContactedAt} is not null then 1 end)::int`,\n        converted: sql<number>`count(case when ${leads.status} = 'converted' then 1 end)::int`,\n      })\n      .from(leads)\n      .where(and(\n        eq(leads.organizationId, organizationId),\n        gte(leads.createdAt, dateThreshold)\n      ));\n\n    const totalLeads = leadStats?.totalLeads ?? 0;\n    const contacted = leadStats?.contacted ?? 0;\n    const converted = leadStats?.converted ?? 0;\n\n    return {\n      totalCalls: callStats?.totalCalls ?? 0,\n      totalLeads,\n      responseRate: totalLeads > 0 ? (contacted / totalLeads) * 100 : 0,\n      conversionRate: totalLeads > 0 ? (converted / totalLeads) * 100 : 0,\n    };\n  }\n\n  async getCallMetrics(organizationId: string, daysAgo: number): Promise<CallMetrics[]> {\n    const dateThreshold = new Date();\n    dateThreshold.setDate(dateThreshold.getDate() - daysAgo);\n\n    const metrics = await db\n      .select({\n        date: sql<string>`date(${calls.createdAt})`,\n        calls: sql<number>`count(*)::int`,\n        duration: sql<number>`coalesce(sum(${calls.duration}), 0)::int`,\n        successful: sql<number>`count(case when ${calls.outcome} = 'success' then 1 end)::int`,\n      })\n      .from(calls)\n      .where(and(\n        eq(calls.organizationId, organizationId),\n        gte(calls.createdAt, dateThreshold)\n      ))\n      .groupBy(sql`date(${calls.createdAt})`)\n      .orderBy(sql`date(${calls.createdAt})`);\n\n    return metrics;\n  }\n\n  async getAgentPerformance(organizationId: string, daysAgo: number): Promise<AgentPerformance[]> {\n    const dateThreshold = new Date();\n    dateThreshold.setDate(dateThreshold.getDate() - daysAgo);\n\n    const performance = await db\n      .select({\n        agentId: aiAgents.id,\n        agentName: aiAgents.name,\n        totalCalls: sql<number>`count(${calls.id})::int`,\n        successfulCalls: sql<number>`count(case when ${calls.outcome} = 'success' then 1 end)::int`,\n        averageDuration: sql<number>`coalesce(avg(${calls.duration}), 0)::int`,\n        avgRating: sql<number>`coalesce(avg(${aiAgents.avgRating}), 0)`,\n      })\n      .from(aiAgents)\n      .leftJoin(calls, and(\n        eq(calls.agentId, aiAgents.id),\n        gte(calls.createdAt, dateThreshold)\n      ))\n      .where(eq(aiAgents.organizationId, organizationId))\n      .groupBy(aiAgents.id, aiAgents.name, aiAgents.avgRating);\n\n    return performance.map(p => ({\n      agentId: p.agentId,\n      agentName: p.agentName,\n      totalCalls: p.totalCalls,\n      successfulCalls: p.successfulCalls,\n      averageDuration: p.averageDuration,\n      successRate: p.totalCalls > 0 ? (p.successfulCalls / p.totalCalls) * 100 : 0,\n      avgRating: p.avgRating,\n    }));\n  }\n\n  async getBillingMetrics(organizationId: string): Promise<BillingMetrics> {\n    const now = new Date();\n    const currentMonthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n    const previousMonthStart = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    const previousMonthEnd = new Date(now.getFullYear(), now.getMonth(), 0, 23, 59, 59);\n\n    // Markup per minute in USD ($0.023 or 2 rupees converted)\n    const MARKUP_PER_MINUTE = 0.023;\n\n    // Current month metrics\n    const [currentMonth] = await db\n      .select({\n        totalMinutes: sql<number>`coalesce(sum(${calls.duration}) / 60.0, 0)`,\n        totalCalls: sql<number>`count(*)::int`,\n        exotelCost: sql<number>`coalesce(sum(${calls.exotelCostPerMinute} * ${calls.duration} / 60.0), 0)`,\n        bolnaCost: sql<number>`coalesce(sum(${calls.bolnaCostPerMinute} * ${calls.duration} / 60.0), 0)`,\n      })\n      .from(calls)\n      .where(and(\n        eq(calls.organizationId, organizationId),\n        gte(calls.createdAt, currentMonthStart)\n      ));\n\n    const currentTotalMinutes = currentMonth?.totalMinutes ?? 0;\n    const currentExotelCost = currentMonth?.exotelCost ?? 0;\n    const currentBolnaCost = currentMonth?.bolnaCost ?? 0;\n    const currentMarkupCost = currentTotalMinutes * MARKUP_PER_MINUTE;\n    const currentTotalCost = currentExotelCost + currentBolnaCost + currentMarkupCost;\n\n    // Previous month metrics\n    const [previousMonth] = await db\n      .select({\n        totalMinutes: sql<number>`coalesce(sum(${calls.duration}) / 60.0, 0)`,\n        totalCost: sql<number>`coalesce(sum((${calls.exotelCostPerMinute} + ${calls.bolnaCostPerMinute} + ${MARKUP_PER_MINUTE}) * ${calls.duration} / 60.0), 0)`,\n      })\n      .from(calls)\n      .where(and(\n        eq(calls.organizationId, organizationId),\n        gte(calls.createdAt, previousMonthStart),\n        sql`${calls.createdAt} <= ${previousMonthEnd}`\n      ));\n\n    // Daily breakdown for current month\n    const dailyBreakdown = await db\n      .select({\n        date: sql<string>`date(${calls.createdAt})`,\n        minutes: sql<number>`coalesce(sum(${calls.duration}) / 60.0, 0)`,\n        exotelCost: sql<number>`coalesce(sum(${calls.exotelCostPerMinute} * ${calls.duration} / 60.0), 0)`,\n        bolnaCost: sql<number>`coalesce(sum(${calls.bolnaCostPerMinute} * ${calls.duration} / 60.0), 0)`,\n      })\n      .from(calls)\n      .where(and(\n        eq(calls.organizationId, organizationId),\n        gte(calls.createdAt, currentMonthStart)\n      ))\n      .groupBy(sql`date(${calls.createdAt})`)\n      .orderBy(sql`date(${calls.createdAt})`);\n\n    const costBreakdown = dailyBreakdown.map(day => ({\n      date: day.date,\n      exotelCost: day.exotelCost,\n      bolnaCost: day.bolnaCost,\n      markupCost: day.minutes * MARKUP_PER_MINUTE,\n      totalCost: day.exotelCost + day.bolnaCost + (day.minutes * MARKUP_PER_MINUTE),\n      minutes: day.minutes,\n    }));\n\n    return {\n      currentMonth: {\n        totalMinutes: currentTotalMinutes,\n        totalCalls: currentMonth?.totalCalls ?? 0,\n        exotelCost: currentExotelCost,\n        bolnaCost: currentBolnaCost,\n        markupCost: currentMarkupCost,\n        totalCost: currentTotalCost,\n      },\n      previousMonth: {\n        totalMinutes: previousMonth?.totalMinutes ?? 0,\n        totalCost: previousMonth?.totalCost ?? 0,\n      },\n      costBreakdown,\n    };\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":21355},"design_guidelines.md":{"content":"# Design Guidelines: AI Voice Agent Platform\n\n## Design Approach\n**Strict Minimal Black & White Theme** - Pure monochrome aesthetic with absolutely NO colors except black, white, and grayscale. Typography and white space create all hierarchy. No decorative elements.\n\n## Color System\n\n### Light Mode (Default)\n- Background: `#FFFFFF` (pure white)\n- Secondary Background: `#FAFAFA` (#F9F9F9 very light gray)\n- Primary Actions: `#000000` (pure black buttons with white text)\n- Secondary Actions: White buttons with `1px solid #000000` border\n- Text Primary: `#000000` (pure black)\n- Text Secondary: `#666666` (medium gray)\n- Text Muted: `#999999` (light gray)\n- Borders: `#E5E5E5` (very light gray)\n- Dividers: `#F0F0F0`\n- Cards: White with `box-shadow: 0 1px 3px rgba(0,0,0,0.08)`\n- Success: `#000000` (black - no color)\n- Warning: `#666666` (gray - no color)\n- Error: `#000000` (black - no color)\n- Info: `#333333` (dark gray - no color)\n\n### Dark Mode\n- Background: `#000000` (true black for OLED)\n- Secondary Background: `#0A0A0A` (very dark gray)\n- Primary Actions: `#FFFFFF` (white buttons with black text)\n- Secondary Actions: Black buttons with `1px solid #FFFFFF` border\n- Text Primary: `#FFFFFF` (pure white)\n- Text Secondary: `#A0A0A0` (medium gray)\n- Text Muted: `#666666` (dark gray)\n- Borders: `#1A1A1A` (very dark gray)\n- Dividers: `#0F0F0F`\n- Cards: `#0A0A0A` with subtle border\n- Success: `#FFFFFF` (white - no color)\n- Warning: `#A0A0A0` (gray - no color)\n- Error: `#FFFFFF` (white - no color)\n- Info: `#CCCCCC` (light gray - no color)\n\n## Typography\n- **Font Family**: Inter (system-ui fallback)\n- **Headings**: Bold weights\n  - H1: 40px (desktop), 28px (mobile) - `font-bold tracking-tight`\n  - H2: 32px (desktop), 24px (mobile) - `font-semibold tracking-tight`\n  - H3: 24px (desktop), 20px (mobile) - `font-semibold`\n  - H4: 20px (desktop), 18px (mobile) - `font-medium`\n- **Body**: Regular 16px (desktop), 14px (mobile)\n- **Small**: 14px (desktop), 12px (mobile)\n- **Line Height**: 1.5 for body, 1.2 for headings\n- **Letter Spacing**: -0.011em for tighter minimal aesthetic\n\n## Layout System\n\n### Spacing Scale (Tailwind units)\nUse consistent spacing: `4, 8, 12, 16, 20, 24, 32, 48, 64` (p-1, p-2, p-3, p-4, p-5, p-6, p-8, p-12, p-16)\n\n### Responsive Breakpoints\n- Mobile: 320px-767px (single column, bottom navigation, full-width cards)\n- Tablet: 768px-1023px (2-column grids, collapsible sidebar)\n- Desktop: 1024px+ (3-5 column grids, fixed sidebar 260px width)\n\n### Sidebar\n- Desktop: 260px fixed width (320px for AI Voice Agent platform)\n- Mobile: Full overlay or bottom sheet\n- Collapsible to icon-only mode\n\n## Navigation Architecture\n\n### AI Voice Agent Platform Structure\n1. **AI VOICE SYSTEM** - Dashboard, Calls, AI Agents, Call History\n2. **CRM & LEAD MANAGEMENT** - Leads, Pipelines, Contacts\n3. **BUSINESS MANAGEMENT** - Knowledge Base, Analytics, Billing\n\n### Mobile (320px-767px)\n- Collapsible sidebar overlay\n- Touch targets: minimum 48px height/width\n- Bottom actions for primary CTAs\n\n### Desktop (1024px+)\n- Fixed sidebar (260px width)\n- Sections with uppercase labels\n- Icons + text labels\n- Subtle badges for counts/status\n\n## Component Library\n\n### Buttons\n- **Primary**: Black bg (light mode), white bg (dark mode), medium padding, rounded-md\n- **Secondary**: Outlined with 1px border, same padding, rounded-md\n- **Ghost**: No background, hover elevate effect\n- **Touch Targets**: 48px mobile, 36px desktop minimum\n- **States**: Subtle elevation on hover, no color changes\n\n### Cards\n- White (light) or `#0A0A0A` (dark) background\n- Subtle shadow: `0 1px 3px rgba(0,0,0,0.08)` in light mode\n- 12px border-radius (rounded-md)\n- 24px padding (desktop), 16px (mobile)\n- Hover: Subtle transform translateY(-2px)\n\n### Badges\n- Pure grayscale backgrounds\n- Small text (12px-14px)\n- Rounded corners\n- Used for status indicators, counts\n\n### Data Tables\n- **Mobile**: Card view with key info\n- **Tablet**: Condensed table\n- **Desktop**: Full table with sorting, filtering\n- Alternating row backgrounds for readability\n- Pure black/white/gray styling\n\n### Forms\n- Clear labels above inputs\n- Border focus states (no color outlines)\n- Validation messages in black/white\n- Auto-save capabilities\n\n### Progress Bars\n- Grayscale fills only\n- No colored indicators\n- Percentage or fraction labels\n\n## Key Visual Principles\n\n1. **NO COLOR** - Absolutely no colors except black, white, and grayscale\n2. **Typography creates hierarchy** - Font size, weight, and spacing differentiate elements\n3. **White space is primary design element** - Generous padding and margins\n4. **Subtle shadows define depth** - Not colors\n5. **Icons are minimal line-art style** - Lucide React outline icons\n6. **Interaction feedback through opacity/scale** - Not color changes\n7. **Data visualization in grayscale/patterns** - Charts use black/white/gray gradients\n\n## Interactions & States\n\n### Hover States\n- Subtle elevation (opacity overlays)\n- No background color changes\n- Transform: translateY(-2px) for cards\n- Opacity changes for text/icons\n\n### Active/Focus States\n- 2px outline in black (light mode) or white (dark mode)\n- No colored focus rings\n- Subtle elevation changes\n\n### Loading States\n- Skeleton screens in grayscale\n- Pulse animations\n- Spinner in black/white\n\n## Performance & Accessibility\n\n- WCAG 2.1 AA compliance\n- Keyboard navigation throughout\n- Screen reader labels (ARIA)\n- Focus indicators: 2px outline\n- Minimum contrast ratio: 4.5:1\n- Virtual scrolling for large lists\n- Code splitting per route\n\n## Theme Toggle\n\n- Sun/moon icon in header\n- Smooth transition (150ms)\n- Persists to localStorage\n- System preference detection\n\nThis strict minimal black/white design prioritizes clarity and restraint. Every element uses only monochrome colors, creating a premium, focused experience through typography, spacing, and subtle interactions.\n","size_bytes":5873},"client/src/pages/dashboards/SalesAgentDashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Phone, Calendar, TrendingUp, CheckCircle2 } from \"lucide-react\";\nimport type { Lead, Call } from \"@shared/schema\";\nimport { format } from \"date-fns\";\n\nexport default function SalesAgentDashboard() {\n  const { user } = useAuth();\n\n  const { data: leads, isLoading: leadsLoading } = useQuery<Lead[]>({\n    queryKey: [\"/api/leads/my\"],\n  });\n\n  const { data: calls, isLoading: callsLoading } = useQuery<Call[]>({\n    queryKey: [\"/api/calls/my\"],\n  });\n\n  const isLoading = leadsLoading || callsLoading;\n\n  const assignedLeads = leads?.filter(l => l.status !== 'completed') ?? [];\n  const completedLeads = leads?.filter(l => l.status === 'completed') ?? [];\n  const todayCalls = calls?.filter(c => \n    c.scheduledAt && format(new Date(c.scheduledAt), 'yyyy-MM-dd') === format(new Date(), 'yyyy-MM-dd')\n  ) ?? [];\n\n  const stats = [\n    {\n      title: \"Assigned Leads\",\n      value: assignedLeads.length,\n      icon: Phone,\n      description: \"Active leads to contact\",\n      testId: \"stat-assigned\",\n    },\n    {\n      title: \"Calls Today\",\n      value: todayCalls.length,\n      icon: Calendar,\n      description: \"Scheduled for today\",\n      testId: \"stat-today-calls\",\n    },\n    {\n      title: \"Completed\",\n      value: completedLeads.length,\n      icon: CheckCircle2,\n      description: \"Successfully closed\",\n      testId: \"stat-completed\",\n    },\n    {\n      title: \"Success Rate\",\n      value: `${leads && leads.length > 0 ? ((completedLeads.length / leads.length) * 100).toFixed(0) : 0}%`,\n      icon: TrendingUp,\n      description: \"Your conversion rate\",\n      testId: \"stat-success-rate\",\n    },\n  ];\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6 p-6 md:p-8\">\n        <div className=\"space-y-2\">\n          <div className=\"h-8 w-48 bg-muted animate-pulse rounded\" />\n          <div className=\"h-5 w-64 bg-muted animate-pulse rounded\" />\n        </div>\n        <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n          {[1, 2, 3, 4].map((i) => (\n            <Card key={i}>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <div className=\"h-5 w-24 bg-muted animate-pulse rounded\" />\n                <div className=\"h-4 w-4 bg-muted animate-pulse rounded\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-8 w-16 bg-muted animate-pulse rounded mb-2\" />\n                <div className=\"h-4 w-32 bg-muted animate-pulse rounded\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"space-y-1\">\n        <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-dashboard\">\n          My Dashboard\n        </h1>\n        <p className=\"text-muted-foreground\">\n          Welcome back, {user?.firstName || 'Agent'}\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"hover-elevate\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <stat.icon className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\" data-testid={stat.testId}>\n                {stat.value}\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                {stat.description}\n              </p>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Lead Queue</CardTitle>\n          <CardDescription>\n            Your assigned leads requiring action\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {assignedLeads.map((lead) => (\n              <div\n                key={lead.id}\n                className=\"flex flex-col sm:flex-row sm:items-center justify-between p-4 rounded-md border hover-elevate cursor-pointer gap-3\"\n                onClick={() => window.location.href = `/leads/${lead.id}`}\n                data-testid={`lead-${lead.id}`}\n              >\n                <div className=\"flex-1 space-y-1\">\n                  <div className=\"flex items-center gap-2 flex-wrap\">\n                    <p className=\"text-sm font-medium\">{lead.name}</p>\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      {lead.status}\n                    </Badge>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {lead.company && `${lead.company} â€¢ `}\n                    {lead.phone || lead.email}\n                  </p>\n                  {lead.aiSummary && (\n                    <p className=\"text-xs text-muted-foreground line-clamp-2\">\n                      {lead.aiSummary}\n                    </p>\n                  )}\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      if (lead.phone) window.location.href = `tel:${lead.phone}`;\n                    }}\n                    data-testid={`button-call-${lead.id}`}\n                  >\n                    <Phone className=\"h-4 w-4 mr-1\" />\n                    Call\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      window.location.href = `/leads/${lead.id}/schedule`;\n                    }}\n                    data-testid={`button-schedule-${lead.id}`}\n                  >\n                    <Calendar className=\"h-4 w-4 mr-1\" />\n                    Schedule\n                  </Button>\n                </div>\n              </div>\n            ))}\n            {assignedLeads.length === 0 && (\n              <p className=\"text-sm text-muted-foreground text-center py-8\">\n                No leads assigned. Contact your manager for lead assignments.\n              </p>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6786},"server/routes.ts":{"content":"// Reference: javascript_log_in_with_replit integration\nimport type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { Server as SocketIOServer } from \"socket.io\";\nimport multer from \"multer\";\nimport Papa from \"papaparse\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\nimport { generateAISummary, analyzeLeadQualification, generateMeetingSummary } from \"./openai\";\nimport { bolnaClient } from \"./bolna\";\nimport { exotelClient } from \"./exotel\";\nimport type { InsertLead, InsertChannelPartner, InsertCampaign, InsertCall, InsertVisit, InsertAiAgent, CreateAiAgentInput, UpdateAiAgentInput, InsertKnowledgeBase, CreateKnowledgeBaseInput, UpdateKnowledgeBaseInput, InsertPhoneNumber } from \"@shared/schema\";\nimport { createAiAgentSchema, updateAiAgentSchema, createKnowledgeBaseSchema, updateKnowledgeBaseSchema } from \"@shared/schema\";\n\nconst upload = multer({ storage: multer.memoryStorage() });\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Auth middleware\n  await setupAuth(app);\n\n  // Auth routes\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // User management routes\n  app.get('/api/users', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const currentUser = await storage.getUser(userId);\n      if (!currentUser) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const users = await storage.getUsersByOrganization(currentUser.organizationId);\n      res.json(users);\n    } catch (error) {\n      console.error(\"Error fetching users:\", error);\n      res.status(500).json({ message: \"Failed to fetch users\" });\n    }\n  });\n\n  // AI Agents routes\n  app.get('/api/ai-agents', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const agents = await storage.getAIAgents(user.organizationId);\n      res.json(agents);\n    } catch (error) {\n      console.error(\"Error fetching AI agents:\", error);\n      res.status(500).json({ message: \"Failed to fetch AI agents\" });\n    }\n  });\n\n  app.get('/api/ai-agents/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const agent = await storage.getAIAgent(req.params.id, user.organizationId);\n      if (!agent) {\n        return res.status(404).json({ message: \"AI agent not found\" });\n      }\n      res.json(agent);\n    } catch (error) {\n      console.error(\"Error fetching AI agent:\", error);\n      res.status(500).json({ message: \"Failed to fetch AI agent\" });\n    }\n  });\n\n  app.post('/api/ai-agents', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      // Validate request body using strict schema that rejects organizationId\n      const clientData: CreateAiAgentInput = createAiAgentSchema.parse(req.body);\n      \n      // Create agent in Bolna first\n      let bolnaAgent;\n      const agentData: InsertAiAgent = {\n        ...clientData,\n        organizationId: user.organizationId,\n      };\n      \n      try {\n        bolnaAgent = await bolnaClient.createAgent(agentData as any);\n        agentData.bolnaAgentId = bolnaAgent.agent_id;\n        agentData.bolnaConfig = bolnaAgent as any;\n      } catch (bolnaError) {\n        console.error(\"Bolna API error:\", bolnaError);\n        // Continue without Bolna integration if it fails\n        console.log(\"Creating agent without Bolna integration\");\n      }\n      \n      const agent = await storage.createAIAgent(agentData);\n      res.json(agent);\n    } catch (error) {\n      console.error(\"Error creating AI agent:\", error);\n      if (error instanceof Error && 'issues' in error) {\n        return res.status(400).json({ message: \"Invalid request data\", errors: (error as any).issues });\n      }\n      res.status(500).json({ message: \"Failed to create AI agent\" });\n    }\n  });\n\n  app.patch('/api/ai-agents/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      // Validate using strict update schema that rejects organizationId\n      const updateData: UpdateAiAgentInput = updateAiAgentSchema.parse(req.body);\n      \n      // Get existing agent to check for Bolna integration\n      const existingAgent = await storage.getAIAgent(req.params.id, user.organizationId);\n      if (!existingAgent) {\n        return res.status(404).json({ message: \"AI agent not found\" });\n      }\n      \n      // Sync updates to Bolna if agent has Bolna integration\n      if (existingAgent.bolnaAgentId) {\n        try {\n          await bolnaClient.updateAgent(existingAgent.bolnaAgentId, updateData as any);\n        } catch (bolnaError) {\n          console.error(\"Bolna API update error:\", bolnaError);\n          // Continue with local update even if Bolna sync fails\n        }\n      }\n      \n      // Pass only validated tenant-safe data to storage (organizationId cannot be in updateData)\n      const agent = await storage.updateAIAgent(req.params.id, user.organizationId, updateData);\n      if (!agent) {\n        return res.status(404).json({ message: \"AI agent not found\" });\n      }\n      res.json(agent);\n    } catch (error) {\n      console.error(\"Error updating AI agent:\", error);\n      if (error instanceof Error && 'issues' in error) {\n        return res.status(400).json({ message: \"Invalid request data\", errors: (error as any).issues });\n      }\n      res.status(500).json({ message: \"Failed to update AI agent\" });\n    }\n  });\n\n  app.delete('/api/ai-agents/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      // Get agent to check for Bolna integration before deleting\n      const agent = await storage.getAIAgent(req.params.id, user.organizationId);\n      if (!agent) {\n        return res.status(404).json({ message: \"AI agent not found\" });\n      }\n      \n      // Delete from Bolna if integrated\n      if (agent.bolnaAgentId) {\n        try {\n          await bolnaClient.deleteAgent(agent.bolnaAgentId);\n        } catch (bolnaError) {\n          console.error(\"Bolna API delete error:\", bolnaError);\n          // Continue with local deletion even if Bolna deletion fails\n        }\n      }\n      \n      const deleted = await storage.deleteAIAgent(req.params.id, user.organizationId);\n      if (!deleted) {\n        return res.status(404).json({ message: \"AI agent not found\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting AI agent:\", error);\n      res.status(500).json({ message: \"Failed to delete AI agent\" });\n    }\n  });\n\n  // Call initiation route - Use Bolna + Exotel\n  app.post('/api/calls/initiate', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      const { agentId, recipientPhone, contactName, fromPhone, leadId } = req.body;\n\n      if (!agentId || !recipientPhone) {\n        return res.status(400).json({ message: \"agentId and recipientPhone are required\" });\n      }\n\n      // Get the AI agent\n      const agent = await storage.getAIAgent(agentId, user.organizationId);\n      if (!agent) {\n        return res.status(404).json({ message: \"AI agent not found\" });\n      }\n\n      if (!agent.bolnaAgentId) {\n        return res.status(400).json({ message: \"Agent is not configured with Bolna\" });\n      }\n\n      // Initiate call via Bolna\n      const bolnaCall = await bolnaClient.initiateCall({\n        agent_id: agent.bolnaAgentId,\n        recipient_phone_number: recipientPhone,\n        from: fromPhone,\n        metadata: {\n          leadId,\n          contactName,\n          organizationId: user.organizationId,\n        },\n      });\n\n      // Create call record in database\n      const callData: InsertCall = {\n        organizationId: user.organizationId,\n        leadId: leadId || null,\n        agentId,\n        contactPhone: recipientPhone,\n        contactName: contactName || null,\n        callType: 'outbound',\n        direction: 'outbound',\n        status: 'initiated',\n        bolnaCallId: bolnaCall.call_id,\n        scheduledAt: new Date(),\n      };\n\n      const call = await storage.createCall(callData);\n\n      // Emit real-time update\n      if ((app as any).emitCallCreated) {\n        (app as any).emitCallCreated(user.organizationId, call);\n      }\n\n      res.json({ call, bolnaCall });\n    } catch (error) {\n      console.error(\"Error initiating call:\", error);\n      res.status(500).json({ message: \"Failed to initiate call\" });\n    }\n  });\n\n  // Exotel phone numbers management\n  app.get('/api/phone-numbers', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      // Get phone numbers from database\n      const phoneNumbers = await storage.getPhoneNumbers(user.organizationId);\n      res.json(phoneNumbers);\n    } catch (error) {\n      console.error(\"Error fetching phone numbers:\", error);\n      res.status(500).json({ message: \"Failed to fetch phone numbers\" });\n    }\n  });\n\n  app.get('/api/phone-numbers/sync', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      // Fetch phone numbers from Exotel\n      const exotelNumbers = await exotelClient.getPhoneNumbers();\n\n      // Sync with database\n      const syncedNumbers = [];\n      for (const exotelNumber of exotelNumbers) {\n        const phoneData: InsertPhoneNumber = {\n          organizationId: user.organizationId,\n          phoneNumber: exotelNumber.PhoneNumber,\n          provider: 'exotel',\n          exotelSid: exotelNumber.Sid,\n          friendlyName: exotelNumber.FriendlyName,\n          capabilities: {\n            voice: true,\n            sms: true,\n          },\n          status: 'active',\n        };\n\n        try {\n          const existing = await storage.getPhoneNumbers(user.organizationId);\n          const existingNumber = existing.find(n => n.phoneNumber === exotelNumber.PhoneNumber);\n          \n          if (!existingNumber) {\n            const created = await storage.createPhoneNumber(phoneData);\n            syncedNumbers.push(created);\n          } else {\n            syncedNumbers.push(existingNumber);\n          }\n        } catch (err) {\n          console.error(\"Error syncing phone number:\", err);\n        }\n      }\n\n      res.json({ syncedNumbers, total: syncedNumbers.length });\n    } catch (error) {\n      console.error(\"Error syncing phone numbers:\", error);\n      res.status(500).json({ message: \"Failed to sync phone numbers\" });\n    }\n  });\n\n  // Bolna webhook for call status updates\n  app.post('/api/webhooks/bolna/call-status', async (req, res) => {\n    try {\n      const { call_id, status, duration, transcript, recording_url, metadata } = req.body;\n\n      // Find call by Bolna call ID\n      const calls = await storage.getCalls(metadata?.organizationId || '');\n      const call = calls.find(c => c.bolnaCallId === call_id);\n\n      if (call) {\n        const updates: Partial<InsertCall> = {\n          status,\n          duration,\n          transcription: transcript,\n          recordingUrl: recording_url,\n          endedAt: status === 'completed' ? new Date() : undefined,\n        };\n\n        const updatedCall = await storage.updateCall(call.id, metadata?.organizationId || '', updates);\n        \n        // Emit real-time update\n        if ((app as any).emitCallUpdate && updatedCall) {\n          (app as any).emitCallUpdate(metadata?.organizationId || '', updatedCall);\n        }\n      }\n\n      res.json({ received: true });\n    } catch (error) {\n      console.error(\"Bolna webhook error:\", error);\n      res.status(500).json({ error: \"Webhook processing failed\" });\n    }\n  });\n\n  // Exotel webhook for call status updates\n  app.post('/api/webhooks/exotel/call-status', async (req, res) => {\n    try {\n      const { CallSid, Status, Duration, RecordingUrl, From, To } = req.body;\n\n      // Find call by Exotel call SID\n      // This would need additional logic to match calls\n      console.log(\"Exotel webhook received:\", { CallSid, Status });\n\n      res.json({ received: true });\n    } catch (error) {\n      console.error(\"Exotel webhook error:\", error);\n      res.status(500).json({ error: \"Webhook processing failed\" });\n    }\n  });\n\n  // Call History routes\n  app.get('/api/calls', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const calls = await storage.getCalls(user.organizationId);\n      \n      // Validate response: ensure all calls belong to user's organization (defensive)\n      const validCalls = calls.filter(call => call.organizationId === user.organizationId);\n      if (validCalls.length !== calls.length) {\n        console.error(\"WARNING: Storage returned cross-tenant calls data\");\n      }\n      \n      res.json(validCalls);\n    } catch (error) {\n      console.error(\"Error fetching calls:\", error);\n      res.status(500).json({ message: \"Failed to fetch calls\" });\n    }\n  });\n\n  app.get('/api/calls/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const call = await storage.getCall(req.params.id, user.organizationId);\n      if (!call) {\n        return res.status(404).json({ message: \"Call not found\" });\n      }\n      \n      // Validate response: ensure call belongs to user's organization (defensive)\n      if (call.organizationId !== user.organizationId) {\n        console.error(\"WARNING: Storage returned cross-tenant call data\");\n        return res.status(404).json({ message: \"Call not found\" });\n      }\n      \n      res.json(call);\n    } catch (error) {\n      console.error(\"Error fetching call:\", error);\n      res.status(500).json({ message: \"Failed to fetch call\" });\n    }\n  });\n\n  // Knowledge Base routes\n  app.get('/api/knowledge-base', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const knowledge = await storage.getKnowledgeBase(user.organizationId);\n      \n      // Defensive validation\n      const validKnowledge = knowledge.filter(k => k.organizationId === user.organizationId);\n      if (validKnowledge.length !== knowledge.length) {\n        console.error(\"WARNING: Storage returned cross-tenant knowledge base data\");\n      }\n      \n      res.json(validKnowledge);\n    } catch (error) {\n      console.error(\"Error fetching knowledge base:\", error);\n      res.status(500).json({ message: \"Failed to fetch knowledge base\" });\n    }\n  });\n\n  app.get('/api/knowledge-base/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const item = await storage.getKnowledgeBaseItem(req.params.id, user.organizationId);\n      if (!item) {\n        return res.status(404).json({ message: \"Knowledge base item not found\" });\n      }\n      \n      // Defensive validation\n      if (item.organizationId !== user.organizationId) {\n        console.error(\"WARNING: Storage returned cross-tenant knowledge base item\");\n        return res.status(404).json({ message: \"Knowledge base item not found\" });\n      }\n      \n      res.json(item);\n    } catch (error) {\n      console.error(\"Error fetching knowledge base item:\", error);\n      res.status(500).json({ message: \"Failed to fetch knowledge base item\" });\n    }\n  });\n\n  app.post('/api/knowledge-base', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      // Validate using strict schema that rejects organizationId\n      const clientData: CreateKnowledgeBaseInput = createKnowledgeBaseSchema.parse(req.body);\n      \n      // Server-side: inject organizationId from authenticated user\n      const knowledgeData: InsertKnowledgeBase = {\n        ...clientData,\n        organizationId: user.organizationId,\n      };\n      \n      const item = await storage.createKnowledgeBase(knowledgeData);\n      res.json(item);\n    } catch (error) {\n      console.error(\"Error creating knowledge base item:\", error);\n      if (error instanceof Error && 'issues' in error) {\n        return res.status(400).json({ message: \"Invalid request data\", errors: (error as any).issues });\n      }\n      res.status(500).json({ message: \"Failed to create knowledge base item\" });\n    }\n  });\n\n  app.patch('/api/knowledge-base/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      // Validate using strict update schema that rejects organizationId\n      const updateData: UpdateKnowledgeBaseInput = updateKnowledgeBaseSchema.parse(req.body);\n      \n      const item = await storage.updateKnowledgeBase(req.params.id, user.organizationId, updateData);\n      if (!item) {\n        return res.status(404).json({ message: \"Knowledge base item not found\" });\n      }\n      \n      res.json(item);\n    } catch (error) {\n      console.error(\"Error updating knowledge base item:\", error);\n      if (error instanceof Error && 'issues' in error) {\n        return res.status(400).json({ message: \"Invalid request data\", errors: (error as any).issues });\n      }\n      res.status(500).json({ message: \"Failed to update knowledge base item\" });\n    }\n  });\n\n  app.delete('/api/knowledge-base/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      const deleted = await storage.deleteKnowledgeBase(req.params.id, user.organizationId);\n      if (!deleted) {\n        return res.status(404).json({ message: \"Knowledge base item not found\" });\n      }\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting knowledge base item:\", error);\n      res.status(500).json({ message: \"Failed to delete knowledge base item\" });\n    }\n  });\n\n  // Campaign routes\n  app.get('/api/campaigns', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const campaigns = await storage.getCampaigns(user.organizationId);\n      res.json(campaigns);\n    } catch (error) {\n      console.error(\"Error fetching campaigns:\", error);\n      res.status(500).json({ message: \"Failed to fetch campaigns\" });\n    }\n  });\n\n  app.get('/api/campaigns/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const campaign = await storage.getCampaign(req.params.id, user.organizationId);\n      if (!campaign) {\n        return res.status(404).json({ message: \"Campaign not found\" });\n      }\n      res.json(campaign);\n    } catch (error) {\n      console.error(\"Error fetching campaign:\", error);\n      res.status(500).json({ message: \"Failed to fetch campaign\" });\n    }\n  });\n\n  app.post('/api/campaigns', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const campaignData: InsertCampaign = {\n        ...req.body,\n        organizationId: user.organizationId,\n        createdBy: userId,\n      };\n      const campaign = await storage.createCampaign(campaignData);\n      res.json(campaign);\n    } catch (error) {\n      console.error(\"Error creating campaign:\", error);\n      res.status(500).json({ message: \"Failed to create campaign\" });\n    }\n  });\n\n  app.patch('/api/campaigns/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const campaign = await storage.updateCampaign(req.params.id, user.organizationId, req.body);\n      if (!campaign) {\n        return res.status(404).json({ message: \"Campaign not found\" });\n      }\n      res.json(campaign);\n    } catch (error) {\n      console.error(\"Error updating campaign:\", error);\n      res.status(500).json({ message: \"Failed to update campaign\" });\n    }\n  });\n\n  app.delete('/api/campaigns/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const deleted = await storage.deleteCampaign(req.params.id, user.organizationId);\n      if (!deleted) {\n        return res.status(404).json({ message: \"Campaign not found\" });\n      }\n      res.json({ message: \"Campaign deleted successfully\" });\n    } catch (error) {\n      console.error(\"Error deleting campaign:\", error);\n      res.status(500).json({ message: \"Failed to delete campaign\" });\n    }\n  });\n\n  // Lead routes\n  app.get('/api/leads', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const leads = await storage.getLeads(user.organizationId);\n      res.json(leads);\n    } catch (error) {\n      console.error(\"Error fetching leads:\", error);\n      res.status(500).json({ message: \"Failed to fetch leads\" });\n    }\n  });\n\n  app.get('/api/leads/my', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const leads = await storage.getLeadsByAgent(userId, user.organizationId);\n      res.json(leads);\n    } catch (error) {\n      console.error(\"Error fetching my leads:\", error);\n      res.status(500).json({ message: \"Failed to fetch leads\" });\n    }\n  });\n\n  app.get('/api/leads/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const lead = await storage.getLead(req.params.id, user.organizationId);\n      if (!lead) {\n        return res.status(404).json({ message: \"Lead not found\" });\n      }\n      res.json(lead);\n    } catch (error) {\n      console.error(\"Error fetching lead:\", error);\n      res.status(500).json({ message: \"Failed to fetch lead\" });\n    }\n  });\n\n  app.post('/api/leads', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const leadData: InsertLead = {\n        ...req.body,\n        organizationId: user.organizationId,\n      };\n      const lead = await storage.createLead(leadData);\n      \n      // Generate AI summary if notes exist\n      if (lead.notes) {\n        const aiSummary = await analyzeLeadQualification({\n          name: lead.name,\n          company: lead.company || undefined,\n          notes: lead.notes,\n        });\n        await storage.updateLead(lead.id, user.organizationId, { aiSummary });\n      }\n      \n      res.json(lead);\n    } catch (error) {\n      console.error(\"Error creating lead:\", error);\n      res.status(500).json({ message: \"Failed to create lead\" });\n    }\n  });\n\n  app.post('/api/leads/upload', isAuthenticated, upload.single('file'), async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      if (!req.file) {\n        return res.status(400).json({ message: \"No file uploaded\" });\n      }\n\n      const fileContent = req.file.buffer.toString('utf-8');\n      const { data } = Papa.parse(fileContent, { header: true, skipEmptyLines: true });\n\n      const campaignId = req.body.campaignId;\n      if (!campaignId) {\n        return res.status(400).json({ message: \"Campaign ID is required\" });\n      }\n\n      const leadsData: InsertLead[] = (data as any[]).map((row: any) => ({\n        organizationId: user.organizationId,\n        campaignId,\n        name: row.name || row.Name || '',\n        email: row.email || row.Email || null,\n        phone: row.phone || row.Phone || null,\n        company: row.company || row.Company || null,\n        status: 'new',\n      })).filter(lead => lead.name); // Only include rows with names\n\n      const leads = await storage.createLeadsBulk(leadsData, user.organizationId);\n      \n      // Update campaign lead count\n      const campaign = await storage.getCampaign(campaignId, user.organizationId);\n      if (campaign) {\n        await storage.updateCampaign(campaignId, user.organizationId, {\n          totalLeads: campaign.totalLeads + leads.length,\n        });\n      }\n\n      res.json({ \n        message: \"Leads uploaded successfully\",\n        count: leads.length,\n        leads,\n      });\n    } catch (error) {\n      console.error(\"Error uploading leads:\", error);\n      res.status(500).json({ message: \"Failed to upload leads\" });\n    }\n  });\n\n  app.patch('/api/leads/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const lead = await storage.updateLead(req.params.id, user.organizationId, req.body);\n      if (!lead) {\n        return res.status(404).json({ message: \"Lead not found\" });\n      }\n      res.json(lead);\n    } catch (error) {\n      console.error(\"Error updating lead:\", error);\n      res.status(500).json({ message: \"Failed to update lead\" });\n    }\n  });\n\n  // Channel Partner routes\n  app.get('/api/channel-partners', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const partners = await storage.getChannelPartners(user.organizationId);\n      res.json(partners);\n    } catch (error) {\n      console.error(\"Error fetching channel partners:\", error);\n      res.status(500).json({ message: \"Failed to fetch channel partners\" });\n    }\n  });\n\n  app.get('/api/channel-partners/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const partner = await storage.getChannelPartner(req.params.id, user.organizationId);\n      if (!partner) {\n        return res.status(404).json({ message: \"Channel partner not found\" });\n      }\n      res.json(partner);\n    } catch (error) {\n      console.error(\"Error fetching channel partner:\", error);\n      res.status(500).json({ message: \"Failed to fetch channel partner\" });\n    }\n  });\n\n  app.post('/api/channel-partners', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const partnerData: InsertChannelPartner = {\n        ...req.body,\n        organizationId: user.organizationId,\n      };\n      const partner = await storage.createChannelPartner(partnerData);\n      res.json(partner);\n    } catch (error) {\n      console.error(\"Error creating channel partner:\", error);\n      res.status(500).json({ message: \"Failed to create channel partner\" });\n    }\n  });\n\n  app.post('/api/channel-partners/upload', isAuthenticated, upload.single('file'), async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      if (!req.file) {\n        return res.status(400).json({ message: \"No file uploaded\" });\n      }\n\n      const fileContent = req.file.buffer.toString('utf-8');\n      const { data } = Papa.parse(fileContent, { header: true, skipEmptyLines: true });\n\n      const partnersData: InsertChannelPartner[] = (data as any[]).map((row: any) => ({\n        organizationId: user.organizationId,\n        name: row.name || row.Name || '',\n        email: row.email || row.Email || null,\n        phone: row.phone || row.Phone || null,\n        company: row.company || row.Company || null,\n        category: row.category || row.Category || null,\n        status: 'inactive',\n      })).filter(partner => partner.name);\n\n      const partners = await storage.createChannelPartnersBulk(partnersData, user.organizationId);\n\n      res.json({\n        message: \"Channel partners uploaded successfully\",\n        count: partners.length,\n        partners,\n      });\n    } catch (error) {\n      console.error(\"Error uploading channel partners:\", error);\n      res.status(500).json({ message: \"Failed to upload channel partners\" });\n    }\n  });\n\n  app.patch('/api/channel-partners/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const partner = await storage.updateChannelPartner(req.params.id, user.organizationId, req.body);\n      if (!partner) {\n        return res.status(404).json({ message: \"Channel partner not found\" });\n      }\n      res.json(partner);\n    } catch (error) {\n      console.error(\"Error updating channel partner:\", error);\n      res.status(500).json({ message: \"Failed to update channel partner\" });\n    }\n  });\n\n  // Call routes\n  app.get('/api/calls', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const calls = await storage.getCalls(user.organizationId);\n      res.json(calls);\n    } catch (error) {\n      console.error(\"Error fetching calls:\", error);\n      res.status(500).json({ message: \"Failed to fetch calls\" });\n    }\n  });\n\n  app.get('/api/calls/my', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const calls = await storage.getCallsByAgent(userId, user.organizationId);\n      res.json(calls);\n    } catch (error) {\n      console.error(\"Error fetching my calls:\", error);\n      res.status(500).json({ message: \"Failed to fetch calls\" });\n    }\n  });\n\n  app.post('/api/calls', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const callData: InsertCall = {\n        ...req.body,\n        organizationId: user.organizationId,\n      };\n      const call = await storage.createCall(callData);\n      \n      // Generate AI summary if transcription exists\n      if (call.transcription) {\n        const aiSummary = await generateAISummary(call.transcription);\n        await storage.updateCall(call.id, user.organizationId, { aiSummary });\n      }\n      \n      res.json(call);\n    } catch (error) {\n      console.error(\"Error creating call:\", error);\n      res.status(500).json({ message: \"Failed to create call\" });\n    }\n  });\n\n  app.patch('/api/calls/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const call = await storage.updateCall(req.params.id, user.organizationId, req.body);\n      if (!call) {\n        return res.status(404).json({ message: \"Call not found\" });\n      }\n      res.json(call);\n    } catch (error) {\n      console.error(\"Error updating call:\", error);\n      res.status(500).json({ message: \"Failed to update call\" });\n    }\n  });\n\n  // Visit routes\n  app.get('/api/visits', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const visits = await storage.getVisits(user.organizationId);\n      res.json(visits);\n    } catch (error) {\n      console.error(\"Error fetching visits:\", error);\n      res.status(500).json({ message: \"Failed to fetch visits\" });\n    }\n  });\n\n  app.get('/api/visits/my', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const visits = await storage.getVisitsByManager(userId, user.organizationId);\n      res.json(visits);\n    } catch (error) {\n      console.error(\"Error fetching my visits:\", error);\n      res.status(500).json({ message: \"Failed to fetch visits\" });\n    }\n  });\n\n  app.post('/api/visits', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const visitData: InsertVisit = {\n        ...req.body,\n        organizationId: user.organizationId,\n      };\n      const visit = await storage.createVisit(visitData);\n      res.json(visit);\n    } catch (error) {\n      console.error(\"Error creating visit:\", error);\n      res.status(500).json({ message: \"Failed to create visit\" });\n    }\n  });\n\n  app.patch('/api/visits/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const visit = await storage.updateVisit(req.params.id, user.organizationId, req.body);\n      \n      // Generate summary if transcription exists\n      if (visit && req.body.transcription && !visit.summary) {\n        const summary = await generateMeetingSummary(req.body.transcription);\n        await storage.updateVisit(req.params.id, user.organizationId, { summary });\n      }\n      \n      if (!visit) {\n        return res.status(404).json({ message: \"Visit not found\" });\n      }\n      res.json(visit);\n    } catch (error) {\n      console.error(\"Error updating visit:\", error);\n      res.status(500).json({ message: \"Failed to update visit\" });\n    }\n  });\n\n  // Dashboard metrics route (AI Voice Agent platform)\n  app.get('/api/dashboard/metrics', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const metrics = await storage.getDashboardMetrics(user.organizationId);\n      res.json(metrics);\n    } catch (error) {\n      console.error(\"Error fetching dashboard metrics:\", error);\n      res.status(500).json({ message: \"Failed to fetch dashboard metrics\" });\n    }\n  });\n\n  // Analytics routes\n  app.get('/api/analytics/metrics', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const daysAgo = req.query.timeRange === '90d' ? 90 : req.query.timeRange === '30d' ? 30 : 7;\n      const metrics = await storage.getAnalyticsMetrics(user.organizationId, daysAgo);\n      res.json(metrics);\n    } catch (error) {\n      console.error(\"Error fetching analytics metrics:\", error);\n      res.status(500).json({ message: \"Failed to fetch analytics metrics\" });\n    }\n  });\n\n  app.get('/api/analytics/calls', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const daysAgo = req.query.timeRange === '90d' ? 90 : req.query.timeRange === '30d' ? 30 : 7;\n      const callMetrics = await storage.getCallMetrics(user.organizationId, daysAgo);\n      res.json(callMetrics);\n    } catch (error) {\n      console.error(\"Error fetching call metrics:\", error);\n      res.status(500).json({ message: \"Failed to fetch call metrics\" });\n    }\n  });\n\n  app.get('/api/analytics/agents', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const daysAgo = req.query.timeRange === '90d' ? 90 : req.query.timeRange === '30d' ? 30 : 7;\n      const agentPerformance = await storage.getAgentPerformance(user.organizationId, daysAgo);\n      res.json(agentPerformance);\n    } catch (error) {\n      console.error(\"Error fetching agent performance:\", error);\n      res.status(500).json({ message: \"Failed to fetch agent performance\" });\n    }\n  });\n\n  // Billing routes\n  app.get('/api/billing/metrics', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      const metrics = await storage.getBillingMetrics(user.organizationId);\n      res.json(metrics);\n    } catch (error) {\n      console.error(\"Error fetching billing metrics:\", error);\n      res.status(500).json({ message: \"Failed to fetch billing metrics\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  \n  // WebSocket setup for real-time updates\n  const io = new SocketIOServer(httpServer, {\n    cors: {\n      origin: \"*\",\n      methods: [\"GET\", \"POST\"]\n    }\n  });\n\n  // WebSocket connection handler\n  io.on('connection', (socket) => {\n    console.log('Client connected:', socket.id);\n    \n    // Join organization-specific room for multi-tenant isolation\n    socket.on('join:organization', (organizationId: string) => {\n      socket.join(`org:${organizationId}`);\n      console.log(`Client ${socket.id} joined organization room: org:${organizationId}`);\n    });\n\n    socket.on('leave:organization', (organizationId: string) => {\n      socket.leave(`org:${organizationId}`);\n      console.log(`Client ${socket.id} left organization room: org:${organizationId}`);\n    });\n    \n    socket.on('disconnect', () => {\n      console.log('Client disconnected:', socket.id);\n    });\n  });\n\n  // Helper functions to emit real-time updates\n  const emitCallUpdate = (organizationId: string, call: any) => {\n    io.to(`org:${organizationId}`).emit('call:updated', call);\n  };\n\n  const emitCallCreated = (organizationId: string, call: any) => {\n    io.to(`org:${organizationId}`).emit('call:created', call);\n  };\n\n  const emitMetricsUpdate = (organizationId: string, metrics: any) => {\n    io.to(`org:${organizationId}`).emit('metrics:updated', metrics);\n  };\n\n  const emitAgentUpdate = (organizationId: string, agent: any) => {\n    io.to(`org:${organizationId}`).emit('agent:updated', agent);\n  };\n\n  // Store io instance and helper functions for use in other parts of the app\n  (app as any).io = io;\n  (app as any).emitCallUpdate = emitCallUpdate;\n  (app as any).emitCallCreated = emitCallCreated;\n  (app as any).emitMetricsUpdate = emitMetricsUpdate;\n  (app as any).emitAgentUpdate = emitAgentUpdate;\n\n  return httpServer;\n}\n","size_bytes":42717},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/pages/Campaigns.tsx":{"content":"import { useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Plus, Megaphone } from \"lucide-react\";\nimport type { Campaign } from \"@shared/schema\";\nimport { format } from \"date-fns\";\n\nexport default function Campaigns() {\n  const { toast } = useToast();\n  const { isAuthenticated, isLoading: authLoading } = useAuth();\n\n  useEffect(() => {\n    if (!authLoading && !isAuthenticated) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"You are logged out. Logging in again...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n    }\n  }, [isAuthenticated, authLoading, toast]);\n\n  const { data: campaigns, isLoading } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  if (authLoading || !isAuthenticated) {\n    return null;\n  }\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n        <div className=\"space-y-1\">\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-campaigns\">\n            Campaigns\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Manage your automation campaigns\n          </p>\n        </div>\n        <Button asChild data-testid=\"button-create-campaign\">\n          <a href=\"/campaigns/new\">\n            <Plus className=\"h-4 w-4 mr-2\" />\n            Create Campaign\n          </a>\n        </Button>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid gap-4 md:gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3\">\n          {[1, 2, 3].map((i) => (\n            <Card key={i}>\n              <CardHeader>\n                <div className=\"h-6 w-32 bg-muted animate-pulse rounded mb-2\" />\n                <div className=\"h-4 w-48 bg-muted animate-pulse rounded\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <div className=\"h-4 w-full bg-muted animate-pulse rounded\" />\n                  <div className=\"h-4 w-24 bg-muted animate-pulse rounded\" />\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : campaigns && campaigns.length > 0 ? (\n        <div className=\"grid gap-4 md:gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3\">\n          {campaigns.map((campaign) => (\n            <Card\n              key={campaign.id}\n              className=\"hover-elevate cursor-pointer\"\n              onClick={() => window.location.href = `/campaigns/${campaign.id}`}\n              data-testid={`campaign-${campaign.id}`}\n            >\n              <CardHeader>\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Megaphone className=\"h-5 w-5 text-muted-foreground\" />\n                    <CardTitle className=\"text-lg\">{campaign.name}</CardTitle>\n                  </div>\n                  <Badge variant={\n                    campaign.status === 'active' ? 'default' :\n                    campaign.status === 'completed' ? 'secondary' :\n                    'outline'\n                  }>\n                    {campaign.status}\n                  </Badge>\n                </div>\n                <CardDescription className=\"line-clamp-2\">\n                  {campaign.description || 'No description'}\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-muted-foreground\">Total Leads</span>\n                  <span className=\"font-medium\">{campaign.totalLeads}</span>\n                </div>\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-muted-foreground\">Completed</span>\n                  <span className=\"font-medium\">{campaign.completedLeads}</span>\n                </div>\n                {campaign.startDate && (\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-muted-foreground\">Start Date</span>\n                    <span className=\"font-medium\">\n                      {format(new Date(campaign.startDate), 'PP')}\n                    </span>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-16\">\n            <Megaphone className=\"h-12 w-12 text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\">No campaigns yet</h3>\n            <p className=\"text-sm text-muted-foreground mb-6 text-center max-w-md\">\n              Create your first campaign to start automating your voice and chat interactions\n            </p>\n            <Button asChild>\n              <a href=\"/campaigns/new\">\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Create First Campaign\n              </a>\n            </Button>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n","size_bytes":5545},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","size_bytes":116},"client/src/contexts/ThemeContext.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"light\" | \"dark\";\n\ntype ThemeContextType = {\n  theme: Theme;\n  toggleTheme: () => void;\n};\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  const [theme, setTheme] = useState<Theme>(() => {\n    const stored = localStorage.getItem(\"theme\");\n    if (stored === \"light\" || stored === \"dark\") return stored;\n    return window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\";\n  });\n\n  useEffect(() => {\n    const root = document.documentElement;\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(theme);\n    localStorage.setItem(\"theme\", theme);\n  }, [theme]);\n\n  const toggleTheme = () => {\n    setTheme((prev) => (prev === \"light\" ? \"dark\" : \"light\"));\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, toggleTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (!context) {\n    throw new Error(\"useTheme must be used within ThemeProvider\");\n  }\n  return context;\n}\n","size_bytes":1196},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/pages/Landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { BarChart3, Users, MessageSquare, Zap } from \"lucide-react\";\n\nexport default function Landing() {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-4 py-16 md:py-24\">\n        <div className=\"max-w-4xl mx-auto text-center space-y-8\">\n          <div className=\"space-y-4\">\n            <h1 className=\"text-4xl md:text-5xl lg:text-6xl font-bold tracking-tight\">\n              AI-Powered Voice & Chat Automation\n            </h1>\n            <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto\">\n              Multi-tenant SaaS platform for intelligent sales automation, site management, and partner engagement\n            </p>\n          </div>\n\n          <div className=\"flex justify-center\">\n            <Button\n              size=\"lg\"\n              onClick={() => window.location.href = '/api/login'}\n              data-testid=\"button-login\"\n              className=\"text-base px-8\"\n            >\n              Get Started\n            </Button>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mt-16\">\n            <Card className=\"hover-elevate\">\n              <CardHeader>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-primary/10 rounded-md\">\n                    <BarChart3 className=\"h-6 w-6\" />\n                  </div>\n                  <CardTitle>Real-time Analytics</CardTitle>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <CardDescription className=\"text-base\">\n                  Comprehensive dashboards with call metrics, conversion funnels, and performance tracking\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card className=\"hover-elevate\">\n              <CardHeader>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-primary/10 rounded-md\">\n                    <Users className=\"h-6 w-6\" />\n                  </div>\n                  <CardTitle>Role-Based Access</CardTitle>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <CardDescription className=\"text-base\">\n                  Customized dashboards for admins, sales agents, site managers, and sourcing managers\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card className=\"hover-elevate\">\n              <CardHeader>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-primary/10 rounded-md\">\n                    <MessageSquare className=\"h-6 w-6\" />\n                  </div>\n                  <CardTitle>AI Conversation Summaries</CardTitle>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <CardDescription className=\"text-base\">\n                  Automated transcription and intelligent summaries for every voice and chat interaction\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card className=\"hover-elevate\">\n              <CardHeader>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-primary/10 rounded-md\">\n                    <Zap className=\"h-6 w-6\" />\n                  </div>\n                  <CardTitle>Automated Workflows</CardTitle>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <CardDescription className=\"text-base\">\n                  Streamlined campaign management, lead assignment, and follow-up scheduling\n                </CardDescription>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3950},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/AppSidebar.tsx":{"content":"import {\n  LayoutDashboard,\n  Phone,\n  Bot,\n  FileText,\n  Users,\n  GitBranch,\n  UserCircle,\n  BookOpen,\n  BarChart3,\n  CreditCard,\n  Settings,\n  PhoneCall,\n} from \"lucide-react\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarFooter,\n} from \"@/components/ui/sidebar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useLocation } from \"wouter\";\n\nexport function AppSidebar() {\n  const [location] = useLocation();\n\n  const aiVoiceSystemItems = [\n    {\n      title: \"Dashboard\",\n      subtitle: \"Overview & analytics\",\n      url: \"/\",\n      icon: LayoutDashboard,\n      testId: \"nav-dashboard\",\n    },\n    {\n      title: \"Calls\",\n      subtitle: \"Voice calls & history\",\n      url: \"/calls\",\n      icon: Phone,\n      testId: \"nav-calls\",\n    },\n    {\n      title: \"AI Agents\",\n      subtitle: \"Voice AI assistants\",\n      url: \"/agents\",\n      icon: Bot,\n      testId: \"nav-agents\",\n      badge: \"6\",\n    },\n  ];\n\n  const crmLeadItems = [\n    {\n      title: \"Leads\",\n      subtitle: \"Lead management & CRM\",\n      url: \"/leads\",\n      icon: Users,\n      testId: \"nav-leads\",\n      badge: \"NEW\",\n    },\n    {\n      title: \"Pipelines\",\n      subtitle: \"Sales pipeline setup\",\n      url: \"/pipelines\",\n      icon: GitBranch,\n      testId: \"nav-pipelines\",\n    },\n    {\n      title: \"Contacts\",\n      subtitle: \"Customer database\",\n      url: \"/contacts\",\n      icon: UserCircle,\n      testId: \"nav-contacts\",\n    },\n  ];\n\n  const businessManagementItems = [\n    {\n      title: \"Knowledge Base\",\n      subtitle: \"AI training data\",\n      url: \"/knowledge-base\",\n      icon: BookOpen,\n      testId: \"nav-knowledge-base\",\n    },\n    {\n      title: \"Analytics\",\n      subtitle: \"Usage & insights\",\n      url: \"/analytics\",\n      icon: BarChart3,\n      testId: \"nav-analytics\",\n    },\n    {\n      title: \"Billing\",\n      subtitle: \"Usage & payments\",\n      url: \"/billing\",\n      icon: CreditCard,\n      testId: \"nav-billing\",\n    },\n  ];\n\n  return (\n    <Sidebar>\n      <SidebarContent>\n        {/* AI VOICE SYSTEM Section */}\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"text-xs font-bold tracking-wider text-muted-foreground uppercase\">\n            AI Voice System\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {aiVoiceSystemItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild isActive={location === item.url}>\n                    <a href={item.url} data-testid={item.testId} className=\"flex items-center gap-3\">\n                      <item.icon className=\"h-4 w-4 flex-shrink-0\" />\n                      <div className=\"flex flex-col flex-1 min-w-0\">\n                        <span className=\"font-medium truncate\">{item.title}</span>\n                        <span className=\"text-xs text-muted-foreground truncate\">{item.subtitle}</span>\n                      </div>\n                      {item.badge && (\n                        <Badge variant=\"secondary\" className=\"ml-auto text-xs\">\n                          {item.badge}\n                        </Badge>\n                      )}\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        {/* CRM & LEAD MANAGEMENT Section */}\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"text-xs font-bold tracking-wider text-muted-foreground uppercase\">\n            CRM & Lead Management\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {crmLeadItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild isActive={location === item.url}>\n                    <a href={item.url} data-testid={item.testId} className=\"flex items-center gap-3\">\n                      <item.icon className=\"h-4 w-4 flex-shrink-0\" />\n                      <div className=\"flex flex-col flex-1 min-w-0\">\n                        <span className=\"font-medium truncate\">{item.title}</span>\n                        <span className=\"text-xs text-muted-foreground truncate\">{item.subtitle}</span>\n                      </div>\n                      {item.badge && (\n                        <Badge variant=\"secondary\" className=\"ml-auto text-xs\">\n                          {item.badge}\n                        </Badge>\n                      )}\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        {/* BUSINESS MANAGEMENT Section */}\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"text-xs font-bold tracking-wider text-muted-foreground uppercase\">\n            Business Management\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {businessManagementItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild isActive={location === item.url}>\n                    <a href={item.url} data-testid={item.testId} className=\"flex items-center gap-3\">\n                      <item.icon className=\"h-4 w-4 flex-shrink-0\" />\n                      <div className=\"flex flex-col flex-1 min-w-0\">\n                        <span className=\"font-medium truncate\">{item.title}</span>\n                        <span className=\"text-xs text-muted-foreground truncate\">{item.subtitle}</span>\n                      </div>\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n\n      {/* Footer Actions */}\n      <SidebarFooter className=\"p-4 border-t\">\n        <div className=\"flex flex-col gap-2\">\n          <Button\n            variant=\"ghost\"\n            className=\"w-full justify-start\"\n            onClick={() => (window.location.href = \"/settings\")}\n            data-testid=\"button-settings\"\n          >\n            <Settings className=\"mr-2 h-4 w-4\" />\n            Settings\n          </Button>\n          <Button\n            variant=\"default\"\n            className=\"w-full justify-start\"\n            onClick={() => (window.location.href = \"/calls\")}\n            data-testid=\"button-new-call\"\n          >\n            <PhoneCall className=\"mr-2 h-4 w-4\" />\n            New Call\n          </Button>\n        </div>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n","size_bytes":6787},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"â€¦\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2210},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/DataTable.tsx":{"content":"import { useState } from \"react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { ChevronDown, ChevronUp, Search } from \"lucide-react\";\n\nexport interface Column<T> {\n  key: keyof T | string;\n  header: string;\n  render?: (item: T) => React.ReactNode;\n  sortable?: boolean;\n}\n\ninterface DataTableProps<T> {\n  data: T[];\n  columns: Column<T>[];\n  searchable?: boolean;\n  searchPlaceholder?: string;\n  onRowClick?: (item: T) => void;\n  isLoading?: boolean;\n  emptyMessage?: string;\n}\n\nexport function DataTable<T extends Record<string, any>>({\n  data,\n  columns,\n  searchable = false,\n  searchPlaceholder = \"Search...\",\n  onRowClick,\n  isLoading = false,\n  emptyMessage = \"No data available\",\n}: DataTableProps<T>) {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [sortColumn, setSortColumn] = useState<string | null>(null);\n  const [sortDirection, setSortDirection] = useState<\"asc\" | \"desc\">(\"asc\");\n\n  const filteredData = searchable\n    ? data.filter((item) =>\n        Object.values(item).some((value) =>\n          String(value).toLowerCase().includes(searchQuery.toLowerCase())\n        )\n      )\n    : data;\n\n  const sortedData = sortColumn\n    ? [...filteredData].sort((a, b) => {\n        const aVal = a[sortColumn];\n        const bVal = b[sortColumn];\n        const modifier = sortDirection === \"asc\" ? 1 : -1;\n        if (aVal < bVal) return -1 * modifier;\n        if (aVal > bVal) return 1 * modifier;\n        return 0;\n      })\n    : filteredData;\n\n  const handleSort = (columnKey: string) => {\n    if (sortColumn === columnKey) {\n      setSortDirection(sortDirection === \"asc\" ? \"desc\" : \"asc\");\n    } else {\n      setSortColumn(columnKey);\n      setSortDirection(\"asc\");\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-4\">\n        {searchable && (\n          <div className=\"h-10 bg-muted animate-pulse rounded-md\" />\n        )}\n        <div className=\"border rounded-md\">\n          <div className=\"h-12 bg-muted animate-pulse\" />\n          {[1, 2, 3, 4, 5].map((i) => (\n            <div key={i} className=\"h-16 bg-card animate-pulse border-t\" />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {searchable && (\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder={searchPlaceholder}\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"pl-9\"\n            data-testid=\"input-search\"\n          />\n        </div>\n      )}\n      <div className=\"border rounded-md overflow-hidden\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              {columns.map((column) => (\n                <TableHead key={String(column.key)}>\n                  {column.sortable ? (\n                    <Button\n                      variant=\"ghost\"\n                      onClick={() => handleSort(String(column.key))}\n                      className=\"hover-elevate -ml-4 h-auto py-2\"\n                      data-testid={`button-sort-${String(column.key)}`}\n                    >\n                      {column.header}\n                      {sortColumn === column.key && (\n                        sortDirection === \"asc\" ? (\n                          <ChevronUp className=\"ml-2 h-4 w-4\" />\n                        ) : (\n                          <ChevronDown className=\"ml-2 h-4 w-4\" />\n                        )\n                      )}\n                    </Button>\n                  ) : (\n                    column.header\n                  )}\n                </TableHead>\n              ))}\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {sortedData.length === 0 ? (\n              <TableRow>\n                <TableCell\n                  colSpan={columns.length}\n                  className=\"h-32 text-center text-muted-foreground\"\n                >\n                  {emptyMessage}\n                </TableCell>\n              </TableRow>\n            ) : (\n              sortedData.map((item, index) => (\n                <TableRow\n                  key={index}\n                  onClick={() => onRowClick?.(item)}\n                  className={onRowClick ? \"cursor-pointer hover-elevate\" : \"\"}\n                  data-testid={`row-${index}`}\n                >\n                  {columns.map((column) => (\n                    <TableCell key={String(column.key)}>\n                      {column.render\n                        ? column.render(item)\n                        : String(item[column.key] ?? \"\")}\n                    </TableCell>\n                  ))}\n                </TableRow>\n              ))\n            )}\n          </TableBody>\n        </Table>\n      </div>\n    </div>\n  );\n}\n","size_bytes":4978},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"server/replitAuth.ts":{"content":"// Reference: javascript_log_in_with_replit integration\nimport * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  const isProduction = process.env.NODE_ENV === 'production';\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: isProduction,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  const userId = claims[\"sub\"];\n  const email = claims[\"email\"];\n  \n  // Check if user exists\n  let user = await storage.getUser(userId);\n  \n  // If user doesn't exist, auto-provision organization\n  if (!user) {\n    const domain = email?.split('@')[1] || 'default';\n    const orgName = domain.split('.')[0].charAt(0).toUpperCase() + domain.split('.')[0].slice(1);\n    \n    // Create or get organization\n    const organization = await storage.upsertOrganization({\n      name: `${orgName} Workspace`,\n      domain: domain,\n    });\n    \n    // Create user with organizationId\n    user = await storage.upsertUser({\n      id: userId,\n      organizationId: organization.id,\n      email: email,\n      firstName: claims[\"first_name\"],\n      lastName: claims[\"last_name\"],\n      profileImageUrl: claims[\"profile_image_url\"],\n      role: 'admin', // First user in organization is admin\n    });\n  } else {\n    // Update existing user\n    user = await storage.upsertUser({\n      id: userId,\n      organizationId: user.organizationId,\n      email: email,\n      firstName: claims[\"first_name\"],\n      lastName: claims[\"last_name\"],\n      profileImageUrl: claims[\"profile_image_url\"],\n      role: user.role,\n    });\n  }\n  \n  return user;\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  const registeredStrategies = new Set<string>();\n\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","size_bytes":5512},"client/src/pages/Home.tsx":{"content":"import { useAuth } from \"@/hooks/useAuth\";\nimport AdminDashboard from \"./dashboards/AdminDashboard\";\nimport SalesAgentDashboard from \"./dashboards/SalesAgentDashboard\";\nimport SiteManagerDashboard from \"./dashboards/SiteManagerDashboard\";\nimport SourcingManagerDashboard from \"./dashboards/SourcingManagerDashboard\";\n\nexport default function Home() {\n  const { user } = useAuth();\n\n  if (!user) return null;\n\n  switch (user.role) {\n    case 'admin':\n      return <AdminDashboard />;\n    case 'sales_agent':\n      return <SalesAgentDashboard />;\n    case 'site_manager':\n      return <SiteManagerDashboard />;\n    case 'sourcing_manager':\n      return <SourcingManagerDashboard />;\n    default:\n      return <SalesAgentDashboard />;\n  }\n}\n","size_bytes":738},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"shared/schema.ts":{"content":"import { sql } from 'drizzle-orm';\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  text,\n  integer,\n  boolean,\n  real,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { relations } from \"drizzle-orm\";\n\n// Session storage table (required for Replit Auth)\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User roles enum\nexport type UserRole = 'admin' | 'agent_manager' | 'analyst' | 'developer';\n\n// Organizations table (for multi-tenant isolation)\nexport const organizations = pgTable(\"organizations\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  domain: varchar(\"domain\").unique(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const organizationsRelations = relations(organizations, ({ many }) => ({\n  users: many(users),\n  aiAgents: many(aiAgents),\n  calls: many(calls),\n  phoneNumbers: many(phoneNumbers),\n}));\n\nexport const insertOrganizationSchema = createInsertSchema(organizations).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertOrganization = z.infer<typeof insertOrganizationSchema>;\nexport type Organization = typeof organizations.$inferSelect;\n\n// Users table (required for Replit Auth)\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey(),\n  organizationId: varchar(\"organization_id\").notNull(),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  role: varchar(\"role\", { length: 50 }).notNull().default('agent_manager'),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  index(\"idx_users_org\").on(table.organizationId),\n  index(\"idx_users_role\").on(table.role),\n]);\n\nexport const usersRelations = relations(users, ({ one, many }) => ({\n  organization: one(organizations, {\n    fields: [users.organizationId],\n    references: [organizations.id],\n  }),\n  aiAgents: many(aiAgents),\n}));\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// AI Agents table - Core voice AI assistant configurations\nexport const aiAgents = pgTable(\"ai_agents\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  organizationId: varchar(\"organization_id\").notNull(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  \n  // Voice configuration\n  voiceId: varchar(\"voice_id\"),\n  voiceName: text(\"voice_name\"),\n  language: varchar(\"language\", { length: 10 }).notNull().default('en-US'),\n  \n  // AI model configuration\n  model: varchar(\"model\", { length: 100 }).notNull().default('gpt-4'),\n  provider: varchar(\"provider\", { length: 50 }).default('openai'),\n  systemPrompt: text(\"system_prompt\"),\n  temperature: real(\"temperature\").default(0.7),\n  maxDuration: integer(\"max_duration\").default(600), // seconds\n  maxTokens: integer(\"max_tokens\").default(150),\n  agentType: varchar(\"agent_type\", { length: 50 }).default('conversational'),\n  voiceProvider: varchar(\"voice_provider\", { length: 50 }).default('elevenlabs'),\n  voiceType: varchar(\"voice_type\", { length: 50 }),\n  \n  // Bolna integration\n  bolnaAgentId: varchar(\"bolna_agent_id\"),\n  bolnaConfig: jsonb(\"bolna_config\"),\n  \n  // Status and metrics\n  status: varchar(\"status\", { length: 50 }).notNull().default('active'),\n  totalCalls: integer(\"total_calls\").notNull().default(0),\n  totalMessages: integer(\"total_messages\").notNull().default(0),\n  avgRating: real(\"avg_rating\"),\n  lastUsedAt: timestamp(\"last_used_at\"),\n  \n  createdBy: varchar(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  index(\"idx_ai_agents_org\").on(table.organizationId),\n  index(\"idx_ai_agents_status\").on(table.status),\n  index(\"idx_ai_agents_created_by\").on(table.createdBy),\n]);\n\nexport const aiAgentsRelations = relations(aiAgents, ({ one, many }) => ({\n  organization: one(organizations, {\n    fields: [aiAgents.organizationId],\n    references: [organizations.id],\n  }),\n  creator: one(users, {\n    fields: [aiAgents.createdBy],\n    references: [users.id],\n  }),\n  calls: many(calls),\n  knowledgeBase: many(knowledgeBase),\n}));\n\nexport const insertAiAgentSchema = createInsertSchema(aiAgents).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  totalCalls: true,\n  totalMessages: true,\n  lastUsedAt: true,\n});\n\nexport type InsertAiAgent = z.infer<typeof insertAiAgentSchema>;\nexport type AiAgent = typeof aiAgents.$inferSelect;\n\n// API-safe schemas for create/update operations (never accept organizationId from client)\n// strict() ensures unknown fields (including organizationId) are rejected\nexport const createAiAgentSchema = insertAiAgentSchema.omit({ organizationId: true }).strict();\nexport const updateAiAgentSchema = createAiAgentSchema.partial().strict();\n\n// Dedicated types for tenant-safe API inputs (excludes organizationId)\nexport type CreateAiAgentInput = z.infer<typeof createAiAgentSchema>;\nexport type UpdateAiAgentInput = z.infer<typeof updateAiAgentSchema>;\n\n// Phone Numbers table - Exotel phone number management\nexport const phoneNumbers = pgTable(\"phone_numbers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  organizationId: varchar(\"organization_id\").notNull(),\n  phoneNumber: varchar(\"phone_number\", { length: 20 }).notNull(),\n  countryCode: varchar(\"country_code\", { length: 5 }).notNull().default('+1'),\n  \n  // Exotel integration\n  exotelSid: varchar(\"exotel_sid\"),\n  exotelStatus: varchar(\"exotel_status\", { length: 50 }),\n  exotelConfig: jsonb(\"exotel_config\"),\n  \n  // Status\n  status: varchar(\"status\", { length: 50 }).notNull().default('active'),\n  assignedAgentId: varchar(\"assigned_agent_id\"),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  index(\"idx_phone_numbers_org\").on(table.organizationId),\n  index(\"idx_phone_numbers_number\").on(table.phoneNumber),\n  index(\"idx_phone_numbers_agent\").on(table.assignedAgentId),\n]);\n\nexport const phoneNumbersRelations = relations(phoneNumbers, ({ one }) => ({\n  organization: one(organizations, {\n    fields: [phoneNumbers.organizationId],\n    references: [organizations.id],\n  }),\n  assignedAgent: one(aiAgents, {\n    fields: [phoneNumbers.assignedAgentId],\n    references: [aiAgents.id],\n  }),\n}));\n\nexport const insertPhoneNumberSchema = createInsertSchema(phoneNumbers).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertPhoneNumber = z.infer<typeof insertPhoneNumberSchema>;\nexport type PhoneNumber = typeof phoneNumbers.$inferSelect;\n\n// Leads table - Contact/prospect management\nexport const leads = pgTable(\"leads\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  organizationId: varchar(\"organization_id\").notNull(),\n  \n  // Contact information\n  name: text(\"name\").notNull(),\n  email: varchar(\"email\"),\n  phone: varchar(\"phone\"),\n  company: text(\"company\"),\n  \n  // Lead status\n  status: varchar(\"status\", { length: 50 }).notNull().default('new'),\n  source: varchar(\"source\", { length: 100 }),\n  tags: text(\"tags\").array(),\n  \n  // Interaction tracking\n  lastContactedAt: timestamp(\"last_contacted_at\"),\n  nextFollowUpAt: timestamp(\"next_follow_up_at\"),\n  totalCalls: integer(\"total_calls\").notNull().default(0),\n  \n  // Notes and AI insights\n  notes: text(\"notes\"),\n  aiSummary: text(\"ai_summary\"),\n  customFields: jsonb(\"custom_fields\"),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  index(\"idx_leads_org\").on(table.organizationId),\n  index(\"idx_leads_status\").on(table.status),\n  index(\"idx_leads_phone\").on(table.phone),\n  index(\"idx_leads_email\").on(table.email),\n]);\n\nexport const leadsRelations = relations(leads, ({ many }) => ({\n  calls: many(calls),\n}));\n\nexport const insertLeadSchema = createInsertSchema(leads).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  totalCalls: true,\n});\n\nexport type InsertLead = z.infer<typeof insertLeadSchema>;\nexport type Lead = typeof leads.$inferSelect;\n\n// Calls table - Voice call records and transcripts\nexport const calls = pgTable(\"calls\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  organizationId: varchar(\"organization_id\").notNull(),\n  leadId: varchar(\"lead_id\"),\n  agentId: varchar(\"agent_id\"),\n  phoneNumberId: varchar(\"phone_number_id\"),\n  \n  // Call details\n  contactName: text(\"contact_name\"),\n  contactPhone: varchar(\"contact_phone\", { length: 20 }),\n  callType: varchar(\"call_type\", { length: 50 }).notNull().default('outbound'),\n  direction: varchar(\"direction\", { length: 20 }).notNull().default('outbound'),\n  \n  // Call status and timing\n  status: varchar(\"status\", { length: 50 }).notNull().default('scheduled'),\n  outcome: varchar(\"outcome\", { length: 50 }),\n  duration: integer(\"duration\"), // seconds\n  scheduledAt: timestamp(\"scheduled_at\"),\n  startedAt: timestamp(\"started_at\"),\n  endedAt: timestamp(\"ended_at\"),\n  \n  // Recordings and transcripts\n  recordingUrl: text(\"recording_url\"),\n  transcription: text(\"transcription\"),\n  aiSummary: text(\"ai_summary\"),\n  sentiment: varchar(\"sentiment\", { length: 20 }),\n  \n  // Integration IDs\n  bolnaCallId: varchar(\"bolna_call_id\"),\n  exotelCallSid: varchar(\"exotel_call_sid\"),\n  \n  // Cost tracking (per minute rates in USD)\n  exotelCostPerMinute: real(\"exotel_cost_per_minute\").default(0),\n  bolnaCostPerMinute: real(\"bolna_cost_per_minute\").default(0),\n  \n  // Metadata\n  metadata: jsonb(\"metadata\"),\n  notes: text(\"notes\"),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  index(\"idx_calls_org\").on(table.organizationId),\n  index(\"idx_calls_lead\").on(table.leadId),\n  index(\"idx_calls_agent\").on(table.agentId),\n  index(\"idx_calls_status\").on(table.status),\n  index(\"idx_calls_created_at\").on(table.createdAt),\n  index(\"idx_calls_started_at\").on(table.startedAt),\n]);\n\nexport const callsRelations = relations(calls, ({ one }) => ({\n  organization: one(organizations, {\n    fields: [calls.organizationId],\n    references: [organizations.id],\n  }),\n  lead: one(leads, {\n    fields: [calls.leadId],\n    references: [leads.id],\n  }),\n  agent: one(aiAgents, {\n    fields: [calls.agentId],\n    references: [aiAgents.id],\n  }),\n  phoneNumber: one(phoneNumbers, {\n    fields: [calls.phoneNumberId],\n    references: [phoneNumbers.id],\n  }),\n}));\n\nexport const insertCallSchema = createInsertSchema(calls).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertCall = z.infer<typeof insertCallSchema>;\nexport type Call = typeof calls.$inferSelect;\n\n// Knowledge Base table - AI training documents and data\nexport const knowledgeBase = pgTable(\"knowledge_base\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  organizationId: varchar(\"organization_id\").notNull(),\n  agentId: varchar(\"agent_id\"),\n  \n  // Document details\n  title: text(\"title\").notNull(),\n  content: text(\"content\").notNull(),\n  contentType: varchar(\"content_type\", { length: 50 }).notNull().default('text'),\n  category: varchar(\"category\", { length: 100 }),\n  tags: text(\"tags\").array(),\n  \n  // File/URL references\n  fileUrl: text(\"file_url\"),\n  sourceUrl: text(\"source_url\"),\n  \n  // Status\n  status: varchar(\"status\", { length: 50 }).notNull().default('active'),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  index(\"idx_knowledge_base_org\").on(table.organizationId),\n  index(\"idx_knowledge_base_agent\").on(table.agentId),\n  index(\"idx_knowledge_base_category\").on(table.category),\n]);\n\nexport const knowledgeBaseRelations = relations(knowledgeBase, ({ one }) => ({\n  organization: one(organizations, {\n    fields: [knowledgeBase.organizationId],\n    references: [organizations.id],\n  }),\n  agent: one(aiAgents, {\n    fields: [knowledgeBase.agentId],\n    references: [aiAgents.id],\n  }),\n}));\n\nexport const insertKnowledgeBaseSchema = createInsertSchema(knowledgeBase).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertKnowledgeBase = z.infer<typeof insertKnowledgeBaseSchema>;\nexport type KnowledgeBase = typeof knowledgeBase.$inferSelect;\n\n// API-safe schemas for knowledge base create/update (never accept organizationId from client)\nexport const createKnowledgeBaseSchema = insertKnowledgeBaseSchema.omit({ organizationId: true }).strict();\nexport const updateKnowledgeBaseSchema = createKnowledgeBaseSchema.partial().strict();\n\nexport type CreateKnowledgeBaseInput = z.infer<typeof createKnowledgeBaseSchema>;\nexport type UpdateKnowledgeBaseInput = z.infer<typeof updateKnowledgeBaseSchema>;\n\n// Analytics and Usage Tracking\nexport const usageTracking = pgTable(\"usage_tracking\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  organizationId: varchar(\"organization_id\").notNull(),\n  \n  // Usage metrics\n  date: timestamp(\"date\").notNull(),\n  totalCalls: integer(\"total_calls\").notNull().default(0),\n  totalMinutes: integer(\"total_minutes\").notNull().default(0),\n  totalMessages: integer(\"total_messages\").notNull().default(0),\n  \n  // Cost tracking\n  bolnaCost: real(\"bolna_cost\").default(0),\n  exotelCost: real(\"exotel_cost\").default(0),\n  openaiCost: real(\"openai_cost\").default(0),\n  totalCost: real(\"total_cost\").default(0),\n  \n  // Metadata\n  metadata: jsonb(\"metadata\"),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => [\n  index(\"idx_usage_tracking_org\").on(table.organizationId),\n  index(\"idx_usage_tracking_date\").on(table.date),\n]);\n\nexport const insertUsageTrackingSchema = createInsertSchema(usageTracking).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertUsageTracking = z.infer<typeof insertUsageTrackingSchema>;\nexport type UsageTracking = typeof usageTracking.$inferSelect;\n\n// Analytics data types\nexport type DashboardMetrics = {\n  totalCalls: number;\n  totalAgents: number;\n  activeAgents: number;\n  successRate: number;\n  conversationsToday: number;\n  usageCostToday: number;\n  avgCallDuration: number;\n};\n\nexport type CallMetrics = {\n  date: string;\n  calls: number;\n  duration: number;\n  successful: number;\n};\n\nexport type AgentPerformance = {\n  agentId: string;\n  agentName: string;\n  totalCalls: number;\n  successfulCalls: number;\n  averageDuration: number;\n  successRate: number;\n  avgRating: number;\n};\n\nexport type CallHistoryItem = {\n  id: string;\n  contactName: string;\n  contactPhone: string;\n  status: string;\n  outcome: string | null;\n  agentName: string | null;\n  dateTime: string;\n  duration: number | null;\n  transcription: string | null;\n};\n\nexport type AnalyticsMetrics = {\n  totalCalls: number;\n  totalLeads: number;\n  responseRate: number;\n  conversionRate: number;\n};\n\nexport type BillingMetrics = {\n  currentMonth: {\n    totalMinutes: number;\n    totalCalls: number;\n    exotelCost: number;\n    bolnaCost: number;\n    markupCost: number;\n    totalCost: number;\n  };\n  previousMonth: {\n    totalMinutes: number;\n    totalCost: number;\n  };\n  costBreakdown: {\n    date: string;\n    exotelCost: number;\n    bolnaCost: number;\n    markupCost: number;\n    totalCost: number;\n    minutes: number;\n  }[];\n};\n\nexport type UsageSummary = {\n  date: string;\n  totalCalls: number;\n  totalMinutes: number;\n  exotelCost: number;\n  bolnaCost: number;\n  markupCost: number;\n  totalCost: number;\n};\n","size_bytes":15770},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { getQueryFn } from \"@/lib/queryClient\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User | null>({\n    queryKey: [\"/api/auth/user\"],\n    queryFn: getQueryFn({ on401: \"returnNull\" }),\n    retry: false,\n  });\n\n  return {\n    user: user || undefined,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","size_bytes":431},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/pages/dashboards/SourcingManagerDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Users, TrendingUp, MessageSquare, Filter, Search, Upload } from \"lucide-react\";\nimport type { ChannelPartner } from \"@shared/schema\";\nimport { DataTable, type Column } from \"@/components/DataTable\";\n\nexport default function SourcingManagerDashboard() {\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: partners, isLoading } = useQuery<ChannelPartner[]>({\n    queryKey: [\"/api/channel-partners\"],\n  });\n\n  const filteredPartners = partners?.filter((partner) => {\n    const matchesStatus = statusFilter === \"all\" || partner.status === statusFilter;\n    const matchesSearch = !searchQuery || \n      partner.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      partner.company?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      partner.email?.toLowerCase().includes(searchQuery.toLowerCase());\n    return matchesStatus && matchesSearch;\n  }) ?? [];\n\n  const engagedPartners = partners?.filter(p => p.status === 'engaged') ?? [];\n  const interestedPartners = partners?.filter(p => p.status === 'interested') ?? [];\n  const inactivePartners = partners?.filter(p => p.status === 'inactive') ?? [];\n  const avgInteractions = partners && partners.length > 0\n    ? Math.round(partners.reduce((sum, p) => sum + p.interactionCount, 0) / partners.length)\n    : 0;\n\n  const stats = [\n    {\n      title: \"Total Partners\",\n      value: partners?.length ?? 0,\n      icon: Users,\n      description: \"Channel partners in system\",\n      testId: \"stat-total\",\n    },\n    {\n      title: \"Engaged\",\n      value: engagedPartners.length,\n      icon: TrendingUp,\n      description: \"Active and engaged\",\n      testId: \"stat-engaged\",\n    },\n    {\n      title: \"Interested\",\n      value: interestedPartners.length,\n      icon: MessageSquare,\n      description: \"Showing interest\",\n      testId: \"stat-interested\",\n    },\n    {\n      title: \"Avg Interactions\",\n      value: avgInteractions,\n      icon: MessageSquare,\n      description: \"Per partner\",\n      testId: \"stat-avg-interactions\",\n    },\n  ];\n\n  const columns: Column<ChannelPartner>[] = [\n    {\n      key: \"name\",\n      header: \"Name\",\n      sortable: true,\n      render: (partner) => (\n        <div>\n          <p className=\"font-medium\">{partner.name}</p>\n          {partner.company && (\n            <p className=\"text-xs text-muted-foreground\">{partner.company}</p>\n          )}\n        </div>\n      ),\n    },\n    {\n      key: \"email\",\n      header: \"Contact\",\n      render: (partner) => (\n        <div className=\"text-sm\">\n          <p>{partner.email}</p>\n          {partner.phone && (\n            <p className=\"text-xs text-muted-foreground\">{partner.phone}</p>\n          )}\n        </div>\n      ),\n    },\n    {\n      key: \"category\",\n      header: \"Category\",\n      sortable: true,\n      render: (partner) => partner.category || \"â€”\",\n    },\n    {\n      key: \"status\",\n      header: \"Status\",\n      sortable: true,\n      render: (partner) => (\n        <Badge variant={\n          partner.status === 'engaged' ? 'default' :\n          partner.status === 'interested' ? 'secondary' :\n          'outline'\n        }>\n          {partner.status}\n        </Badge>\n      ),\n    },\n    {\n      key: \"interactionCount\",\n      header: \"Interactions\",\n      sortable: true,\n      render: (partner) => partner.interactionCount,\n    },\n  ];\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6 p-6 md:p-8\">\n        <div className=\"space-y-2\">\n          <div className=\"h-8 w-48 bg-muted animate-pulse rounded\" />\n          <div className=\"h-5 w-64 bg-muted animate-pulse rounded\" />\n        </div>\n        <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n          {[1, 2, 3, 4].map((i) => (\n            <Card key={i}>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <div className=\"h-5 w-24 bg-muted animate-pulse rounded\" />\n                <div className=\"h-4 w-4 bg-muted animate-pulse rounded\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-8 w-16 bg-muted animate-pulse rounded mb-2\" />\n                <div className=\"h-4 w-32 bg-muted animate-pulse rounded\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n        <div className=\"space-y-1\">\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-dashboard\">\n            Sourcing Manager Dashboard\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Manage channel partners and engagement\n          </p>\n        </div>\n        <Button asChild data-testid=\"button-upload-partners\">\n          <a href=\"/partners/upload\">\n            <Upload className=\"h-4 w-4 mr-2\" />\n            Upload Partners\n          </a>\n        </Button>\n      </div>\n\n      <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"hover-elevate\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <stat.icon className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\" data-testid={stat.testId}>\n                {stat.value}\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                {stat.description}\n              </p>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Channel Partners</CardTitle>\n          <CardDescription>\n            All channel partners with advanced filtering\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex flex-col sm:flex-row gap-3\">\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search partners...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-9\"\n                data-testid=\"input-search-partners\"\n              />\n            </div>\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-full sm:w-48\" data-testid=\"select-status-filter\">\n                <Filter className=\"h-4 w-4 mr-2\" />\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Status</SelectItem>\n                <SelectItem value=\"engaged\">Engaged</SelectItem>\n                <SelectItem value=\"interested\">Interested</SelectItem>\n                <SelectItem value=\"inactive\">Inactive</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <DataTable\n            data={filteredPartners}\n            columns={columns}\n            onRowClick={(partner) => window.location.href = `/partners/${partner.id}`}\n            emptyMessage=\"No partners found. Upload partners to get started.\"\n            isLoading={isLoading}\n          />\n\n          {filteredPartners.length > 0 && (\n            <p className=\"text-sm text-muted-foreground\">\n              Showing {filteredPartners.length} of {partners?.length ?? 0} partners\n            </p>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":8299},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/pages/dashboards/AdminDashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Users, Megaphone, TrendingUp, Phone } from \"lucide-react\";\nimport type { Campaign, Lead, AnalyticsMetrics } from \"@shared/schema\";\n\nexport default function AdminDashboard() {\n  const { data: campaigns, isLoading: campaignsLoading } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  const { data: leads, isLoading: leadsLoading } = useQuery<Lead[]>({\n    queryKey: [\"/api/leads\"],\n  });\n\n  const { data: metrics, isLoading: metricsLoading } = useQuery<AnalyticsMetrics>({\n    queryKey: [\"/api/analytics/metrics\"],\n  });\n\n  const isLoading = campaignsLoading || leadsLoading || metricsLoading;\n\n  const stats = [\n    {\n      title: \"Total Campaigns\",\n      value: campaigns?.length ?? 0,\n      icon: Megaphone,\n      description: \"Active automation campaigns\",\n      testId: \"stat-campaigns\",\n    },\n    {\n      title: \"Total Leads\",\n      value: metrics?.totalLeads ?? 0,\n      icon: Users,\n      description: \"Across all campaigns\",\n      testId: \"stat-leads\",\n    },\n    {\n      title: \"Total Calls\",\n      value: metrics?.totalCalls ?? 0,\n      icon: Phone,\n      description: \"Voice & chat interactions\",\n      testId: \"stat-calls\",\n    },\n    {\n      title: \"Conversion Rate\",\n      value: `${(metrics?.conversionRate ?? 0).toFixed(1)}%`,\n      icon: TrendingUp,\n      description: \"Lead to customer conversion\",\n      testId: \"stat-conversion\",\n    },\n  ];\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6 p-6 md:p-8\">\n        <div className=\"space-y-2\">\n          <div className=\"h-8 w-48 bg-muted animate-pulse rounded\" />\n          <div className=\"h-5 w-64 bg-muted animate-pulse rounded\" />\n        </div>\n        <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n          {[1, 2, 3, 4].map((i) => (\n            <Card key={i}>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <div className=\"h-5 w-24 bg-muted animate-pulse rounded\" />\n                <div className=\"h-4 w-4 bg-muted animate-pulse rounded\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-8 w-16 bg-muted animate-pulse rounded mb-2\" />\n                <div className=\"h-4 w-32 bg-muted animate-pulse rounded\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n        <div className=\"space-y-1\">\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-dashboard\">\n            Admin Dashboard\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Manage campaigns, users, and analytics\n          </p>\n        </div>\n        <Button asChild data-testid=\"button-create-campaign\">\n          <a href=\"/campaigns/new\">Create Campaign</a>\n        </Button>\n      </div>\n\n      <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"hover-elevate\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <stat.icon className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\" data-testid={stat.testId}>\n                {stat.value}\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                {stat.description}\n              </p>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid gap-6 grid-cols-1 lg:grid-cols-2\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Recent Campaigns</CardTitle>\n            <CardDescription>\n              Latest automation campaigns\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {campaigns?.slice(0, 5).map((campaign) => (\n                <div\n                  key={campaign.id}\n                  className=\"flex items-center justify-between p-3 rounded-md border hover-elevate cursor-pointer\"\n                  onClick={() => window.location.href = `/campaigns/${campaign.id}`}\n                  data-testid={`campaign-${campaign.id}`}\n                >\n                  <div className=\"space-y-1\">\n                    <p className=\"text-sm font-medium\">{campaign.name}</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      {campaign.totalLeads} leads â€¢ {campaign.completedLeads} completed\n                    </p>\n                  </div>\n                  <div className={`px-2 py-1 text-xs rounded-md ${\n                    campaign.status === 'active' ? 'bg-primary/10 text-primary' :\n                    campaign.status === 'completed' ? 'bg-muted' :\n                    'bg-secondary'\n                  }`}>\n                    {campaign.status}\n                  </div>\n                </div>\n              ))}\n              {(!campaigns || campaigns.length === 0) && (\n                <p className=\"text-sm text-muted-foreground text-center py-8\">\n                  No campaigns yet. Create your first campaign to get started.\n                </p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Recent Leads</CardTitle>\n            <CardDescription>\n              Latest lead activity\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {leads?.slice(0, 5).map((lead) => (\n                <div\n                  key={lead.id}\n                  className=\"flex items-center justify-between p-3 rounded-md border hover-elevate cursor-pointer\"\n                  onClick={() => window.location.href = `/leads/${lead.id}`}\n                  data-testid={`lead-${lead.id}`}\n                >\n                  <div className=\"space-y-1\">\n                    <p className=\"text-sm font-medium\">{lead.name}</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      {lead.company || lead.email || lead.phone}\n                    </p>\n                  </div>\n                  <div className={`px-2 py-1 text-xs rounded-md ${\n                    lead.status === 'qualified' ? 'bg-primary/10 text-primary' :\n                    lead.status === 'contacted' ? 'bg-secondary' :\n                    'bg-muted'\n                  }`}>\n                    {lead.status}\n                  </div>\n                </div>\n              ))}\n              {(!leads || leads.length === 0) && (\n                <p className=\"text-sm text-muted-foreground text-center py-8\">\n                  No leads yet. Upload leads or start a campaign.\n                </p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":7379},"client/src/pages/Analytics.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { BarChart, Bar, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\nimport { Download, TrendingUp, Phone, Users, Target } from \"lucide-react\";\nimport type { AnalyticsMetrics, CallMetrics, AgentPerformance } from \"@shared/schema\";\n\nexport default function Analytics() {\n  const { toast } = useToast();\n  const { isAuthenticated, isLoading: authLoading } = useAuth();\n  const [timeRange, setTimeRange] = useState(\"7d\");\n\n  useEffect(() => {\n    if (!authLoading && !isAuthenticated) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"You are logged out. Logging in again...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n    }\n  }, [isAuthenticated, authLoading, toast]);\n\n  const { data: metrics, isLoading: metricsLoading} = useQuery<AnalyticsMetrics>({\n    queryKey: [`/api/analytics/metrics?timeRange=${timeRange}`],\n  });\n\n  const { data: callMetrics, isLoading: callMetricsLoading } = useQuery<CallMetrics[]>({\n    queryKey: [`/api/analytics/calls?timeRange=${timeRange}`],\n  });\n\n  const { data: agentPerformance, isLoading: agentPerformanceLoading } = useQuery<AgentPerformance[]>({\n    queryKey: [`/api/analytics/agents?timeRange=${timeRange}`],\n  });\n\n  const isLoading = metricsLoading || callMetricsLoading || agentPerformanceLoading;\n\n  if (authLoading || !isAuthenticated) {\n    return null;\n  }\n\n  const stats = [\n    {\n      title: \"Total Calls\",\n      value: metrics?.totalCalls ?? 0,\n      icon: Phone,\n      description: \"All voice & chat interactions\",\n      testId: \"stat-calls\",\n    },\n    {\n      title: \"Total Leads\",\n      value: metrics?.totalLeads ?? 0,\n      icon: Users,\n      description: \"Leads contacted\",\n      testId: \"stat-leads\",\n    },\n    {\n      title: \"Response Rate\",\n      value: `${(metrics?.responseRate ?? 0).toFixed(1)}%`,\n      icon: TrendingUp,\n      description: \"Lead response percentage\",\n      testId: \"stat-response\",\n    },\n    {\n      title: \"Conversion Rate\",\n      value: `${(metrics?.conversionRate ?? 0).toFixed(1)}%`,\n      icon: Target,\n      description: \"Lead to customer conversion\",\n      testId: \"stat-conversion\",\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n        <div className=\"space-y-1\">\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-analytics\">\n            Analytics\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Performance metrics and insights\n          </p>\n        </div>\n        <div className=\"flex gap-3\">\n          <Select value={timeRange} onValueChange={setTimeRange}>\n            <SelectTrigger className=\"w-32\" data-testid=\"select-time-range\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"7d\">Last 7 days</SelectItem>\n              <SelectItem value=\"30d\">Last 30 days</SelectItem>\n              <SelectItem value=\"90d\">Last 90 days</SelectItem>\n            </SelectContent>\n          </Select>\n          <Button variant=\"outline\" data-testid=\"button-export\">\n            <Download className=\"h-4 w-4 mr-2\" />\n            Export\n          </Button>\n        </div>\n      </div>\n\n      {isLoading ? (\n        <div className=\"space-y-6\">\n          <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n            {[1, 2, 3, 4].map((i) => (\n              <Card key={i}>\n                <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                  <div className=\"h-5 w-24 bg-muted animate-pulse rounded\" />\n                  <div className=\"h-4 w-4 bg-muted animate-pulse rounded\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded mb-2\" />\n                  <div className=\"h-4 w-32 bg-muted animate-pulse rounded\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n          <Card>\n            <CardHeader>\n              <div className=\"h-6 w-32 bg-muted animate-pulse rounded\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"h-64 bg-muted animate-pulse rounded\" />\n            </CardContent>\n          </Card>\n        </div>\n      ) : (\n        <>\n          <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n            {stats.map((stat) => (\n              <Card key={stat.title} className=\"hover-elevate\">\n                <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">\n                    {stat.title}\n                  </CardTitle>\n                  <stat.icon className=\"h-4 w-4 text-muted-foreground\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\" data-testid={stat.testId}>\n                    {stat.value}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {stat.description}\n                  </p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Call Activity</CardTitle>\n              <CardDescription>\n                Daily call volume and duration trends\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <LineChart data={callMetrics ?? []}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-border\" />\n                  <XAxis\n                    dataKey=\"date\"\n                    className=\"text-xs\"\n                    tickLine={false}\n                  />\n                  <YAxis className=\"text-xs\" tickLine={false} />\n                  <Tooltip\n                    contentStyle={{\n                      backgroundColor: 'hsl(var(--card))',\n                      border: '1px solid hsl(var(--border))',\n                      borderRadius: '8px',\n                    }}\n                  />\n                  <Line\n                    type=\"monotone\"\n                    dataKey=\"calls\"\n                    stroke=\"hsl(var(--primary))\"\n                    strokeWidth={2}\n                    dot={{ r: 4 }}\n                    name=\"Calls\"\n                  />\n                  <Line\n                    type=\"monotone\"\n                    dataKey=\"successful\"\n                    stroke=\"hsl(var(--chart-2))\"\n                    strokeWidth={2}\n                    dot={{ r: 4 }}\n                    name=\"Successful\"\n                  />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Agent Performance</CardTitle>\n              <CardDescription>\n                Performance metrics by agent\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <BarChart data={agentPerformance ?? []}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-border\" />\n                  <XAxis\n                    dataKey=\"agentName\"\n                    className=\"text-xs\"\n                    tickLine={false}\n                  />\n                  <YAxis className=\"text-xs\" tickLine={false} />\n                  <Tooltip\n                    contentStyle={{\n                      backgroundColor: 'hsl(var(--card))',\n                      border: '1px solid hsl(var(--border))',\n                      borderRadius: '8px',\n                    }}\n                  />\n                  <Bar dataKey=\"totalCalls\" fill=\"hsl(var(--primary))\" name=\"Total Calls\" />\n                  <Bar dataKey=\"successfulCalls\" fill=\"hsl(var(--chart-2))\" name=\"Successful\" />\n                </BarChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </>\n      )}\n    </div>\n  );\n}\n","size_bytes":8784},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/pages/dashboards/SiteManagerDashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { MapPin, Calendar, CheckCircle2, Clock } from \"lucide-react\";\nimport type { Visit } from \"@shared/schema\";\nimport { format } from \"date-fns\";\n\nexport default function SiteManagerDashboard() {\n  const { data: visits, isLoading } = useQuery<Visit[]>({\n    queryKey: [\"/api/visits/my\"],\n  });\n\n  const scheduledVisits = visits?.filter(v => v.status === 'scheduled') ?? [];\n  const completedVisits = visits?.filter(v => v.status === 'completed') ?? [];\n  const inProgressVisits = visits?.filter(v => v.status === 'in_progress') ?? [];\n  const todayVisits = visits?.filter(v =>\n    v.scheduledAt && format(new Date(v.scheduledAt), 'yyyy-MM-dd') === format(new Date(), 'yyyy-MM-dd')\n  ) ?? [];\n\n  const stats = [\n    {\n      title: \"Scheduled Visits\",\n      value: scheduledVisits.length,\n      icon: Calendar,\n      description: \"Upcoming site visits\",\n      testId: \"stat-scheduled\",\n    },\n    {\n      title: \"Today's Visits\",\n      value: todayVisits.length,\n      icon: Clock,\n      description: \"Visits scheduled today\",\n      testId: \"stat-today\",\n    },\n    {\n      title: \"In Progress\",\n      value: inProgressVisits.length,\n      icon: MapPin,\n      description: \"Currently ongoing\",\n      testId: \"stat-in-progress\",\n    },\n    {\n      title: \"Completed\",\n      value: completedVisits.length,\n      icon: CheckCircle2,\n      description: \"Successfully completed\",\n      testId: \"stat-completed\",\n    },\n  ];\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6 p-6 md:p-8\">\n        <div className=\"space-y-2\">\n          <div className=\"h-8 w-48 bg-muted animate-pulse rounded\" />\n          <div className=\"h-5 w-64 bg-muted animate-pulse rounded\" />\n        </div>\n        <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n          {[1, 2, 3, 4].map((i) => (\n            <Card key={i}>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <div className=\"h-5 w-24 bg-muted animate-pulse rounded\" />\n                <div className=\"h-4 w-4 bg-muted animate-pulse rounded\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-8 w-16 bg-muted animate-pulse rounded mb-2\" />\n                <div className=\"h-4 w-32 bg-muted animate-pulse rounded\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n        <div className=\"space-y-1\">\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-dashboard\">\n            Site Manager Dashboard\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Manage site visits and inspections\n          </p>\n        </div>\n        <Button asChild data-testid=\"button-schedule-visit\">\n          <a href=\"/visits/new\">Schedule Visit</a>\n        </Button>\n      </div>\n\n      <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"hover-elevate\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <stat.icon className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\" data-testid={stat.testId}>\n                {stat.value}\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                {stat.description}\n              </p>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Upcoming Visits</CardTitle>\n          <CardDescription>\n            Scheduled site visits and inspections\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {scheduledVisits.map((visit) => (\n              <div\n                key={visit.id}\n                className=\"flex flex-col sm:flex-row sm:items-center justify-between p-4 rounded-md border hover-elevate cursor-pointer gap-3\"\n                onClick={() => window.location.href = `/visits/${visit.id}`}\n                data-testid={`visit-${visit.id}`}\n              >\n                <div className=\"flex-1 space-y-1\">\n                  <div className=\"flex items-center gap-2 flex-wrap\">\n                    <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n                    <p className=\"text-sm font-medium\">{visit.location || 'Location TBD'}</p>\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      {visit.status}\n                    </Badge>\n                  </div>\n                  {visit.scheduledAt && (\n                    <p className=\"text-xs text-muted-foreground\">\n                      Scheduled: {format(new Date(visit.scheduledAt), 'PPp')}\n                    </p>\n                  )}\n                  {visit.notes && (\n                    <p className=\"text-xs text-muted-foreground line-clamp-2\">\n                      {visit.notes}\n                    </p>\n                  )}\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    size=\"sm\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      window.location.href = `/visits/${visit.id}/start`;\n                    }}\n                    data-testid={`button-start-${visit.id}`}\n                  >\n                    Start Visit\n                  </Button>\n                </div>\n              </div>\n            ))}\n            {scheduledVisits.length === 0 && (\n              <p className=\"text-sm text-muted-foreground text-center py-8\">\n                No scheduled visits. Schedule a new site visit to get started.\n              </p>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6418},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"server/openai.ts":{"content":"// Reference: javascript_openai integration\nimport OpenAI from \"openai\";\n\n// the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\nconst openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\n\nexport async function generateAISummary(text: string): Promise<string> {\n  try {\n    const response = await openai.chat.completions.create({\n      model: \"gpt-5\",\n      messages: [\n        {\n          role: \"system\",\n          content: \"You are an AI assistant that creates concise, professional summaries of conversations and interactions. Focus on key points, outcomes, and action items.\",\n        },\n        {\n          role: \"user\",\n          content: `Please summarize the following conversation:\\n\\n${text}`,\n        },\n      ],\n      max_completion_tokens: 500,\n    });\n\n    return response.choices[0].message.content || \"No summary available.\";\n  } catch (error) {\n    console.error(\"Error generating AI summary:\", error);\n    return \"Summary generation failed.\";\n  }\n}\n\nexport async function analyzeLeadQualification(leadData: {\n  name: string;\n  company?: string;\n  notes?: string;\n}): Promise<string> {\n  try {\n    const response = await openai.chat.completions.create({\n      model: \"gpt-5\",\n      messages: [\n        {\n          role: \"system\",\n          content: \"You are a sales assistant AI that helps qualify leads. Provide concise insights about lead potential, recommended actions, and priority level.\",\n        },\n        {\n          role: \"user\",\n          content: `Analyze this lead:\\nName: ${leadData.name}\\nCompany: ${leadData.company || 'Unknown'}\\nNotes: ${leadData.notes || 'No notes'}\\n\\nProvide a brief qualification assessment.`,\n        },\n      ],\n      max_completion_tokens: 300,\n    });\n\n    return response.choices[0].message.content || \"No analysis available.\";\n  } catch (error) {\n    console.error(\"Error analyzing lead:\", error);\n    return \"Lead analysis failed.\";\n  }\n}\n\nexport async function generateMeetingSummary(transcription: string): Promise<string> {\n  try {\n    const response = await openai.chat.completions.create({\n      model: \"gpt-5\",\n      messages: [\n        {\n          role: \"system\",\n          content: \"You are an AI assistant that creates structured meeting summaries. Include: 1) Key discussion points, 2) Decisions made, 3) Action items, 4) Follow-up needed.\",\n        },\n        {\n          role: \"user\",\n          content: `Create a meeting summary from this transcription:\\n\\n${transcription}`,\n        },\n      ],\n      max_completion_tokens: 600,\n    });\n\n    return response.choices[0].message.content || \"No summary available.\";\n  } catch (error) {\n    console.error(\"Error generating meeting summary:\", error);\n    return \"Meeting summary generation failed.\";\n  }\n}\n","size_bytes":2813},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* ========================================\n   MINIMAL BLACK & WHITE THEME\n   Strict monochrome design system\n   ======================================== */\n\n/* LIGHT MODE (Default) */\n:root {\n  /* Backgrounds */\n  --bg-primary: 0 0% 100%;           /* #FFFFFF */\n  --bg-secondary: 0 0% 98%;          /* #FAFAFA */\n  --bg-sidebar: 0 0% 100%;           /* #FFFFFF */\n  --bg-card: 0 0% 100%;              /* #FFFFFF */\n  \n  /* Core Colors */\n  --background: 0 0% 100%;           /* White background */\n  --foreground: 0 0% 0%;             /* Black text */\n  \n  /* Text Colors */\n  --text-primary: 0 0% 0%;           /* #000000 */\n  --text-secondary: 0 0% 40%;        /* #666666 */\n  --text-muted: 0 0% 60%;            /* #999999 */\n  \n  /* Buttons */\n  --btn-primary-bg: 0 0% 0%;         /* #000000 */\n  --btn-primary-text: 0 0% 100%;     /* #FFFFFF */\n  --btn-secondary-bg: 0 0% 100%;     /* #FFFFFF */\n  --btn-secondary-text: 0 0% 0%;     /* #000000 */\n  --btn-secondary-border: 0 0% 0%;   /* #000000 */\n  \n  /* Borders & Dividers */\n  --border-color: 0 0% 90%;          /* #E5E5E5 */\n  --divider: 0 0% 94%;               /* #F0F0F0 */\n  \n  /* Component Colors */\n  --border: 0 0% 90%;                /* #E5E5E5 */\n  --input: 0 0% 90%;                 /* #E5E5E5 */\n  --ring: 0 0% 0%;                   /* Black focus ring */\n  \n  /* Cards */\n  --card: 0 0% 100%;                 /* White */\n  --card-foreground: 0 0% 0%;        /* Black */\n  --card-border: 0 0% 90%;           /* #E5E5E5 */\n  \n  /* Sidebar */\n  --sidebar: 0 0% 100%;              /* White */\n  --sidebar-foreground: 0 0% 0%;     /* Black */\n  --sidebar-border: 0 0% 90%;        /* #E5E5E5 */\n  --sidebar-primary: 0 0% 0%;        /* Black */\n  --sidebar-primary-foreground: 0 0% 100%; /* White */\n  --sidebar-accent: 0 0% 96%;        /* Very light gray */\n  --sidebar-accent-foreground: 0 0% 0%; /* Black */\n  --sidebar-ring: 0 0% 0%;           /* Black */\n  \n  /* Popover */\n  --popover: 0 0% 100%;              /* White */\n  --popover-foreground: 0 0% 0%;     /* Black */\n  --popover-border: 0 0% 90%;        /* #E5E5E5 */\n  \n  /* Primary */\n  --primary: 0 0% 0%;                /* Black */\n  --primary-foreground: 0 0% 100%;   /* White */\n  \n  /* Secondary */\n  --secondary: 0 0% 96%;             /* Very light gray */\n  --secondary-foreground: 0 0% 0%;   /* Black */\n  \n  /* Muted */\n  --muted: 0 0% 96%;                 /* Very light gray */\n  --muted-foreground: 0 0% 40%;      /* #666666 */\n  \n  /* Accent */\n  --accent: 0 0% 96%;                /* Very light gray */\n  --accent-foreground: 0 0% 0%;      /* Black */\n  \n  /* Destructive (Minimal - uses black/gray) */\n  --destructive: 0 0% 0%;            /* Black */\n  --destructive-foreground: 0 0% 100%; /* White */\n  \n  /* Status Colors (Minimal accents - grayscale only per user requirements) */\n  --success: 0 0% 0%;                /* Black */\n  --warning: 0 0% 40%;               /* Gray #666666 */\n  --error: 0 0% 0%;                  /* Black */\n  --info: 0 0% 20%;                  /* Dark gray #333333 */\n  \n  /* Charts (Grayscale) */\n  --chart-1: 0 0% 0%;                /* Black */\n  --chart-2: 0 0% 20%;               /* Dark gray */\n  --chart-3: 0 0% 40%;               /* Medium gray */\n  --chart-4: 0 0% 60%;               /* Light gray */\n  --chart-5: 0 0% 80%;               /* Very light gray */\n  \n  /* Typography */\n  --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\n  --font-serif: 'Inter', system-ui, -apple-system, sans-serif;\n  --font-mono: 'SF Mono', Monaco, 'Cascadia Code', Menlo, monospace;\n  \n  /* Spacing & Borders */\n  --radius: 0.75rem;                 /* 12px border radius */\n  --spacing: 0.25rem;\n  \n  /* Shadows (Very subtle) */\n  --shadow-2xs: 0px 1px 2px rgba(0, 0, 0, 0.04);\n  --shadow-xs: 0px 1px 3px rgba(0, 0, 0, 0.08);\n  --shadow-sm: 0px 2px 4px rgba(0, 0, 0, 0.08);\n  --shadow: 0px 2px 8px rgba(0, 0, 0, 0.1);\n  --shadow-md: 0px 4px 12px rgba(0, 0, 0, 0.1);\n  --shadow-lg: 0px 8px 16px rgba(0, 0, 0, 0.12);\n  --shadow-xl: 0px 12px 24px rgba(0, 0, 0, 0.15);\n  --shadow-2xl: 0px 16px 32px rgba(0, 0, 0, 0.18);\n  \n  /* Elevation system */\n  --button-outline: rgba(0, 0, 0, 0.10);\n  --badge-outline: rgba(0, 0, 0, 0.05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0, 0, 0, 0.03);\n  --elevate-2: rgba(0, 0, 0, 0.08);\n  \n  /* Borders with calc */\n  --primary-border: hsl(var(--primary));\n  --secondary-border: hsl(var(--secondary));\n  --muted-border: hsl(var(--muted));\n  --accent-border: hsl(var(--accent));\n  --destructive-border: hsl(var(--destructive));\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n}\n\n/* DARK MODE */\n.dark {\n  /* Backgrounds */\n  --bg-primary: 0 0% 0%;             /* #000000 */\n  --bg-secondary: 0 0% 4%;           /* #0A0A0A */\n  --bg-sidebar: 0 0% 0%;             /* #000000 */\n  --bg-card: 0 0% 4%;                /* #0A0A0A */\n  \n  /* Core Colors */\n  --background: 0 0% 0%;             /* Black background */\n  --foreground: 0 0% 100%;           /* White text */\n  \n  /* Text Colors */\n  --text-primary: 0 0% 100%;         /* #FFFFFF */\n  --text-secondary: 0 0% 63%;        /* #A0A0A0 */\n  --text-muted: 0 0% 40%;            /* #666666 */\n  \n  /* Buttons */\n  --btn-primary-bg: 0 0% 100%;       /* #FFFFFF */\n  --btn-primary-text: 0 0% 0%;       /* #000000 */\n  --btn-secondary-bg: 0 0% 0%;       /* #000000 */\n  --btn-secondary-text: 0 0% 100%;   /* #FFFFFF */\n  --btn-secondary-border: 0 0% 100%; /* #FFFFFF */\n  \n  /* Borders & Dividers */\n  --border-color: 0 0% 10%;          /* #1A1A1A */\n  --divider: 0 0% 6%;                /* #0F0F0F */\n  \n  /* Component Colors */\n  --border: 0 0% 10%;                /* #1A1A1A */\n  --input: 0 0% 10%;                 /* #1A1A1A */\n  --ring: 0 0% 100%;                 /* White focus ring */\n  \n  /* Cards */\n  --card: 0 0% 4%;                   /* #0A0A0A */\n  --card-foreground: 0 0% 100%;      /* White */\n  --card-border: 0 0% 10%;           /* #1A1A1A */\n  \n  /* Sidebar */\n  --sidebar: 0 0% 0%;                /* Black */\n  --sidebar-foreground: 0 0% 100%;   /* White */\n  --sidebar-border: 0 0% 10%;        /* #1A1A1A */\n  --sidebar-primary: 0 0% 100%;      /* White */\n  --sidebar-primary-foreground: 0 0% 0%; /* Black */\n  --sidebar-accent: 0 0% 8%;         /* Very dark gray */\n  --sidebar-accent-foreground: 0 0% 100%; /* White */\n  --sidebar-ring: 0 0% 100%;         /* White */\n  \n  /* Popover */\n  --popover: 0 0% 0%;                /* Black */\n  --popover-foreground: 0 0% 100%;   /* White */\n  --popover-border: 0 0% 10%;        /* #1A1A1A */\n  \n  /* Primary */\n  --primary: 0 0% 100%;              /* White */\n  --primary-foreground: 0 0% 0%;     /* Black */\n  \n  /* Secondary */\n  --secondary: 0 0% 8%;              /* Very dark gray */\n  --secondary-foreground: 0 0% 100%; /* White */\n  \n  /* Muted */\n  --muted: 0 0% 10%;                 /* Dark gray */\n  --muted-foreground: 0 0% 63%;      /* #A0A0A0 */\n  \n  /* Accent */\n  --accent: 0 0% 8%;                 /* Very dark gray */\n  --accent-foreground: 0 0% 100%;    /* White */\n  \n  /* Destructive */\n  --destructive: 0 0% 100%;          /* White */\n  --destructive-foreground: 0 0% 0%; /* Black */\n  \n  /* Charts (Grayscale - inverted) */\n  --chart-1: 0 0% 100%;              /* White */\n  --chart-2: 0 0% 80%;               /* Light gray */\n  --chart-3: 0 0% 60%;               /* Medium gray */\n  --chart-4: 0 0% 40%;               /* Dark gray */\n  --chart-5: 0 0% 20%;               /* Very dark gray */\n  \n  /* Shadows (Very subtle with white glow) */\n  --shadow-2xs: 0px 1px 2px rgba(255, 255, 255, 0.02);\n  --shadow-xs: 0px 1px 3px rgba(255, 255, 255, 0.04);\n  --shadow-sm: 0px 2px 4px rgba(255, 255, 255, 0.05);\n  --shadow: 0px 2px 8px rgba(255, 255, 255, 0.06);\n  --shadow-md: 0px 4px 12px rgba(255, 255, 255, 0.08);\n  --shadow-lg: 0px 8px 16px rgba(255, 255, 255, 0.10);\n  --shadow-xl: 0px 12px 24px rgba(255, 255, 255, 0.12);\n  --shadow-2xl: 0px 16px 32px rgba(255, 255, 255, 0.15);\n  \n  /* Elevation system */\n  --button-outline: rgba(255, 255, 255, 0.10);\n  --badge-outline: rgba(255, 255, 255, 0.05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255, 255, 255, 0.04);\n  --elevate-2: rgba(255, 255, 255, 0.09);\n  \n  /* Borders with calc */\n  --primary-border: hsl(var(--primary));\n  --secondary-border: hsl(var(--secondary));\n  --muted-border: hsl(var(--muted));\n  --accent-border: hsl(var(--accent));\n  --destructive-border: hsl(var(--destructive));\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n    letter-spacing: -0.011em; /* Tighter tracking for minimal aesthetic */\n  }\n  \n  /* Premium typography hierarchy */\n  h1 {\n    @apply text-4xl font-bold tracking-tight;\n  }\n  \n  h2 {\n    @apply text-3xl font-semibold tracking-tight;\n  }\n  \n  h3 {\n    @apply text-2xl font-semibold;\n  }\n  \n  h4 {\n    @apply text-xl font-medium;\n  }\n  \n  /* Subtle transitions */\n  button, a, [role=\"button\"] {\n    @apply transition-all duration-150;\n  }\n}\n\n/**\n * Elevation System\n * Provides subtle interaction feedback through opacity/brightness\n */\n@layer utilities {\n  \n  /* Hide search cancel button */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder for contentEditable */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* Escape hatches for default interactions */\n  .no-default-hover-elevate {}\n  .no-default-active-elevate {}\n\n  /* Toggle elevation (background layer) */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: -1;\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Hover/Active elevation (foreground layer) */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: 999;\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after {\n    inset: -1px;\n  }\n  \n  /* Minimal hover effects for cards */\n  .card-hover {\n    @apply transition-all duration-200;\n  }\n  \n  .card-hover:hover {\n    @apply -translate-y-0.5 shadow-md;\n  }\n  \n  /* Status indicators (monochrome) */\n  .status-active {\n    @apply bg-foreground text-background;\n  }\n  \n  .status-inactive {\n    @apply bg-muted text-muted-foreground;\n  }\n  \n  .status-pending {\n    @apply bg-secondary text-secondary-foreground;\n  }\n}\n","size_bytes":11891},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/hooks/use-toast.ts":{"content":"import { useState, useEffect, type ReactNode } from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: ReactNode\n  description?: ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = useState<State>(memoryState)\n\n  useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3900},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/contexts/ThemeContext\";\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/AppSidebar\";\nimport { ThemeToggle } from \"@/components/ThemeToggle\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Button } from \"@/components/ui/button\";\nimport { WebSocketProvider } from \"@/lib/useWebSocket\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/Landing\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport AIAgents from \"@/pages/AIAgents\";\nimport CallHistory from \"@/pages/CallHistory\";\nimport Leads from \"@/pages/Leads\";\nimport Pipelines from \"@/pages/Pipelines\";\nimport Contacts from \"@/pages/Contacts\";\nimport KnowledgeBase from \"@/pages/KnowledgeBase\";\nimport Analytics from \"@/pages/Analytics\";\nimport Billing from \"@/pages/Billing\";\nimport Settings from \"@/pages/Settings\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  return (\n    <Switch>\n      {!isAuthenticated ? (\n        <>\n          <Route path=\"/\" component={Landing} />\n          <Route component={Landing} />\n        </>\n      ) : (\n        <>\n          <Route path=\"/\" component={Dashboard} />\n          <Route path=\"/calls\" component={CallHistory} />\n          <Route path=\"/agents\" component={AIAgents} />\n          <Route path=\"/leads\" component={Leads} />\n          <Route path=\"/pipelines\" component={Pipelines} />\n          <Route path=\"/contacts\" component={Contacts} />\n          <Route path=\"/knowledge-base\" component={KnowledgeBase} />\n          <Route path=\"/analytics\" component={Analytics} />\n          <Route path=\"/billing\" component={Billing} />\n          <Route path=\"/settings\" component={Settings} />\n          <Route component={NotFound} />\n        </>\n      )}\n    </Switch>\n  );\n}\n\nfunction AuthenticatedLayout() {\n  const { user } = useAuth();\n  const style = {\n    \"--sidebar-width\": \"20rem\",\n    \"--sidebar-width-icon\": \"4rem\",\n  };\n\n  return (\n    <WebSocketProvider>\n      <SidebarProvider style={style as React.CSSProperties}>\n        <div className=\"flex h-screen w-full\">\n          <AppSidebar />\n          <div className=\"flex flex-col flex-1 overflow-hidden\">\n            <header className=\"flex items-center justify-between p-4 border-b bg-background\">\n              <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n              <div className=\"flex items-center gap-3\">\n                <ThemeToggle />\n                <div className=\"flex items-center gap-3\">\n                  <Avatar className=\"h-8 w-8\">\n                    <AvatarImage src={user?.profileImageUrl || undefined} />\n                    <AvatarFallback>\n                      {user?.firstName?.[0] || user?.email?.[0] || 'U'}\n                    </AvatarFallback>\n                  </Avatar>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => window.location.href = '/api/logout'}\n                    data-testid=\"button-logout\"\n                  >\n                    Logout\n                  </Button>\n                </div>\n              </div>\n            </header>\n            <main className=\"flex-1 overflow-auto\">\n              <Router />\n            </main>\n          </div>\n        </div>\n      </SidebarProvider>\n    </WebSocketProvider>\n  );\n}\n\nfunction UnauthenticatedLayout() {\n  return (\n    <div className=\"min-h-screen\">\n      <Router />\n    </div>\n  );\n}\n\nfunction AppContent() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  return isAuthenticated ? <AuthenticatedLayout /> : <UnauthenticatedLayout />;\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider>\n        <TooltipProvider>\n          <AppContent />\n          <Toaster />\n        </TooltipProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n","size_bytes":4649},"client/src/pages/CampaignDetail.tsx":{"content":"import { useRoute, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, Edit, Trash2, Loader2, Upload, Users, CheckCircle2 } from \"lucide-react\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport type { Campaign, Lead } from \"@shared/schema\";\nimport { format } from \"date-fns\";\n\nexport default function CampaignDetail() {\n  const [, params] = useRoute(\"/campaigns/:id\");\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n\n  const { data: campaign, isLoading } = useQuery<Campaign>({\n    queryKey: ['/api/campaigns', params?.id],\n    enabled: !!params?.id,\n  });\n\n  const { data: leads = [] } = useQuery<Lead[]>({\n    queryKey: ['/api/leads'],\n    select: (data) => data.filter(lead => lead.campaignId === params?.id),\n    enabled: !!params?.id,\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: () => apiRequest(`/api/campaigns/${params?.id}`, {\n      method: 'DELETE',\n    }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/campaigns'] });\n      toast({\n        title: \"Success\",\n        description: \"Campaign deleted successfully\",\n      });\n      navigate('/campaigns');\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete campaign\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[400px]\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  if (!campaign) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-[400px] space-y-4\">\n        <p className=\"text-muted-foreground\">Campaign not found</p>\n        <Button onClick={() => navigate('/campaigns')} data-testid=\"button-back-to-campaigns\">\n          Back to Campaigns\n        </Button>\n      </div>\n    );\n  }\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active': return 'bg-primary/10 text-primary border-primary/20';\n      case 'completed': return 'bg-muted text-muted-foreground border-border';\n      case 'paused': return 'bg-secondary/10 text-secondary-foreground border-secondary/20';\n      default: return 'bg-muted text-muted-foreground border-border';\n    }\n  };\n\n  const completionRate = campaign.totalLeads > 0\n    ? Math.round((campaign.completedLeads / campaign.totalLeads) * 100)\n    : 0;\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => navigate('/campaigns')}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n          </Button>\n          <div>\n            <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-campaign-name\">\n              {campaign.name}\n            </h1>\n            <p className=\"text-muted-foreground\">\n              Campaign Details\n            </p>\n          </div>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={() => navigate(`/campaigns/${campaign.id}/edit`)}\n            data-testid=\"button-edit-campaign\"\n          >\n            <Edit className=\"h-4 w-4 mr-2\" />\n            Edit\n          </Button>\n          <AlertDialog>\n            <AlertDialogTrigger asChild>\n              <Button variant=\"destructive\" data-testid=\"button-delete-campaign\">\n                <Trash2 className=\"h-4 w-4 mr-2\" />\n                Delete\n              </Button>\n            </AlertDialogTrigger>\n            <AlertDialogContent>\n              <AlertDialogHeader>\n                <AlertDialogTitle>Are you sure?</AlertDialogTitle>\n                <AlertDialogDescription>\n                  This will permanently delete the campaign \"{campaign.name}\" and all associated data.\n                  This action cannot be undone.\n                </AlertDialogDescription>\n              </AlertDialogHeader>\n              <AlertDialogFooter>\n                <AlertDialogCancel data-testid=\"button-cancel-delete\">Cancel</AlertDialogCancel>\n                <AlertDialogAction\n                  onClick={() => deleteMutation.mutate()}\n                  disabled={deleteMutation.isPending}\n                  data-testid=\"button-confirm-delete\"\n                  className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                >\n                  {deleteMutation.isPending ? 'Deleting...' : 'Delete Campaign'}\n                </AlertDialogAction>\n              </AlertDialogFooter>\n            </AlertDialogContent>\n          </AlertDialog>\n        </div>\n      </div>\n\n      <div className=\"grid gap-6 grid-cols-1 md:grid-cols-3\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Leads</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-leads\">\n              {campaign.totalLeads}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Completed</CardTitle>\n            <CheckCircle2 className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completed-leads\">\n              {campaign.completedLeads}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Completion Rate</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completion-rate\">\n              {completionRate}%\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Campaign Information</CardTitle>\n          <CardDescription>\n            Details and status of this campaign\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid gap-4 grid-cols-1 md:grid-cols-2\">\n            <div>\n              <p className=\"text-sm font-medium text-muted-foreground\">Status</p>\n              <Badge className={`mt-1 ${getStatusColor(campaign.status)}`} data-testid=\"badge-campaign-status\">\n                {campaign.status}\n              </Badge>\n            </div>\n            {campaign.description && (\n              <div className=\"md:col-span-2\">\n                <p className=\"text-sm font-medium text-muted-foreground\">Description</p>\n                <p className=\"mt-1\" data-testid=\"text-campaign-description\">{campaign.description}</p>\n              </div>\n            )}\n            {campaign.startDate && (\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Start Date</p>\n                <p className=\"mt-1\" data-testid=\"text-campaign-start-date\">\n                  {format(new Date(campaign.startDate), 'PPP')}\n                </p>\n              </div>\n            )}\n            {campaign.endDate && (\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">End Date</p>\n                <p className=\"mt-1\" data-testid=\"text-campaign-end-date\">\n                  {format(new Date(campaign.endDate), 'PPP')}\n                </p>\n              </div>\n            )}\n            <div>\n              <p className=\"text-sm font-medium text-muted-foreground\">Created</p>\n              <p className=\"mt-1\" data-testid=\"text-campaign-created\">\n                {campaign.createdAt ? format(new Date(campaign.createdAt), 'PPP') : 'N/A'}\n              </p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader className=\"flex flex-row items-center justify-between\">\n          <div>\n            <CardTitle>Leads</CardTitle>\n            <CardDescription>\n              {leads.length} leads in this campaign\n            </CardDescription>\n          </div>\n          <Button\n            onClick={() => navigate(`/campaigns/${campaign.id}/upload-leads`)}\n            data-testid=\"button-upload-leads\"\n          >\n            <Upload className=\"h-4 w-4 mr-2\" />\n            Upload Leads\n          </Button>\n        </CardHeader>\n        <CardContent>\n          {leads.length > 0 ? (\n            <div className=\"space-y-2\">\n              {leads.slice(0, 10).map((lead) => (\n                <div\n                  key={lead.id}\n                  className=\"flex items-center justify-between p-3 rounded-md border hover-elevate\"\n                  data-testid={`lead-${lead.id}`}\n                >\n                  <div>\n                    <p className=\"font-medium\">{lead.name}</p>\n                    <p className=\"text-sm text-muted-foreground\">\n                      {lead.email || lead.phone || 'No contact info'}\n                    </p>\n                  </div>\n                  <Badge\n                    variant={lead.status === 'contacted' ? 'default' : 'secondary'}\n                    data-testid={`badge-lead-status-${lead.id}`}\n                  >\n                    {lead.status}\n                  </Badge>\n                </div>\n              ))}\n              {leads.length > 10 && (\n                <p className=\"text-sm text-muted-foreground text-center pt-2\">\n                  And {leads.length - 10} more leads...\n                </p>\n              )}\n            </div>\n          ) : (\n            <div className=\"text-center py-8\">\n              <p className=\"text-muted-foreground mb-4\">No leads in this campaign yet</p>\n              <Button\n                onClick={() => navigate(`/campaigns/${campaign.id}/upload-leads`)}\n                data-testid=\"button-upload-leads-empty\"\n              >\n                <Upload className=\"h-4 w-4 mr-2\" />\n                Upload Leads\n              </Button>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":10941},"client/src/pages/ChannelPartners.tsx":{"content":"import { useRef, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { useVirtualizer } from \"@tanstack/react-virtual\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Search, Upload, Mail, Phone, Building2, Loader2 } from \"lucide-react\";\nimport type { ChannelPartner } from \"@shared/schema\";\nimport { format } from \"date-fns\";\n\nexport default function ChannelPartners() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [categoryFilter, setCategoryFilter] = useState<string>('all');\n  const parentRef = useRef<HTMLDivElement>(null);\n\n  const { data: partners = [], isLoading } = useQuery<ChannelPartner[]>({\n    queryKey: ['/api/channel-partners'],\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: ({ partnerId, status }: { partnerId: string; status: string }) =>\n      apiRequest(`/api/channel-partners/${partnerId}`, {\n        method: 'PATCH',\n        body: JSON.stringify({ status }),\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/channel-partners'] });\n      toast({\n        title: \"Success\",\n        description: \"Partner status updated\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update partner status\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredPartners = partners.filter(partner => {\n    const matchesSearch = \n      partner.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (partner.email?.toLowerCase().includes(searchQuery.toLowerCase())) ||\n      (partner.phone?.includes(searchQuery)) ||\n      (partner.company?.toLowerCase().includes(searchQuery.toLowerCase())) ||\n      (partner.category?.toLowerCase().includes(searchQuery.toLowerCase()));\n    \n    const matchesStatus = statusFilter === 'all' || partner.status === statusFilter;\n    const matchesCategory = categoryFilter === 'all' || partner.category === categoryFilter;\n\n    return matchesSearch && matchesStatus && matchesCategory;\n  });\n\n  const categories = Array.from(new Set(partners.map(p => p.category).filter(Boolean)));\n\n  const virtualizer = useVirtualizer({\n    count: filteredPartners.length,\n    getScrollElement: () => parentRef.current,\n    estimateSize: () => 100,\n    overscan: 5,\n  });\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active': return 'bg-primary/10 text-primary border-primary/20';\n      case 'inactive': return 'bg-muted text-muted-foreground border-border';\n      default: return 'bg-muted text-muted-foreground border-border';\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[400px]\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col h-full p-6 md:p-8\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-channel-partners\">\n            Channel Partners\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Manage your channel partner network ({filteredPartners.length.toLocaleString()} partners)\n          </p>\n        </div>\n        <Button onClick={() => navigate('/partners/upload')} data-testid=\"button-upload-partners\">\n          <Upload className=\"h-4 w-4 mr-2\" />\n          Upload Partners\n        </Button>\n      </div>\n\n      <Card className=\"mb-6\">\n        <CardHeader>\n          <CardTitle>Filters</CardTitle>\n          <CardDescription>Search and filter channel partners</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid gap-4 grid-cols-1 md:grid-cols-3\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search partners...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-9\"\n                data-testid=\"input-search-partners\"\n              />\n            </div>\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger data-testid=\"select-status-filter\">\n                <SelectValue placeholder=\"All Statuses\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Statuses</SelectItem>\n                <SelectItem value=\"active\">Active</SelectItem>\n                <SelectItem value=\"inactive\">Inactive</SelectItem>\n              </SelectContent>\n            </Select>\n            <Select value={categoryFilter} onValueChange={setCategoryFilter}>\n              <SelectTrigger data-testid=\"select-category-filter\">\n                <SelectValue placeholder=\"All Categories\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Categories</SelectItem>\n                {categories.map((category) => (\n                  <SelectItem key={category} value={category || ''}>\n                    {category}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n        </CardContent>\n      </Card>\n\n      <div\n        ref={parentRef}\n        className=\"flex-1 overflow-auto border rounded-md\"\n        data-testid=\"partners-virtual-list\"\n      >\n        <div\n          style={{\n            height: `${virtualizer.getTotalSize()}px`,\n            width: '100%',\n            position: 'relative',\n          }}\n        >\n          {virtualizer.getVirtualItems().map((virtualRow) => {\n            const partner = filteredPartners[virtualRow.index];\n            return (\n              <div\n                key={partner.id}\n                data-index={virtualRow.index}\n                ref={virtualizer.measureElement}\n                style={{\n                  position: 'absolute',\n                  top: 0,\n                  left: 0,\n                  width: '100%',\n                  transform: `translateY(${virtualRow.start}px)`,\n                }}\n              >\n                <div\n                  className=\"p-4 border-b hover-elevate bg-background\"\n                  data-testid={`partner-card-${partner.id}`}\n                >\n                  <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div className=\"space-y-2 flex-1\">\n                      <div className=\"flex items-center gap-3\">\n                        <h3 className=\"text-lg font-semibold\" data-testid={`partner-name-${partner.id}`}>\n                          {partner.name}\n                        </h3>\n                        <Badge\n                          className={getStatusColor(partner.status)}\n                          data-testid={`partner-status-badge-${partner.id}`}\n                        >\n                          {partner.status}\n                        </Badge>\n                        {partner.category && (\n                          <Badge variant=\"outline\" data-testid={`partner-category-${partner.id}`}>\n                            {partner.category}\n                          </Badge>\n                        )}\n                      </div>\n                      \n                      <div className=\"flex flex-wrap gap-4 text-sm text-muted-foreground\">\n                        {partner.email && (\n                          <div className=\"flex items-center gap-1\" data-testid={`partner-email-${partner.id}`}>\n                            <Mail className=\"h-4 w-4\" />\n                            <span>{partner.email}</span>\n                          </div>\n                        )}\n                        {partner.phone && (\n                          <div className=\"flex items-center gap-1\" data-testid={`partner-phone-${partner.id}`}>\n                            <Phone className=\"h-4 w-4\" />\n                            <span>{partner.phone}</span>\n                          </div>\n                        )}\n                        {partner.company && (\n                          <div className=\"flex items-center gap-1\" data-testid={`partner-company-${partner.id}`}>\n                            <Building2 className=\"h-4 w-4\" />\n                            <span>{partner.company}</span>\n                          </div>\n                        )}\n                      </div>\n\n                      <div className=\"flex flex-wrap gap-4 text-sm text-muted-foreground\">\n                        {partner.lastInteractionAt && (\n                          <div data-testid={`partner-last-interaction-${partner.id}`}>\n                            Last interaction: {format(new Date(partner.lastInteractionAt), 'PPP')}\n                          </div>\n                        )}\n                        {partner.interactionCount > 0 && (\n                          <div data-testid={`partner-interaction-count-${partner.id}`}>\n                            Interactions: {partner.interactionCount}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-2 min-w-[150px]\">\n                      <Select\n                        value={partner.status}\n                        onValueChange={(status) => updateStatusMutation.mutate({ partnerId: partner.id, status })}\n                      >\n                        <SelectTrigger data-testid={`select-status-${partner.id}`}>\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"active\">Active</SelectItem>\n                          <SelectItem value=\"inactive\">Inactive</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {filteredPartners.length === 0 && (\n        <div className=\"flex items-center justify-center py-12\">\n          <p className=\"text-muted-foreground\">\n            {searchQuery || statusFilter !== 'all' || categoryFilter !== 'all'\n              ? 'No partners match your filters'\n              : 'No channel partners yet'}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":11066},"client/src/pages/Leads.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Search, Filter, Phone, Mail, Building2, User, Calendar, Loader2 } from \"lucide-react\";\nimport type { Lead, User as UserType } from \"@shared/schema\";\nimport { format } from \"date-fns\";\n\nexport default function Leads() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n\n  const { data: leads = [], isLoading } = useQuery<Lead[]>({\n    queryKey: ['/api/leads'],\n  });\n\n\n  const updateStatusMutation = useMutation({\n    mutationFn: async ({ leadId, status }: { leadId: string; status: string }) => {\n      const res = await apiRequest('PATCH', `/api/leads/${leadId}`, { status });\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/leads'] });\n      toast({\n        title: \"Success\",\n        description: \"Lead status updated\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update lead status\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredLeads = leads.filter(lead => {\n    const matchesSearch = \n      lead.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (lead.email?.toLowerCase().includes(searchQuery.toLowerCase())) ||\n      (lead.phone?.includes(searchQuery)) ||\n      (lead.company?.toLowerCase().includes(searchQuery.toLowerCase()));\n    \n    const matchesStatus = statusFilter === 'all' || lead.status === statusFilter;\n\n    return matchesSearch && matchesStatus;\n  });\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'contacted': return 'bg-primary/10 text-primary border-primary/20';\n      case 'qualified': return 'bg-primary/10 text-primary border-primary/20';\n      case 'converted': return 'bg-primary/10 text-primary border-primary/20';\n      case 'lost': return 'bg-muted text-muted-foreground border-border';\n      default: return 'bg-muted text-muted-foreground border-border';\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[400px]\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-leads\">\n            Leads\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Manage and track all your leads\n          </p>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Filters</CardTitle>\n          <CardDescription>Filter leads by status or search</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid gap-4 grid-cols-1 md:grid-cols-2\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search leads...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-9\"\n                data-testid=\"input-search-leads\"\n              />\n            </div>\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger data-testid=\"select-status-filter\">\n                <SelectValue placeholder=\"All Statuses\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Statuses</SelectItem>\n                <SelectItem value=\"new\">New</SelectItem>\n                <SelectItem value=\"contacted\">Contacted</SelectItem>\n                <SelectItem value=\"qualified\">Qualified</SelectItem>\n                <SelectItem value=\"converted\">Converted</SelectItem>\n                <SelectItem value=\"lost\">Lost</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </CardContent>\n      </Card>\n\n      <div className=\"space-y-3\">\n        {filteredLeads.length > 0 ? (\n          filteredLeads.map((lead) => {\n            return (\n              <Card key={lead.id} className=\"hover-elevate\" data-testid={`lead-card-${lead.id}`}>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div className=\"space-y-2 flex-1\">\n                      <div className=\"flex items-center gap-3\">\n                        <h3 className=\"text-lg font-semibold\" data-testid={`lead-name-${lead.id}`}>\n                          {lead.name}\n                        </h3>\n                        <Badge className={getStatusColor(lead.status)} data-testid={`lead-status-badge-${lead.id}`}>\n                          {lead.status}\n                        </Badge>\n                      </div>\n                      \n                      <div className=\"flex flex-wrap gap-4 text-sm text-muted-foreground\">\n                        {lead.email && (\n                          <div className=\"flex items-center gap-1\" data-testid={`lead-email-${lead.id}`}>\n                            <Mail className=\"h-4 w-4\" />\n                            <span>{lead.email}</span>\n                          </div>\n                        )}\n                        {lead.phone && (\n                          <div className=\"flex items-center gap-1\" data-testid={`lead-phone-${lead.id}`}>\n                            <Phone className=\"h-4 w-4\" />\n                            <span>{lead.phone}</span>\n                          </div>\n                        )}\n                        {lead.company && (\n                          <div className=\"flex items-center gap-1\" data-testid={`lead-company-${lead.id}`}>\n                            <Building2 className=\"h-4 w-4\" />\n                            <span>{lead.company}</span>\n                          </div>\n                        )}\n                      </div>\n\n                      {lead.lastContactedAt && (\n                        <div className=\"flex items-center gap-1 text-sm text-muted-foreground\" data-testid={`lead-last-contacted-${lead.id}`}>\n                          <Calendar className=\"h-4 w-4\" />\n                          <span>Last contacted: {format(new Date(lead.lastContactedAt), 'PPP')}</span>\n                        </div>\n                      )}\n                    </div>\n\n                    <div className=\"min-w-[200px]\">\n                      <Select\n                        value={lead.status}\n                        onValueChange={(status) => updateStatusMutation.mutate({ leadId: lead.id, status })}\n                      >\n                        <SelectTrigger data-testid={`select-status-${lead.id}`}>\n                          <SelectValue placeholder=\"Update status\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"new\">New</SelectItem>\n                          <SelectItem value=\"contacted\">Contacted</SelectItem>\n                          <SelectItem value=\"qualified\">Qualified</SelectItem>\n                          <SelectItem value=\"converted\">Converted</SelectItem>\n                          <SelectItem value=\"lost\">Lost</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })\n        ) : (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground\">\n                {searchQuery || statusFilter !== 'all'\n                  ? 'No leads match your filters'\n                  : 'No leads yet'}\n              </p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":8598},"client/src/pages/CampaignForm.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, Loader2 } from \"lucide-react\";\nimport type { Campaign } from \"@shared/schema\";\n\nconst campaignFormSchema = z.object({\n  name: z.string().min(1, \"Campaign name is required\"),\n  description: z.string().optional(),\n  status: z.enum(['draft', 'active', 'paused', 'completed']),\n  startDate: z.string().optional(),\n  endDate: z.string().optional(),\n});\n\ntype CampaignFormData = z.infer<typeof campaignFormSchema>;\n\nexport default function CampaignForm() {\n  const [isNew] = useRoute(\"/campaigns/new\");\n  const [, editParams] = useRoute(\"/campaigns/:id/edit\");\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  \n  const campaignId = editParams?.id;\n  const isEditing = !isNew && !!campaignId;\n\n  const { data: campaign, isLoading } = useQuery<Campaign>({\n    queryKey: ['/api/campaigns', campaignId],\n    enabled: isEditing,\n  });\n\n  const form = useForm<CampaignFormData>({\n    resolver: zodResolver(campaignFormSchema),\n    defaultValues: {\n      name: '',\n      description: '',\n      status: 'draft',\n      startDate: '',\n      endDate: '',\n    },\n  });\n\n  useEffect(() => {\n    if (campaign) {\n      form.reset({\n        name: campaign.name,\n        description: campaign.description || '',\n        status: campaign.status as any,\n        startDate: campaign.startDate ? new Date(campaign.startDate).toISOString().split('T')[0] : '',\n        endDate: campaign.endDate ? new Date(campaign.endDate).toISOString().split('T')[0] : '',\n      });\n    }\n  }, [campaign, form]);\n\n  const createMutation = useMutation({\n    mutationFn: (data: CampaignFormData) => apiRequest('/api/campaigns', {\n      method: 'POST',\n      body: JSON.stringify({\n        ...data,\n        startDate: data.startDate ? new Date(data.startDate).toISOString() : null,\n        endDate: data.endDate ? new Date(data.endDate).toISOString() : null,\n      }),\n    }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/campaigns'] });\n      toast({\n        title: \"Success\",\n        description: \"Campaign created successfully\",\n      });\n      navigate('/campaigns');\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to create campaign\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: (data: CampaignFormData) => apiRequest(`/api/campaigns/${campaignId}`, {\n      method: 'PATCH',\n      body: JSON.stringify({\n        ...data,\n        startDate: data.startDate ? new Date(data.startDate).toISOString() : null,\n        endDate: data.endDate ? new Date(data.endDate).toISOString() : null,\n      }),\n    }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/campaigns'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/campaigns', campaignId] });\n      toast({\n        title: \"Success\",\n        description: \"Campaign updated successfully\",\n      });\n      navigate(`/campaigns/${campaignId}`);\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update campaign\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CampaignFormData) => {\n    if (isEditing) {\n      updateMutation.mutate(data);\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  if (isLoading && isEditing) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[400px]\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8 max-w-3xl mx-auto\">\n      <div className=\"flex items-center gap-4\">\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={() => navigate('/campaigns')}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n        </Button>\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-campaign-form\">\n            {isEditing ? 'Edit Campaign' : 'Create Campaign'}\n          </h1>\n          <p className=\"text-muted-foreground\">\n            {isEditing ? 'Update campaign details' : 'Set up a new automation campaign'}\n          </p>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Campaign Details</CardTitle>\n          <CardDescription>\n            Configure your campaign settings and timeline\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <FormField\n                control={form.control}\n                name=\"name\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Campaign Name</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"Q4 Sales Campaign\"\n                        data-testid=\"input-campaign-name\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"description\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Description</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"Describe the campaign objectives and target audience\"\n                        rows={4}\n                        data-testid=\"textarea-campaign-description\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-campaign-status\">\n                          <SelectValue placeholder=\"Select campaign status\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"draft\">Draft</SelectItem>\n                        <SelectItem value=\"active\">Active</SelectItem>\n                        <SelectItem value=\"paused\">Paused</SelectItem>\n                        <SelectItem value=\"completed\">Completed</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"startDate\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Start Date</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"date\"\n                          data-testid=\"input-campaign-start-date\"\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"endDate\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>End Date</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"date\"\n                          data-testid=\"input-campaign-end-date\"\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div className=\"flex justify-end gap-3\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => navigate('/campaigns')}\n                  data-testid=\"button-cancel\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"submit\"\n                  disabled={createMutation.isPending || updateMutation.isPending}\n                  data-testid=\"button-submit-campaign\"\n                >\n                  {createMutation.isPending || updateMutation.isPending ? (\n                    <>\n                      <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                      {isEditing ? 'Updating...' : 'Creating...'}\n                    </>\n                  ) : (\n                    <>{isEditing ? 'Update Campaign' : 'Create Campaign'}</>\n                  )}\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":10133},"client/src/pages/LeadUpload.tsx":{"content":"import { useState } from \"react\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, Upload, FileText, Loader2, CheckCircle2 } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\nconst uploadFormSchema = z.object({\n  file: z.instanceof(File).refine(\n    (file) => {\n      const ext = file.name.split('.').pop()?.toLowerCase();\n      return ext === 'csv' || ext === 'xlsx' || ext === 'xls';\n    },\n    { message: \"Please select a CSV or Excel file\" }\n  ),\n});\n\ntype UploadFormData = z.infer<typeof uploadFormSchema>;\n\nexport default function LeadUpload() {\n  const [, params] = useRoute(\"/campaigns/:id/upload-leads\");\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [uploadResult, setUploadResult] = useState<{ count: number } | null>(null);\n\n  const form = useForm<UploadFormData>({\n    resolver: zodResolver(uploadFormSchema),\n  });\n\n  const uploadMutation = useMutation({\n    mutationFn: async (file: File) => {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('campaignId', params?.id || '');\n\n      const response = await fetch('/api/leads/upload', {\n        method: 'POST',\n        body: formData,\n        credentials: 'include',\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Upload failed');\n      }\n\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/leads'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/campaigns', params?.id] });\n      setUploadResult({ count: data.count });\n      form.reset();\n      toast({\n        title: \"Success\",\n        description: `${data.count} leads uploaded successfully`,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Upload failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: UploadFormData) => {\n    uploadMutation.mutate(data.file);\n  };\n\n  const downloadSampleCsv = () => {\n    const csvContent = 'name,email,phone,company\\nJohn Doe,john@example.com,+1234567890,Acme Corp\\nJane Smith,jane@example.com,+0987654321,Tech Inc';\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = 'sample_leads.csv';\n    link.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8 max-w-3xl mx-auto\">\n      <div className=\"flex items-center gap-4\">\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={() => navigate(`/campaigns/${params?.id}`)}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n        </Button>\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-upload-leads\">\n            Upload Leads\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Import leads from CSV or Excel file\n          </p>\n        </div>\n      </div>\n\n      {uploadResult && (\n        <Alert className=\"border-primary/20 bg-primary/5\">\n          <CheckCircle2 className=\"h-4 w-4 text-primary\" />\n          <AlertDescription>\n            Successfully uploaded {uploadResult.count} leads to the campaign\n          </AlertDescription>\n        </Alert>\n      )}\n\n      <Card>\n        <CardHeader>\n          <CardTitle>File Upload</CardTitle>\n          <CardDescription>\n            Upload a CSV or Excel file with lead information. Required columns: name. Optional: email, phone, company.\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <FormField\n                control={form.control}\n                name=\"file\"\n                render={({ field: { value, onChange, ...field } }) => (\n                  <FormItem>\n                    <FormLabel>Select File</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"file\"\n                        accept=\".csv,.xlsx,.xls\"\n                        onChange={(e) => {\n                          const file = e.target.files?.[0];\n                          if (file) {\n                            onChange(file);\n                            setUploadResult(null);\n                          }\n                        }}\n                        data-testid=\"input-file-upload\"\n                        {...field}\n                      />\n                    </FormControl>\n                    {value && (\n                      <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                        <FileText className=\"h-4 w-4\" />\n                        <span data-testid=\"text-selected-file\">{value.name}</span>\n                        <span className=\"text-xs\">({(value.size / 1024).toFixed(1)} KB)</span>\n                      </div>\n                    )}\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <Button\n                type=\"submit\"\n                disabled={uploadMutation.isPending}\n                data-testid=\"button-upload\"\n                className=\"w-full\"\n              >\n                {uploadMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                    Uploading...\n                  </>\n                ) : (\n                  <>\n                    <Upload className=\"h-4 w-4 mr-2\" />\n                    Upload Leads\n                  </>\n                )}\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"pt-4 border-t\">\n            <h3 className=\"text-sm font-medium mb-2\">CSV Format</h3>\n            <p className=\"text-sm text-muted-foreground mb-3\">\n              Your CSV file should have the following columns:\n            </p>\n            <ul className=\"text-sm text-muted-foreground space-y-1 list-disc list-inside mb-4\">\n              <li><strong>name</strong> (required) - Lead's full name</li>\n              <li><strong>email</strong> (optional) - Email address</li>\n              <li><strong>phone</strong> (optional) - Phone number</li>\n              <li><strong>company</strong> (optional) - Company name</li>\n            </ul>\n            <Button\n              variant=\"outline\"\n              onClick={downloadSampleCsv}\n              data-testid=\"button-download-sample\"\n            >\n              <FileText className=\"h-4 w-4 mr-2\" />\n              Download Sample CSV\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {uploadResult && (\n        <div className=\"flex justify-end gap-3\">\n          <Button\n            variant=\"outline\"\n            onClick={() => navigate(`/campaigns/${params?.id}/upload-leads`)}\n            data-testid=\"button-upload-more\"\n          >\n            Upload More Leads\n          </Button>\n          <Button\n            onClick={() => navigate(`/campaigns/${params?.id}`)}\n            data-testid=\"button-view-campaign\"\n          >\n            View Campaign\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":7978},"client/src/pages/ChannelPartnerUpload.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, Upload, FileText, Loader2, CheckCircle2 } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\nconst uploadFormSchema = z.object({\n  file: z.instanceof(File).refine(\n    (file) => {\n      const ext = file.name.split('.').pop()?.toLowerCase();\n      return ext === 'csv' || ext === 'xlsx' || ext === 'xls';\n    },\n    { message: \"Please select a CSV or Excel file\" }\n  ),\n});\n\ntype UploadFormData = z.infer<typeof uploadFormSchema>;\n\nexport default function ChannelPartnerUpload() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [uploadResult, setUploadResult] = useState<{ count: number } | null>(null);\n\n  const form = useForm<UploadFormData>({\n    resolver: zodResolver(uploadFormSchema),\n  });\n\n  const uploadMutation = useMutation({\n    mutationFn: async (file: File) => {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      const response = await fetch('/api/channel-partners/upload', {\n        method: 'POST',\n        body: formData,\n        credentials: 'include',\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Upload failed');\n      }\n\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/channel-partners'] });\n      setUploadResult({ count: data.count });\n      form.reset();\n      toast({\n        title: \"Success\",\n        description: `${data.count} partners uploaded successfully`,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Upload failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: UploadFormData) => {\n    uploadMutation.mutate(data.file);\n  };\n\n  const downloadSampleCsv = () => {\n    const csvContent = 'name,email,phone,company,category,status\\nPartner One,partner1@example.com,+1234567890,Company A,Distributor,active\\nPartner Two,partner2@example.com,+0987654321,Company B,Retailer,inactive';\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = 'sample_partners.csv';\n    link.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8 max-w-3xl mx-auto\">\n      <div className=\"flex items-center gap-4\">\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={() => navigate('/partners')}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n        </Button>\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-upload-partners\">\n            Upload Channel Partners\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Import partners from CSV or Excel file\n          </p>\n        </div>\n      </div>\n\n      {uploadResult && (\n        <Alert className=\"border-primary/20 bg-primary/5\">\n          <CheckCircle2 className=\"h-4 w-4 text-primary\" />\n          <AlertDescription>\n            Successfully uploaded {uploadResult.count} channel partners\n          </AlertDescription>\n        </Alert>\n      )}\n\n      <Card>\n        <CardHeader>\n          <CardTitle>File Upload</CardTitle>\n          <CardDescription>\n            Upload a CSV or Excel file with partner information. Required columns: name. Optional: email, phone, company, category, status.\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <FormField\n                control={form.control}\n                name=\"file\"\n                render={({ field: { value, onChange, ...field } }) => (\n                  <FormItem>\n                    <FormLabel>Select File</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"file\"\n                        accept=\".csv,.xlsx,.xls\"\n                        onChange={(e) => {\n                          const file = e.target.files?.[0];\n                          if (file) {\n                            onChange(file);\n                            setUploadResult(null);\n                          }\n                        }}\n                        data-testid=\"input-file-upload\"\n                        {...field}\n                      />\n                    </FormControl>\n                    {value && (\n                      <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                        <FileText className=\"h-4 w-4\" />\n                        <span data-testid=\"text-selected-file\">{value.name}</span>\n                        <span className=\"text-xs\">({(value.size / 1024).toFixed(1)} KB)</span>\n                      </div>\n                    )}\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <Button\n                type=\"submit\"\n                disabled={uploadMutation.isPending}\n                data-testid=\"button-upload\"\n                className=\"w-full\"\n              >\n                {uploadMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                    Uploading...\n                  </>\n                ) : (\n                  <>\n                    <Upload className=\"h-4 w-4 mr-2\" />\n                    Upload Partners\n                  </>\n                )}\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"pt-4 border-t\">\n            <h3 className=\"text-sm font-medium mb-2\">CSV Format</h3>\n            <p className=\"text-sm text-muted-foreground mb-3\">\n              Your CSV file should have the following columns:\n            </p>\n            <ul className=\"text-sm text-muted-foreground space-y-1 list-disc list-inside mb-4\">\n              <li><strong>name</strong> (required) - Partner's name</li>\n              <li><strong>email</strong> (optional) - Email address</li>\n              <li><strong>phone</strong> (optional) - Phone number</li>\n              <li><strong>company</strong> (optional) - Company name</li>\n              <li><strong>category</strong> (optional) - Partner category (e.g., Distributor, Retailer)</li>\n              <li><strong>status</strong> (optional) - Status (active or inactive, defaults to inactive)</li>\n            </ul>\n            <Button\n              variant=\"outline\"\n              onClick={downloadSampleCsv}\n              data-testid=\"button-download-sample\"\n            >\n              <FileText className=\"h-4 w-4 mr-2\" />\n              Download Sample CSV\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {uploadResult && (\n        <div className=\"flex justify-end gap-3\">\n          <Button\n            variant=\"outline\"\n            onClick={() => navigate('/partners/upload')}\n            data-testid=\"button-upload-more\"\n          >\n            Upload More Partners\n          </Button>\n          <Button\n            onClick={() => navigate('/partners')}\n            data-testid=\"button-view-partners\"\n          >\n            View Partners\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8077},"client/src/pages/Settings.tsx":{"content":"export default function Settings() {\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-3xl font-bold\">Settings</h1>\n      <p className=\"text-muted-foreground mt-2\">Platform settings - Coming Soon</p>\n    </div>\n  );\n}\n","size_bytes":231},"client/src/pages/Billing.tsx":{"content":"import { useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend } from 'recharts';\nimport { DollarSign, TrendingUp, TrendingDown, Clock, Phone } from \"lucide-react\";\nimport type { BillingMetrics } from \"@shared/schema\";\n\nexport default function Billing() {\n  const { toast } = useToast();\n  const { isAuthenticated, isLoading: authLoading } = useAuth();\n\n  useEffect(() => {\n    if (!authLoading && !isAuthenticated) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"You are logged out. Logging in again...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n    }\n  }, [isAuthenticated, authLoading, toast]);\n\n  const { data: metrics, isLoading } = useQuery<BillingMetrics>({\n    queryKey: [\"/api/billing/metrics\"],\n  });\n\n  if (authLoading || !isAuthenticated) {\n    return null;\n  }\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 4,\n    }).format(amount);\n  };\n\n  const formatMinutes = (minutes: number | undefined | null) => {\n    return Number(minutes ?? 0).toFixed(2);\n  };\n\n  const calculateChange = () => {\n    if (!metrics) return 0;\n    const { currentMonth, previousMonth } = metrics;\n    if (previousMonth.totalCost === 0) return 0;\n    return ((currentMonth.totalCost - previousMonth.totalCost) / previousMonth.totalCost) * 100;\n  };\n\n  const change = calculateChange();\n\n  const stats = [\n    {\n      title: \"Total Cost\",\n      value: formatCurrency(metrics?.currentMonth.totalCost ?? 0),\n      icon: DollarSign,\n      description: \"Current month total\",\n      testId: \"stat-total-cost\",\n    },\n    {\n      title: \"Total Minutes\",\n      value: formatMinutes(metrics?.currentMonth.totalMinutes ?? 0),\n      icon: Clock,\n      description: \"Call duration this month\",\n      testId: \"stat-total-minutes\",\n    },\n    {\n      title: \"Total Calls\",\n      value: metrics?.currentMonth.totalCalls ?? 0,\n      icon: Phone,\n      description: \"Calls this month\",\n      testId: \"stat-total-calls\",\n    },\n    {\n      title: \"vs Last Month\",\n      value: `${change > 0 ? '+' : ''}${change.toFixed(1)}%`,\n      icon: change >= 0 ? TrendingUp : TrendingDown,\n      description: \"Cost comparison\",\n      testId: \"stat-change\",\n      highlight: true,\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"space-y-1\">\n        <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-billing\">\n          Billing & Usage\n        </h1>\n        <p className=\"text-muted-foreground\">\n          Track your usage costs and billing breakdown\n        </p>\n      </div>\n\n      {isLoading ? (\n        <div className=\"space-y-6\">\n          <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n            {[1, 2, 3, 4].map((i) => (\n              <Card key={i}>\n                <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                  <div className=\"h-5 w-24 bg-muted animate-pulse rounded\" />\n                  <div className=\"h-4 w-4 bg-muted animate-pulse rounded\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-8 w-16 bg-muted animate-pulse rounded mb-2\" />\n                  <div className=\"h-4 w-32 bg-muted animate-pulse rounded\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      ) : (\n        <>\n          <div className=\"grid gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n            {stats.map((stat) => (\n              <Card key={stat.title} className=\"hover-elevate\">\n                <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">\n                    {stat.title}\n                  </CardTitle>\n                  <stat.icon className={`h-4 w-4 ${stat.highlight && change > 0 ? 'text-destructive' : 'text-muted-foreground'}`} />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\" data-testid={stat.testId}>\n                    {stat.value}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {stat.description}\n                  </p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Cost Breakdown</CardTitle>\n                <CardDescription>\n                  Current month usage costs by provider\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-1\">\n                    <p className=\"text-sm font-medium\">Exotel (Telephony)</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Voice call infrastructure\n                    </p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-sm font-bold\" data-testid=\"cost-exotel\">\n                      {formatCurrency(metrics?.currentMonth.exotelCost ?? 0)}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-1\">\n                    <p className=\"text-sm font-medium\">Bolna (AI Voice)</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      AI agent processing\n                    </p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-sm font-bold\" data-testid=\"cost-bolna\">\n                      {formatCurrency(metrics?.currentMonth.bolnaCost ?? 0)}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between pt-3 border-t\">\n                  <div className=\"space-y-1\">\n                    <p className=\"text-sm font-medium\">Platform Markup</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      $0.023 per minute\n                    </p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-sm font-bold\" data-testid=\"cost-markup\">\n                      {formatCurrency(metrics?.currentMonth.markupCost ?? 0)}\n                    </p>\n                    <Badge variant=\"outline\" className=\"text-xs mt-1\">\n                      Platform Fee\n                    </Badge>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between pt-3 border-t\">\n                  <p className=\"text-base font-bold\">Total</p>\n                  <p className=\"text-base font-bold\" data-testid=\"cost-total\">\n                    {formatCurrency(metrics?.currentMonth.totalCost ?? 0)}\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Monthly Comparison</CardTitle>\n                <CardDescription>\n                  Current vs previous month\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-sm text-muted-foreground\">Current Month</p>\n                    <p className=\"text-sm font-bold\" data-testid=\"current-month-cost\">\n                      {formatCurrency(metrics?.currentMonth.totalCost ?? 0)}\n                    </p>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-xs text-muted-foreground\">\n                      {formatMinutes(metrics?.currentMonth.totalMinutes ?? 0)} minutes\n                    </p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      {metrics?.currentMonth.totalCalls ?? 0} calls\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2 pt-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-sm text-muted-foreground\">Previous Month</p>\n                    <p className=\"text-sm font-bold\" data-testid=\"previous-month-cost\">\n                      {formatCurrency(metrics?.previousMonth.totalCost ?? 0)}\n                    </p>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-xs text-muted-foreground\">\n                      {formatMinutes(metrics?.previousMonth.totalMinutes ?? 0)} minutes\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"pt-4 border-t\">\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-sm font-medium\">Difference</p>\n                    <div className=\"flex items-center gap-2\">\n                      {change >= 0 ? (\n                        <TrendingUp className=\"h-4 w-4 text-destructive\" />\n                      ) : (\n                        <TrendingDown className=\"h-4 w-4 text-chart-2\" />\n                      )}\n                      <p className={`text-sm font-bold ${change >= 0 ? 'text-destructive' : 'text-chart-2'}`} data-testid=\"cost-diff\">\n                        {change > 0 ? '+' : ''}{change.toFixed(1)}%\n                      </p>\n                    </div>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {formatCurrency(Math.abs((metrics?.currentMonth.totalCost ?? 0) - (metrics?.previousMonth.totalCost ?? 0)))} \n                    {' '}{change >= 0 ? 'increase' : 'decrease'}\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Daily Cost Breakdown</CardTitle>\n              <CardDescription>\n                Cost distribution by provider (current month)\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <BarChart data={(metrics?.costBreakdown ?? []).map(day => ({\n                  date: day.date,\n                  exotelCost: Number(day.exotelCost ?? 0),\n                  bolnaCost: Number(day.bolnaCost ?? 0),\n                  markupCost: Number(day.markupCost ?? 0),\n                  totalCost: Number(day.totalCost ?? 0),\n                  minutes: Number(day.minutes ?? 0),\n                }))}>\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-border\" />\n                  <XAxis\n                    dataKey=\"date\"\n                    className=\"text-xs\"\n                    tickLine={false}\n                  />\n                  <YAxis className=\"text-xs\" tickLine={false} />\n                  <Tooltip\n                    contentStyle={{\n                      backgroundColor: 'hsl(var(--card))',\n                      border: '1px solid hsl(var(--border))',\n                      borderRadius: '8px',\n                    }}\n                    formatter={(value: number) => formatCurrency(value)}\n                  />\n                  <Legend />\n                  <Bar dataKey=\"exotelCost\" fill=\"hsl(var(--primary))\" name=\"Exotel\" stackId=\"a\" />\n                  <Bar dataKey=\"bolnaCost\" fill=\"hsl(var(--chart-2))\" name=\"Bolna\" stackId=\"a\" />\n                  <Bar dataKey=\"markupCost\" fill=\"hsl(var(--chart-3))\" name=\"Platform Fee\" stackId=\"a\" />\n                </BarChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </>\n      )}\n    </div>\n  );\n}\n","size_bytes":12559},"client/src/pages/CallHistory.tsx":{"content":"import { useState, useMemo, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { format } from \"date-fns\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Search, Download, Phone, Clock, PhoneCall, Loader2, Plus } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport type { Call, AiAgent } from \"@shared/schema\";\n\nfunction formatDuration(seconds: number | null): string {\n  if (!seconds) return \"â€”\";\n  const mins = Math.floor(seconds / 60);\n  const secs = seconds % 60;\n  return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n}\n\nfunction getStatusBadgeVariant(status: string): \"default\" | \"secondary\" | \"outline\" {\n  switch (status) {\n    case \"completed\":\n      return \"default\";\n    case \"failed\":\n    case \"cancelled\":\n      return \"secondary\";\n    default:\n      return \"outline\";\n  }\n}\n\n// Form schema for initiating a new call\nconst newCallSchema = z.object({\n  agentId: z.string().min(1, \"Please select an AI agent\"),\n  recipientPhone: z.string().min(10, \"Please enter a valid phone number\"),\n  contactName: z.string().optional(),\n  fromPhone: z.string().optional(),\n  leadId: z.string().optional(),\n});\n\ntype NewCallFormValues = z.infer<typeof newCallSchema>;\n\nexport default function CallHistory() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [selectedCall, setSelectedCall] = useState<Call | null>(null);\n  const [isNewCallDialogOpen, setIsNewCallDialogOpen] = useState(false);\n  const { toast } = useToast();\n\n  // Auto-open dialog from Quick Actions\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    if (params.get('action') === 'new') {\n      setIsNewCallDialogOpen(true);\n      // Clean URL: remove action param while preserving base path\n      params.delete('action');\n      const newUrl = params.toString() ? \n        `${window.location.pathname}?${params.toString()}` : \n        window.location.pathname;\n      window.history.replaceState(null, '', newUrl);\n    }\n  }, []);\n\n  const { data: calls = [], isLoading } = useQuery<Call[]>({\n    queryKey: [\"/api/calls\"],\n  });\n\n  const { data: agents = [] } = useQuery<AiAgent[]>({\n    queryKey: [\"/api/ai-agents\"],\n  });\n\n  const agentMap = useMemo(() => {\n    return new Map(agents.map(agent => [agent.id, agent.name]));\n  }, [agents]);\n\n  const form = useForm<NewCallFormValues>({\n    resolver: zodResolver(newCallSchema),\n    defaultValues: {\n      agentId: \"\",\n      recipientPhone: \"\",\n      contactName: \"\",\n      fromPhone: \"\",\n      leadId: \"\",\n    },\n  });\n\n  const initiateCallMutation = useMutation({\n    mutationFn: async (data: NewCallFormValues) => {\n      const response = await apiRequest(\"/api/calls/initiate\", {\n        method: \"POST\",\n        body: JSON.stringify(data),\n      });\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/calls\"] });\n      toast({\n        title: \"Call initiated\",\n        description: \"Your call has been successfully initiated.\",\n      });\n      setIsNewCallDialogOpen(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Failed to initiate call\",\n        description: error.message || \"Please try again later.\",\n      });\n    },\n  });\n\n  const onSubmit = (data: NewCallFormValues) => {\n    initiateCallMutation.mutate(data);\n  };\n\n  const filteredCalls = calls.filter((call) => {\n    const matchesSearch =\n      !searchQuery ||\n      call.contactName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      call.contactPhone?.toLowerCase().includes(searchQuery.toLowerCase());\n\n    const matchesStatus = statusFilter === \"all\" || call.status === statusFilter;\n\n    return matchesSearch && matchesStatus;\n  });\n\n  return (\n    <div className=\"flex flex-col gap-6 p-6\">\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-3xl font-bold\" data-testid=\"text-page-title\">Call History</h1>\n        <div className=\"flex gap-2\">\n          <Button variant=\"outline\" data-testid=\"button-export\">\n            <Download className=\"w-4 h-4 mr-2\" />\n            Export\n          </Button>\n          <Button onClick={() => setIsNewCallDialogOpen(true)} data-testid=\"button-new-call\">\n            <PhoneCall className=\"w-4 h-4 mr-2\" />\n            New Call\n          </Button>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Filter Calls</CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex gap-4\">\n          <div className=\"flex-1 relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search by name or phone number...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"input-search\"\n            />\n          </div>\n          <Select value={statusFilter} onValueChange={setStatusFilter}>\n            <SelectTrigger className=\"w-48\" data-testid=\"select-status-filter\">\n              <SelectValue placeholder=\"Filter by status\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Statuses</SelectItem>\n              <SelectItem value=\"completed\">Completed</SelectItem>\n              <SelectItem value=\"in_progress\">In Progress</SelectItem>\n              <SelectItem value=\"scheduled\">Scheduled</SelectItem>\n              <SelectItem value=\"failed\">Failed</SelectItem>\n              <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n            </SelectContent>\n          </Select>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardContent className=\"p-0\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-12\" data-testid=\"loading-calls\">\n              <div className=\"text-muted-foreground\">Loading calls...</div>\n            </div>\n          ) : filteredCalls.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12\" data-testid=\"empty-calls\">\n              <Phone className=\"w-12 h-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-medium mb-2\">No calls found</h3>\n              <p className=\"text-muted-foreground text-center max-w-md\">\n                {searchQuery || statusFilter !== \"all\"\n                  ? \"Try adjusting your filters to see more results.\"\n                  : \"Call history will appear here once you start making calls with your AI agents.\"}\n              </p>\n            </div>\n          ) : (\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Date & Time</TableHead>\n                  <TableHead>Contact</TableHead>\n                  <TableHead>Phone</TableHead>\n                  <TableHead>Agent</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead>Duration</TableHead>\n                  <TableHead>Direction</TableHead>\n                  <TableHead>Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredCalls.map((call) => (\n                  <TableRow\n                    key={call.id}\n                    className=\"hover-elevate cursor-pointer\"\n                    onClick={() => setSelectedCall(call)}\n                    data-testid={`row-call-${call.id}`}\n                  >\n                    <TableCell data-testid={`text-date-${call.id}`}>\n                      {call.startedAt\n                        ? format(new Date(call.startedAt), \"MMM d, yyyy h:mm a\")\n                        : call.scheduledAt\n                        ? format(new Date(call.scheduledAt), \"MMM d, yyyy h:mm a\")\n                        : \"â€”\"}\n                    </TableCell>\n                    <TableCell data-testid={`text-contact-${call.id}`}>\n                      {call.contactName || \"â€”\"}\n                    </TableCell>\n                    <TableCell data-testid={`text-phone-${call.id}`}>\n                      {call.contactPhone || \"â€”\"}\n                    </TableCell>\n                    <TableCell data-testid={`text-agent-${call.id}`}>\n                      {call.agentId ? (agentMap.get(call.agentId) || call.agentId) : \"â€”\"}\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant={getStatusBadgeVariant(call.status)} data-testid={`badge-status-${call.id}`}>\n                        {call.status}\n                      </Badge>\n                    </TableCell>\n                    <TableCell data-testid={`text-duration-${call.id}`}>\n                      <div className=\"flex items-center gap-1\">\n                        <Clock className=\"w-3 h-3\" />\n                        {formatDuration(call.duration)}\n                      </div>\n                    </TableCell>\n                    <TableCell data-testid={`text-direction-${call.id}`}>\n                      {call.direction}\n                    </TableCell>\n                    <TableCell>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setSelectedCall(call);\n                        }}\n                        data-testid={`button-view-${call.id}`}\n                      >\n                        View Details\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* New Call Dialog */}\n      <Dialog open={isNewCallDialogOpen} onOpenChange={setIsNewCallDialogOpen}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Initiate New Call</DialogTitle>\n            <DialogDescription>\n              Start a new AI-powered voice call with a contact\n            </DialogDescription>\n          </DialogHeader>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"agentId\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>AI Agent *</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-agent\">\n                          <SelectValue placeholder=\"Select an AI agent\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {agents.map((agent) => (\n                          <SelectItem key={agent.id} value={agent.id}>\n                            {agent.name}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormDescription>Choose the AI agent to handle this call</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"recipientPhone\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Recipient Phone Number *</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"+1234567890\"\n                        {...field}\n                        data-testid=\"input-recipient-phone\"\n                      />\n                    </FormControl>\n                    <FormDescription>Include country code</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"contactName\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Contact Name</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"John Doe\"\n                        {...field}\n                        data-testid=\"input-contact-name\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"fromPhone\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>From Phone Number</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"+1987654321\"\n                        {...field}\n                        data-testid=\"input-from-phone\"\n                      />\n                    </FormControl>\n                    <FormDescription>Your caller ID (optional)</FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <DialogFooter>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setIsNewCallDialogOpen(false)}\n                  data-testid=\"button-cancel\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"submit\"\n                  disabled={initiateCallMutation.isPending}\n                  data-testid=\"button-submit\"\n                >\n                  {initiateCallMutation.isPending && (\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  )}\n                  Initiate Call\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Call Details Dialog */}\n      <Dialog open={!!selectedCall} onOpenChange={() => setSelectedCall(null)}>\n        <DialogContent className=\"max-w-3xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Call Details</DialogTitle>\n          </DialogHeader>\n          {selectedCall && (\n            <div className=\"space-y-6\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Contact Name</h4>\n                  <p data-testid=\"dialog-contact-name\">{selectedCall.contactName || \"â€”\"}</p>\n                </div>\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Phone Number</h4>\n                  <p data-testid=\"dialog-phone\">{selectedCall.contactPhone || \"â€”\"}</p>\n                </div>\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Status</h4>\n                  <Badge variant={getStatusBadgeVariant(selectedCall.status)} data-testid=\"dialog-status\">\n                    {selectedCall.status}\n                  </Badge>\n                </div>\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Duration</h4>\n                  <p data-testid=\"dialog-duration\">{formatDuration(selectedCall.duration)}</p>\n                </div>\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Direction</h4>\n                  <p data-testid=\"dialog-direction\">{selectedCall.direction}</p>\n                </div>\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Call Type</h4>\n                  <p data-testid=\"dialog-call-type\">{selectedCall.callType}</p>\n                </div>\n                {selectedCall.startedAt && (\n                  <div>\n                    <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Started At</h4>\n                    <p data-testid=\"dialog-started-at\">\n                      {format(new Date(selectedCall.startedAt), \"MMM d, yyyy h:mm:ss a\")}\n                    </p>\n                  </div>\n                )}\n                {selectedCall.endedAt && (\n                  <div>\n                    <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Ended At</h4>\n                    <p data-testid=\"dialog-ended-at\">\n                      {format(new Date(selectedCall.endedAt), \"MMM d, yyyy h:mm:ss a\")}\n                    </p>\n                  </div>\n                )}\n              </div>\n\n              {selectedCall.outcome && (\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-2\">Outcome</h4>\n                  <p data-testid=\"dialog-outcome\">{selectedCall.outcome}</p>\n                </div>\n              )}\n\n              {selectedCall.sentiment && (\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-2\">Sentiment</h4>\n                  <p data-testid=\"dialog-sentiment\">{selectedCall.sentiment}</p>\n                </div>\n              )}\n\n              {selectedCall.transcription && (\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-2\">Transcript</h4>\n                  <Card>\n                    <CardContent className=\"p-4\">\n                      <p className=\"whitespace-pre-wrap text-sm\" data-testid=\"dialog-transcript\">\n                        {selectedCall.transcription}\n                      </p>\n                    </CardContent>\n                  </Card>\n                </div>\n              )}\n\n              {selectedCall.aiSummary && (\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-2\">AI Summary</h4>\n                  <Card>\n                    <CardContent className=\"p-4\">\n                      <p className=\"text-sm\" data-testid=\"dialog-ai-summary\">\n                        {selectedCall.aiSummary}\n                      </p>\n                    </CardContent>\n                  </Card>\n                </div>\n              )}\n\n              {selectedCall.notes && (\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-2\">Notes</h4>\n                  <p data-testid=\"dialog-notes\">{selectedCall.notes}</p>\n                </div>\n              )}\n\n              {selectedCall.recordingUrl && (\n                <div>\n                  <h4 className=\"text-sm font-medium text-muted-foreground mb-2\">Recording</h4>\n                  <Button variant=\"outline\" asChild data-testid=\"button-play-recording\">\n                    <a href={selectedCall.recordingUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                      <Phone className=\"w-4 h-4 mr-2\" />\n                      Play Recording\n                    </a>\n                  </Button>\n                </div>\n              )}\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":20144},"client/src/pages/Dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Phone, Bot, Activity, TrendingUp, MessageSquare, DollarSign, Clock, PhoneCall, Plus, BookOpen, BarChart3, CreditCard, Users } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport type { DashboardMetrics } from \"@shared/schema\";\n\nexport default function Dashboard() {\n  const [, setLocation] = useLocation();\n  \n  const { data: metrics, isLoading } = useQuery<DashboardMetrics>({\n    queryKey: ['/api/dashboard/metrics'],\n  });\n\n  const quickActions = [\n    {\n      title: \"Create AI Agent\",\n      description: \"Set up a new AI voice agent\",\n      icon: Bot,\n      action: () => setLocation(\"/agents?action=create\"),\n      variant: \"default\" as const,\n      testId: \"action-create-agent\",\n    },\n    {\n      title: \"Initiate Call\",\n      description: \"Start a new AI-powered call\",\n      icon: PhoneCall,\n      action: () => setLocation(\"/calls?action=new\"),\n      variant: \"default\" as const,\n      testId: \"action-initiate-call\",\n    },\n    {\n      title: \"Add Knowledge\",\n      description: \"Train your AI with new data\",\n      icon: BookOpen,\n      action: () => setLocation(\"/knowledge-base?action=create\"),\n      variant: \"outline\" as const,\n      testId: \"action-add-knowledge\",\n    },\n    {\n      title: \"Manage Leads\",\n      description: \"View and organize leads\",\n      icon: Users,\n      action: () => setLocation(\"/leads\"),\n      variant: \"outline\" as const,\n      testId: \"action-manage-leads\",\n    },\n    {\n      title: \"View Analytics\",\n      description: \"Track performance metrics\",\n      icon: BarChart3,\n      action: () => setLocation(\"/analytics\"),\n      variant: \"outline\" as const,\n      testId: \"action-view-analytics\",\n    },\n    {\n      title: \"Billing & Usage\",\n      description: \"Monitor costs and usage\",\n      icon: CreditCard,\n      action: () => setLocation(\"/billing\"),\n      variant: \"outline\" as const,\n      testId: \"action-billing\",\n    },\n  ];\n\n  const metricCards = [\n    {\n      title: \"Total Calls\",\n      value: metrics?.totalCalls ?? 0,\n      icon: Phone,\n      testId: \"metric-total-calls\",\n    },\n    {\n      title: \"Total AI Agents\",\n      value: metrics?.totalAgents ?? 0,\n      icon: Bot,\n      testId: \"metric-total-agents\",\n    },\n    {\n      title: \"Active Agents\",\n      value: metrics?.activeAgents ?? 0,\n      icon: Activity,\n      testId: \"metric-active-agents\",\n    },\n    {\n      title: \"Success Rate\",\n      value: `${(metrics?.successRate ?? 0).toFixed(1)}%`,\n      icon: TrendingUp,\n      testId: \"metric-success-rate\",\n    },\n    {\n      title: \"Conversations Today\",\n      value: metrics?.conversationsToday ?? 0,\n      icon: MessageSquare,\n      testId: \"metric-conversations-today\",\n    },\n    {\n      title: \"Usage Cost Today\",\n      value: `$${(metrics?.usageCostToday ?? 0).toFixed(2)}`,\n      icon: DollarSign,\n      testId: \"metric-usage-cost\",\n    },\n    {\n      title: \"Avg Call Duration\",\n      value: `${Math.round(metrics?.avgCallDuration ?? 0)}s`,\n      icon: Clock,\n      testId: \"metric-avg-duration\",\n    },\n  ];\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6\">\n        <h1 className=\"text-3xl font-bold tracking-tight mb-6\" data-testid=\"heading-dashboard\">Dashboard</h1>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n          {[...Array(7)].map((_, i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                <div className=\"h-4 w-24 bg-muted rounded\" />\n                <div className=\"h-4 w-4 bg-muted rounded\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-8 w-16 bg-muted rounded\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-dashboard\">Dashboard</h1>\n        <p className=\"text-muted-foreground mt-1\" data-testid=\"text-dashboard-subtitle\">\n          AI Voice Agent Platform Overview\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n        {metricCards.map((metric) => {\n          const Icon = metric.icon;\n          return (\n            <Card key={metric.title} className=\"hover-elevate\" data-testid={`card-${metric.testId}`}>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                  {metric.title}\n                </CardTitle>\n                <Icon className=\"h-4 w-4 text-muted-foreground\" data-testid={`icon-${metric.testId}`} />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-3xl font-bold tracking-tight\" data-testid={`value-${metric.testId}`}>\n                  {metric.value}\n                </div>\n              </CardContent>\n            </Card>\n          );\n        })}\n      </div>\n\n      <div className=\"mt-8\">\n        <Card data-testid=\"card-quick-actions\">\n          <CardHeader>\n            <CardTitle>Quick Actions</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {quickActions.map((action) => {\n                const Icon = action.icon;\n                return (\n                  <Button\n                    key={action.testId}\n                    variant={action.variant}\n                    onClick={action.action}\n                    className=\"h-auto flex flex-col items-start gap-2 p-4\"\n                    data-testid={action.testId}\n                  >\n                    <div className=\"flex items-center gap-2 w-full\">\n                      <Icon className=\"h-5 w-5\" />\n                      <span className=\"font-semibold\">{action.title}</span>\n                    </div>\n                    <span className=\"text-xs text-left opacity-80\">\n                      {action.description}\n                    </span>\n                  </Button>\n                );\n              })}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":6479},"client/src/pages/Contacts.tsx":{"content":"export default function Contacts() {\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-3xl font-bold\">Contacts</h1>\n      <p className=\"text-muted-foreground mt-2\">Customer database - Coming Soon</p>\n    </div>\n  );\n}\n","size_bytes":231},"client/src/pages/Pipelines.tsx":{"content":"export default function Pipelines() {\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-3xl font-bold\">Pipelines</h1>\n      <p className=\"text-muted-foreground mt-2\">Sales pipeline setup - Coming Soon</p>\n    </div>\n  );\n}\n","size_bytes":236},"client/src/pages/KnowledgeBase.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Plus, Search, FileText, Trash2, Edit, BookOpen, X } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { KnowledgeBase as KnowledgeBaseType, AiAgent } from \"@shared/schema\";\nimport { createKnowledgeBaseSchema, updateKnowledgeBaseSchema } from \"@shared/schema\";\n\nconst formSchema = createKnowledgeBaseSchema.extend({\n  tags: z.array(z.string()).default([]),\n});\n\nconst editFormSchema = updateKnowledgeBaseSchema.extend({\n  tags: z.array(z.string()).optional(),\n});\n\ntype KnowledgeFormValues = z.infer<typeof formSchema>;\ntype KnowledgeEditValues = z.infer<typeof editFormSchema>;\n\nexport default function KnowledgeBase() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [categoryFilter, setCategoryFilter] = useState<string>(\"all\");\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n  const [isEditDialogOpen, setIsEditDialogOpen] = useState(false);\n  const [selectedItem, setSelectedItem] = useState<KnowledgeBaseType | null>(null);\n  const [itemToDelete, setItemToDelete] = useState<KnowledgeBaseType | null>(null);\n  const [tagInput, setTagInput] = useState(\"\");\n\n  const { toast } = useToast();\n\n  // Auto-open dialog from Quick Actions\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    if (params.get('action') === 'create') {\n      setIsCreateDialogOpen(true);\n      // Clean URL: remove action param while preserving base path\n      params.delete('action');\n      const newUrl = params.toString() ? \n        `${window.location.pathname}?${params.toString()}` : \n        window.location.pathname;\n      window.history.replaceState(null, '', newUrl);\n    }\n  }, []);\n\n  const createForm = useForm<KnowledgeFormValues>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      title: \"\",\n      content: \"\",\n      contentType: \"text\",\n      category: \"\",\n      tags: [],\n      agentId: null,\n      status: \"active\",\n    },\n  });\n\n  const editForm = useForm<KnowledgeEditValues>({\n    resolver: zodResolver(editFormSchema),\n    defaultValues: {\n      title: \"\",\n      content: \"\",\n      contentType: \"text\",\n      category: \"\",\n      tags: [],\n      agentId: null,\n      status: \"active\",\n    },\n  });\n\n  const { data: knowledgeBase = [], isLoading } = useQuery<KnowledgeBaseType[]>({\n    queryKey: [\"/api/knowledge-base\"],\n  });\n\n  const { data: agents = [] } = useQuery<AiAgent[]>({\n    queryKey: [\"/api/ai-agents\"],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: KnowledgeFormValues) => {\n      // Deduplicate tags before sending\n      const deduplicatedData = {\n        ...data,\n        tags: Array.from(new Set(data.tags)),\n      };\n      return await apiRequest(\"/api/knowledge-base\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(deduplicatedData),\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/knowledge-base\"] });\n      setIsCreateDialogOpen(false);\n      createForm.reset();\n      setTagInput(\"\");\n      toast({\n        title: \"Knowledge base item created\",\n        description: \"Your knowledge base item has been created successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error?.message || \"Failed to create knowledge base item. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: KnowledgeEditValues }) => {\n      // Deduplicate tags before sending\n      const deduplicatedData = {\n        ...data,\n        tags: data.tags ? Array.from(new Set(data.tags)) : undefined,\n      };\n      return await apiRequest(`/api/knowledge-base/${id}`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(deduplicatedData),\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/knowledge-base\"] });\n      setIsEditDialogOpen(false);\n      setSelectedItem(null);\n      editForm.reset();\n      setTagInput(\"\");\n      toast({\n        title: \"Knowledge base item updated\",\n        description: \"Your changes have been saved successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error?.message || \"Failed to update knowledge base item. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/knowledge-base/${id}`, {\n        method: \"DELETE\",\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/knowledge-base\"] });\n      setItemToDelete(null);\n      toast({\n        title: \"Knowledge base item deleted\",\n        description: \"The item has been removed from your knowledge base.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete knowledge base item. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleOpenCreateDialog = () => {\n    createForm.reset();\n    setTagInput(\"\");\n    setIsCreateDialogOpen(true);\n  };\n\n  const handleOpenEditDialog = (item: KnowledgeBaseType) => {\n    setSelectedItem(item);\n    editForm.reset({\n      title: item.title,\n      content: item.content,\n      contentType: item.contentType,\n      category: item.category || \"\",\n      tags: item.tags || [],\n      agentId: item.agentId,\n      status: item.status,\n    });\n    setTagInput(\"\");\n    setIsEditDialogOpen(true);\n  };\n\n  const handleAddTag = (form: typeof createForm | typeof editForm) => {\n    const trimmedTag = tagInput.trim();\n    if (!trimmedTag) return;\n\n    const currentTags = form.getValues(\"tags\") || [];\n    // Deduplicate - only add if not already present\n    if (!currentTags.includes(trimmedTag)) {\n      form.setValue(\"tags\", [...currentTags, trimmedTag]);\n    }\n    setTagInput(\"\");\n  };\n\n  const handleRemoveTag = (form: typeof createForm | typeof editForm, tagToRemove: string) => {\n    const currentTags = form.getValues(\"tags\") || [];\n    form.setValue(\"tags\", currentTags.filter(tag => tag !== tagToRemove));\n  };\n\n  const onCreateSubmit = (data: KnowledgeFormValues) => {\n    createMutation.mutate(data);\n  };\n\n  const onEditSubmit = (data: KnowledgeEditValues) => {\n    if (selectedItem) {\n      updateMutation.mutate({ id: selectedItem.id, data });\n    }\n  };\n\n  const handleDelete = () => {\n    if (itemToDelete) {\n      deleteMutation.mutate(itemToDelete.id);\n    }\n  };\n\n  const filteredItems = knowledgeBase.filter((item) => {\n    const matchesSearch =\n      !searchQuery ||\n      item.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      item.content.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      item.category?.toLowerCase().includes(searchQuery.toLowerCase());\n\n    const matchesCategory =\n      categoryFilter === \"all\" || item.category === categoryFilter;\n\n    return matchesSearch && matchesCategory;\n  });\n\n  const categories = Array.from(new Set(knowledgeBase.map(item => item.category).filter(Boolean)));\n\n  return (\n    <div className=\"flex flex-col gap-6 p-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-page-title\">Knowledge Base</h1>\n          <p className=\"text-muted-foreground mt-2\">Manage AI training data and documentation</p>\n        </div>\n        <Button onClick={handleOpenCreateDialog} data-testid=\"button-create\">\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Add Knowledge\n        </Button>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Search & Filter</CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex gap-4\">\n          <div className=\"flex-1 relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search knowledge base...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"input-search\"\n            />\n          </div>\n          <Select value={categoryFilter} onValueChange={setCategoryFilter}>\n            <SelectTrigger className=\"w-48\" data-testid=\"select-category-filter\">\n              <SelectValue placeholder=\"Filter by category\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Categories</SelectItem>\n              {categories.map((category) => (\n                <SelectItem key={category} value={category!}>\n                  {category}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </CardContent>\n      </Card>\n\n      {isLoading ? (\n        <div className=\"flex items-center justify-center py-12\" data-testid=\"loading-knowledge\">\n          <div className=\"text-muted-foreground\">Loading knowledge base...</div>\n        </div>\n      ) : filteredItems.length === 0 ? (\n        <div className=\"flex flex-col items-center justify-center py-12\" data-testid=\"empty-knowledge\">\n          <BookOpen className=\"w-12 h-12 text-muted-foreground mb-4\" />\n          <h3 className=\"text-lg font-medium mb-2\">No knowledge base items</h3>\n          <p className=\"text-muted-foreground text-center max-w-md mb-4\">\n            {searchQuery || categoryFilter !== \"all\"\n              ? \"Try adjusting your filters to see more results.\"\n              : \"Start building your AI knowledge base by adding training data and documentation.\"}\n          </p>\n          {!searchQuery && categoryFilter === \"all\" && (\n            <Button onClick={handleOpenCreateDialog}>\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add Your First Knowledge\n            </Button>\n          )}\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          {filteredItems.map((item) => (\n            <Card key={item.id} className=\"hover-elevate\" data-testid={`card-knowledge-${item.id}`}>\n              <CardHeader>\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex-1\">\n                    <CardTitle className=\"text-lg\" data-testid={`text-title-${item.id}`}>{item.title}</CardTitle>\n                    {item.category && (\n                      <Badge variant=\"outline\" className=\"mt-2\" data-testid={`badge-category-${item.id}`}>\n                        {item.category}\n                      </Badge>\n                    )}\n                  </div>\n                  <FileText className=\"w-5 h-5 text-muted-foreground\" />\n                </div>\n                <CardDescription className=\"line-clamp-2\" data-testid={`text-content-${item.id}`}>\n                  {item.content}\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {item.tags && item.tags.length > 0 && (\n                    <div className=\"flex flex-wrap gap-1\">\n                      {item.tags.map((tag) => (\n                        <Badge key={tag} variant=\"secondary\" className=\"text-xs\">\n                          {tag}\n                        </Badge>\n                      ))}\n                    </div>\n                  )}\n                  {item.agentId && (\n                    <div className=\"text-sm text-muted-foreground\">\n                      Assigned to: {agents.find(a => a.id === item.agentId)?.name || item.agentId}\n                    </div>\n                  )}\n                  <div className=\"flex gap-2 pt-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleOpenEditDialog(item)}\n                      data-testid={`button-edit-${item.id}`}\n                    >\n                      <Edit className=\"w-3 h-3 mr-1\" />\n                      Edit\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => setItemToDelete(item)}\n                      data-testid={`button-delete-${item.id}`}\n                    >\n                      <Trash2 className=\"w-3 h-3 mr-1\" />\n                      Delete\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      )}\n\n      {/* Create Dialog with react-hook-form */}\n      <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\" data-testid=\"dialog-create\">\n          <DialogHeader>\n            <DialogTitle data-testid=\"text-dialog-title\">Add Knowledge Base Item</DialogTitle>\n            <DialogDescription data-testid=\"text-dialog-description\">\n              Add training data, documentation, or FAQs for your AI agents.\n            </DialogDescription>\n          </DialogHeader>\n          <Form {...createForm}>\n            <form onSubmit={createForm.handleSubmit(onCreateSubmit)} className=\"space-y-4\">\n              <FormField\n                control={createForm.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Title *</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"Enter title\"\n                        {...field}\n                        data-testid=\"input-title\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={createForm.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Content *</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"Enter content or training data\"\n                        rows={6}\n                        {...field}\n                        data-testid=\"input-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={createForm.control}\n                  name=\"contentType\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Content Type</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-content-type\">\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"text\">Text</SelectItem>\n                          <SelectItem value=\"faq\">FAQ</SelectItem>\n                          <SelectItem value=\"script\">Script</SelectItem>\n                          <SelectItem value=\"documentation\">Documentation</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={createForm.control}\n                  name=\"category\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Category</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"e.g., Sales, Support\"\n                          {...field}\n                          data-testid=\"input-category\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={createForm.control}\n                name=\"agentId\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Assign to Agent (Optional)</FormLabel>\n                    <Select\n                      onValueChange={(value) => field.onChange(value === \"none\" ? null : value)}\n                      defaultValue={field.value || \"none\"}\n                    >\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-agent\">\n                          <SelectValue placeholder=\"Select an agent\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"none\">No agent</SelectItem>\n                        {agents.map((agent) => (\n                          <SelectItem key={agent.id} value={agent.id}>\n                            {agent.name}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div>\n                <Label htmlFor=\"tags\">Tags</Label>\n                <div className=\"flex gap-2 mb-2\">\n                  <Input\n                    id=\"tags\"\n                    value={tagInput}\n                    onChange={(e) => setTagInput(e.target.value)}\n                    onKeyPress={(e) => {\n                      if (e.key === \"Enter\") {\n                        e.preventDefault();\n                        handleAddTag(createForm);\n                      }\n                    }}\n                    placeholder=\"Add a tag\"\n                    data-testid=\"input-tag\"\n                  />\n                  <Button\n                    type=\"button\"\n                    onClick={() => handleAddTag(createForm)}\n                    variant=\"outline\"\n                    data-testid=\"button-add-tag\"\n                  >\n                    Add\n                  </Button>\n                </div>\n                <div className=\"flex flex-wrap gap-1\">\n                  {(createForm.watch(\"tags\") || []).map((tag) => (\n                    <Badge key={tag} variant=\"secondary\" data-testid={`badge-tag-${tag}`}>\n                      {tag}\n                      <button\n                        type=\"button\"\n                        onClick={() => handleRemoveTag(createForm, tag)}\n                        className=\"ml-1 hover:text-destructive\"\n                        data-testid={`button-remove-tag-${tag}`}\n                      >\n                        <X className=\"w-3 h-3\" />\n                      </button>\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n\n              <DialogFooter>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setIsCreateDialogOpen(false)}\n                  data-testid=\"button-cancel-create\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"submit\"\n                  disabled={createMutation.isPending}\n                  data-testid=\"button-submit-create\"\n                >\n                  {createMutation.isPending ? \"Creating...\" : \"Create\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Edit Dialog with react-hook-form */}\n      <Dialog open={isEditDialogOpen} onOpenChange={setIsEditDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\" data-testid=\"dialog-edit\">\n          <DialogHeader>\n            <DialogTitle data-testid=\"text-edit-dialog-title\">Edit Knowledge Base Item</DialogTitle>\n          </DialogHeader>\n          <Form {...editForm}>\n            <form onSubmit={editForm.handleSubmit(onEditSubmit)} className=\"space-y-4\">\n              <FormField\n                control={editForm.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Title *</FormLabel>\n                    <FormControl>\n                      <Input {...field} data-testid=\"input-edit-title\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={editForm.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Content *</FormLabel>\n                    <FormControl>\n                      <Textarea rows={6} {...field} data-testid=\"input-edit-content\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={editForm.control}\n                  name=\"contentType\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Content Type</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-edit-content-type\">\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"text\">Text</SelectItem>\n                          <SelectItem value=\"faq\">FAQ</SelectItem>\n                          <SelectItem value=\"script\">Script</SelectItem>\n                          <SelectItem value=\"documentation\">Documentation</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={editForm.control}\n                  name=\"category\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Category</FormLabel>\n                      <FormControl>\n                        <Input {...field} data-testid=\"input-edit-category\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={editForm.control}\n                name=\"agentId\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Assign to Agent (Optional)</FormLabel>\n                    <Select\n                      onValueChange={(value) => field.onChange(value === \"none\" ? null : value)}\n                      defaultValue={field.value || \"none\"}\n                    >\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-edit-agent\">\n                          <SelectValue />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"none\">No agent</SelectItem>\n                        {agents.map((agent) => (\n                          <SelectItem key={agent.id} value={agent.id}>\n                            {agent.name}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div>\n                <Label htmlFor=\"edit-tags\">Tags</Label>\n                <div className=\"flex gap-2 mb-2\">\n                  <Input\n                    id=\"edit-tags\"\n                    value={tagInput}\n                    onChange={(e) => setTagInput(e.target.value)}\n                    onKeyPress={(e) => {\n                      if (e.key === \"Enter\") {\n                        e.preventDefault();\n                        handleAddTag(editForm);\n                      }\n                    }}\n                    placeholder=\"Add a tag\"\n                    data-testid=\"input-edit-tag\"\n                  />\n                  <Button\n                    type=\"button\"\n                    onClick={() => handleAddTag(editForm)}\n                    variant=\"outline\"\n                    data-testid=\"button-add-edit-tag\"\n                  >\n                    Add\n                  </Button>\n                </div>\n                <div className=\"flex flex-wrap gap-1\">\n                  {(editForm.watch(\"tags\") || []).map((tag) => (\n                    <Badge key={tag} variant=\"secondary\" data-testid={`badge-edit-tag-${tag}`}>\n                      {tag}\n                      <button\n                        type=\"button\"\n                        onClick={() => handleRemoveTag(editForm, tag)}\n                        className=\"ml-1 hover:text-destructive\"\n                        data-testid={`button-remove-edit-tag-${tag}`}\n                      >\n                        <X className=\"w-3 h-3\" />\n                      </button>\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n\n              <FormField\n                control={editForm.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-edit-status\">\n                          <SelectValue />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"active\">Active</SelectItem>\n                        <SelectItem value=\"inactive\">Inactive</SelectItem>\n                        <SelectItem value=\"archived\">Archived</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <DialogFooter>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setIsEditDialogOpen(false)}\n                  data-testid=\"button-cancel-edit\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"submit\"\n                  disabled={updateMutation.isPending}\n                  data-testid=\"button-submit-edit\"\n                >\n                  {updateMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={!!itemToDelete} onOpenChange={() => setItemToDelete(null)}>\n        <AlertDialogContent data-testid=\"dialog-delete-confirm\">\n          <AlertDialogHeader>\n            <AlertDialogTitle data-testid=\"text-delete-title\">Delete Knowledge Base Item?</AlertDialogTitle>\n            <AlertDialogDescription data-testid=\"text-delete-description\">\n              This will permanently delete \"{itemToDelete?.title}\". This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-cancel-delete\">Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleDelete}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-delete\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","size_bytes":29836},"client/src/pages/AIAgents.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Bot, Phone, Plus, Settings, Zap, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { AiAgent, CreateAiAgentInput } from \"@shared/schema\";\nimport { createAiAgentSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\n\n// Form schema with numeric coercion - extends shared schema for alignment\n// z.coerce handles HTML number input strings â†’ numbers automatically\nconst agentFormSchema = createAiAgentSchema.extend({\n  temperature: z.coerce.number().min(0).max(2).default(0.7),\n  maxDuration: z.coerce.number().int().positive().default(600),\n  maxTokens: z.coerce.number().int().positive().default(150),\n}).partial({\n  description: true,\n  voiceId: true,\n  voiceName: true,\n  systemPrompt: true,\n  temperature: true,\n  maxDuration: true,\n  provider: true,\n  voiceProvider: true,\n  voiceType: true,\n  agentType: true,\n  maxTokens: true,\n  status: true,\n  createdBy: true,\n  bolnaAgentId: true,\n  bolnaConfig: true,\n  avgRating: true,\n});\n\ntype AgentFormValues = z.infer<typeof agentFormSchema>;\n\nexport default function AIAgents() {\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n  const { toast } = useToast();\n\n  // Auto-open dialog from Quick Actions\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    if (params.get('action') === 'create') {\n      setIsCreateDialogOpen(true);\n      // Clean URL: remove action param while preserving base path\n      params.delete('action');\n      const newUrl = params.toString() ? \n        `${window.location.pathname}?${params.toString()}` : \n        window.location.pathname;\n      window.history.replaceState(null, '', newUrl);\n    }\n  }, []);\n\n  const { data: agents, isLoading } = useQuery<AiAgent[]>({\n    queryKey: ['/api/ai-agents'],\n  });\n\n  const form = useForm<AgentFormValues>({\n    resolver: zodResolver(agentFormSchema),\n    defaultValues: {\n      name: \"\",\n      description: \"\",\n      model: \"gpt-4\",\n      language: \"en-US\",\n      voiceId: \"\",\n      voiceName: \"\",\n      systemPrompt: \"\",\n      temperature: 0.7,\n      maxDuration: 600,\n      status: \"active\",\n      provider: \"openai\",\n      voiceProvider: \"elevenlabs\",\n      voiceType: \"male\",\n      agentType: \"conversational\",\n      maxTokens: 150,\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: AgentFormValues) => {\n      // Ensure numeric fields have defaults (never undefined)\n      const payload = {\n        ...data,\n        temperature: data.temperature ?? 0.7,\n        maxDuration: data.maxDuration ?? 600,\n        maxTokens: data.maxTokens ?? 150,\n        provider: data.provider ?? \"openai\",\n        voiceProvider: data.voiceProvider ?? \"elevenlabs\",\n        agentType: data.agentType ?? \"conversational\",\n        status: data.status ?? \"active\",\n      };\n      const res = await apiRequest('POST', '/api/ai-agents', payload);\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/ai-agents'] });\n      setIsCreateDialogOpen(false);\n      form.reset();\n      toast({\n        title: \"Success\",\n        description: \"AI Agent created successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create AI agent\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (data: AgentFormValues) => {\n    createMutation.mutate(data);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <div>\n            <h1 className=\"text-3xl font-bold tracking-tight\">AI Voice Agents</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage your AI voice agents</p>\n          </div>\n          <Button data-testid=\"button-create-agent\" disabled>\n            <Plus className=\"h-4 w-4 mr-2\" />\n            Create Agent\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {[...Array(6)].map((_, i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader>\n                <div className=\"h-6 w-32 bg-muted rounded\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <div className=\"h-4 w-full bg-muted rounded\" />\n                  <div className=\"h-4 w-3/4 bg-muted rounded\" />\n                </div>\n              </CardContent>\n              <CardFooter>\n                <div className=\"h-10 w-full bg-muted rounded\" />\n              </CardFooter>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-ai-agents\">\n            AI Voice Agents\n          </h1>\n          <p className=\"text-muted-foreground mt-1\" data-testid=\"text-subtitle\">\n            Manage your AI voice agents powered by Bolna\n          </p>\n        </div>\n        <Button onClick={() => setIsCreateDialogOpen(true)} data-testid=\"button-create-agent\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Create Agent\n        </Button>\n      </div>\n\n      {!agents || agents.length === 0 ? (\n        <Card className=\"p-12 text-center\" data-testid=\"card-empty-state\">\n          <div className=\"flex flex-col items-center gap-4\">\n            <div className=\"p-4 bg-muted rounded-full\">\n              <Bot className=\"h-8 w-8 text-muted-foreground\" />\n            </div>\n            <div>\n              <h3 className=\"text-lg font-semibold mb-1\" data-testid=\"heading-empty-title\">\n                No AI Agents Yet\n              </h3>\n              <p className=\"text-sm text-muted-foreground mb-4\" data-testid=\"text-empty-description\">\n                Create your first AI voice agent to start handling calls\n              </p>\n              <Button onClick={() => setIsCreateDialogOpen(true)} data-testid=\"button-create-first-agent\">\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Create Your First Agent\n              </Button>\n            </div>\n          </div>\n        </Card>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {agents.map((agent) => (\n            <Card key={agent.id} className=\"hover-elevate\" data-testid={`card-agent-${agent.id}`}>\n              <CardHeader className=\"flex flex-row items-start justify-between gap-2 space-y-0\">\n                <div className=\"flex-1\">\n                  <CardTitle className=\"text-lg mb-2\" data-testid={`text-agent-name-${agent.id}`}>\n                    {agent.name}\n                  </CardTitle>\n                  <Badge\n                    variant={agent.status === 'active' ? 'default' : 'secondary'}\n                    className=\"text-xs\"\n                    data-testid={`badge-status-${agent.id}`}\n                  >\n                    {agent.status}\n                  </Badge>\n                </div>\n                <Bot className=\"h-5 w-5 text-muted-foreground\" />\n              </CardHeader>\n\n              <CardContent className=\"space-y-3\">\n                <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                  <div>\n                    <p className=\"text-muted-foreground text-xs\">Voice</p>\n                    <p className=\"font-medium\" data-testid={`text-voice-${agent.id}`}>\n                      {agent.voiceType}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-muted-foreground text-xs\">Language</p>\n                    <p className=\"font-medium\" data-testid={`text-language-${agent.id}`}>\n                      {agent.language}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-muted-foreground text-xs\">Model</p>\n                    <p className=\"font-medium\" data-testid={`text-model-${agent.id}`}>\n                      {agent.model}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-muted-foreground text-xs\">Provider</p>\n                    <p className=\"font-medium\" data-testid={`text-provider-${agent.id}`}>\n                      {agent.provider}\n                    </p>\n                  </div>\n                </div>\n\n                {agent.description && (\n                  <p className=\"text-sm text-muted-foreground line-clamp-2\" data-testid={`text-description-${agent.id}`}>\n                    {agent.description}\n                  </p>\n                )}\n              </CardContent>\n\n              <CardFooter className=\"flex gap-2\">\n                <Button\n                  variant=\"default\"\n                  size=\"sm\"\n                  className=\"flex-1\"\n                  data-testid={`button-call-${agent.id}`}\n                >\n                  <Phone className=\"h-3 w-3 mr-1\" />\n                  Call\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"flex-1\"\n                  data-testid={`button-settings-${agent.id}`}\n                >\n                  <Settings className=\"h-3 w-3 mr-1\" />\n                  Settings\n                </Button>\n              </CardFooter>\n            </Card>\n          ))}\n        </div>\n      )}\n\n      {agents && agents.length > 0 && (\n        <div className=\"mt-8\">\n          <Card data-testid=\"card-stats\">\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Quick Stats</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\n                <div>\n                  <p className=\"text-2xl font-bold\" data-testid=\"text-total-agents\">\n                    {agents.length}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">Total Agents</p>\n                </div>\n                <div>\n                  <p className=\"text-2xl font-bold\" data-testid=\"text-active-agents\">\n                    {agents.filter(a => a.status === 'active').length}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">Active</p>\n                </div>\n                <div>\n                  <p className=\"text-2xl font-bold\" data-testid=\"text-inactive-agents\">\n                    {agents.filter(a => a.status === 'inactive').length}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">Inactive</p>\n                </div>\n                <div>\n                  <p className=\"text-2xl font-bold\" data-testid=\"text-testing-agents\">\n                    {agents.filter(a => a.status === 'testing').length}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">Testing</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\" data-testid=\"dialog-create-agent\">\n          <DialogHeader>\n            <DialogTitle>Create AI Agent</DialogTitle>\n            <DialogDescription>\n              Configure a new AI voice agent powered by Bolna\n            </DialogDescription>\n          </DialogHeader>\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(handleSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"name\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Agent Name *</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"Sales Assistant\" {...field} data-testid=\"input-agent-name\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"description\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Description</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        placeholder=\"Describe what this agent does...\" \n                        {...field} \n                        data-testid=\"input-agent-description\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"model\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>AI Model *</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-model\">\n                            <SelectValue placeholder=\"Select model\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"gpt-4\">GPT-4</SelectItem>\n                          <SelectItem value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</SelectItem>\n                          <SelectItem value=\"gpt-4-turbo\">GPT-4 Turbo</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"language\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Language *</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-language\">\n                            <SelectValue placeholder=\"Select language\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"en-US\">English (US)</SelectItem>\n                          <SelectItem value=\"en-GB\">English (UK)</SelectItem>\n                          <SelectItem value=\"es-ES\">Spanish</SelectItem>\n                          <SelectItem value=\"fr-FR\">French</SelectItem>\n                          <SelectItem value=\"de-DE\">German</SelectItem>\n                          <SelectItem value=\"hi-IN\">Hindi</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"voiceProvider\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Voice Provider</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-voice-provider\">\n                            <SelectValue placeholder=\"Select provider\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"elevenlabs\">ElevenLabs</SelectItem>\n                          <SelectItem value=\"google\">Google TTS</SelectItem>\n                          <SelectItem value=\"azure\">Azure TTS</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"voiceId\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Voice ID</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"e.g., 21m00Tcm4TlvDq8ikWAM\" {...field} data-testid=\"input-voice-id\" />\n                      </FormControl>\n                      <FormDescription className=\"text-xs\">\n                        Get from your voice provider\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"systemPrompt\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>System Prompt</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        placeholder=\"You are a helpful sales assistant...\" \n                        rows={4}\n                        {...field} \n                        data-testid=\"input-system-prompt\"\n                      />\n                    </FormControl>\n                    <FormDescription className=\"text-xs\">\n                      Instructions for how the agent should behave\n                    </FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-3 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"temperature\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Temperature</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          step=\"0.1\" \n                          min=\"0\" \n                          max=\"2\" \n                          value={field.value ?? 0.7}\n                          onChange={(e) => {\n                            const val = e.target.value === \"\" ? 0.7 : parseFloat(e.target.value);\n                            field.onChange(val);\n                          }}\n                          data-testid=\"input-temperature\"\n                        />\n                      </FormControl>\n                      <FormDescription className=\"text-xs\">0.0 - 2.0</FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"maxDuration\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Max Duration (s)</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\"\n                          value={field.value ?? 600}\n                          onChange={(e) => {\n                            const val = e.target.value === \"\" ? 600 : parseInt(e.target.value, 10);\n                            field.onChange(val);\n                          }}\n                          data-testid=\"input-max-duration\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"status\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Status</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-status\">\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"active\">Active</SelectItem>\n                          <SelectItem value=\"inactive\">Inactive</SelectItem>\n                          <SelectItem value=\"testing\">Testing</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <DialogFooter>\n                <Button \n                  type=\"button\" \n                  variant=\"outline\" \n                  onClick={() => setIsCreateDialogOpen(false)}\n                  data-testid=\"button-cancel\"\n                >\n                  Cancel\n                </Button>\n                <Button \n                  type=\"submit\" \n                  disabled={createMutation.isPending}\n                  data-testid=\"button-submit\"\n                >\n                  {createMutation.isPending && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\n                  Create Agent\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":22391},"client/src/pages/Calls.tsx":{"content":"export default function Calls() {\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-3xl font-bold\">Calls</h1>\n      <p className=\"text-muted-foreground mt-2\">Voice calls & history - Coming Soon</p>\n    </div>\n  );\n}\n","size_bytes":229},"server/bolna.ts":{"content":"import type { AiAgent } from \"@shared/schema\";\n\nconst BOLNA_API_URL = \"https://api.bolna.dev\";\nconst BOLNA_API_KEY = process.env.BOLNA_API_KEY;\n\nif (!BOLNA_API_KEY) {\n  console.error(\"BOLNA_API_KEY environment variable is not set\");\n}\n\ninterface BolnaAgentConfig {\n  agent_name: string;\n  agent_type: string;\n  agent_welcome_message?: string;\n  tasks: BolnaTask[];\n  llm_config?: {\n    model: string;\n    provider: string;\n    temperature?: number;\n    max_tokens?: number;\n  };\n  voice_config?: {\n    provider: string;\n    voice_id: string;\n    language?: string;\n  };\n}\n\ninterface BolnaTask {\n  task_type: string;\n  toolchain?: {\n    execution: string;\n    pipelines: any[];\n  };\n}\n\ninterface BolnaAgent {\n  agent_id: string;\n  agent_name: string;\n  agent_type: string;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface BolnaCallRequest {\n  agent_id: string;\n  recipient_phone_number: string;\n  from?: string;\n  metadata?: Record<string, any>;\n}\n\ninterface BolnaCallResponse {\n  call_id: string;\n  status: string;\n  agent_id: string;\n  recipient_phone_number: string;\n  created_at: string;\n}\n\ninterface BolnaWebhookPayload {\n  call_id: string;\n  status: string;\n  duration?: number;\n  transcript?: string;\n  recording_url?: string;\n  metadata?: Record<string, any>;\n}\n\nexport class BolnaClient {\n  private apiKey: string | null;\n  private baseUrl: string;\n  private isConfigured: boolean;\n\n  constructor() {\n    this.apiKey = BOLNA_API_KEY || null;\n    this.baseUrl = BOLNA_API_URL;\n    this.isConfigured = !!BOLNA_API_KEY;\n    \n    if (!this.isConfigured) {\n      console.warn(\"âš ï¸  Bolna API is not configured. AI agent Bolna integration will be disabled.\");\n      console.warn(\"   Set BOLNA_API_KEY environment variable to enable Bolna features.\");\n    }\n  }\n  \n  private ensureConfigured(): void {\n    if (!this.isConfigured || !this.apiKey) {\n      throw new Error(\"Bolna API is not configured. Set BOLNA_API_KEY to use Bolna features.\");\n    }\n  }\n\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<T> {\n    const url = `${this.baseUrl}${endpoint}`;\n    const headers = {\n      \"Authorization\": `Bearer ${this.apiKey}`,\n      \"Content-Type\": \"application/json\",\n      ...options.headers,\n    };\n\n    try {\n      const response = await fetch(url, {\n        ...options,\n        headers,\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(\n          `Bolna API error (${response.status}): ${errorText}`\n        );\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error(\"Bolna API request failed:\", error);\n      throw error;\n    }\n  }\n\n  async createAgent(agentData: AiAgent): Promise<BolnaAgent> {\n    this.ensureConfigured();\n    const config: BolnaAgentConfig = {\n      agent_name: agentData.name,\n      agent_type: agentData.agentType || \"conversational\",\n      agent_welcome_message: agentData.systemPrompt || \"Hello! How can I help you today?\",\n      tasks: [\n        {\n          task_type: \"conversation\",\n          toolchain: {\n            execution: \"sequential\",\n            pipelines: [],\n          },\n        },\n      ],\n      llm_config: {\n        model: agentData.model,\n        provider: agentData.provider || \"openai\",\n        temperature: agentData.temperature || 0.7,\n        max_tokens: agentData.maxTokens || 150,\n      },\n      voice_config: {\n        provider: agentData.voiceProvider || \"elevenlabs\",\n        voice_id: agentData.voiceId,\n        language: agentData.language || \"en\",\n      },\n    };\n\n    return await this.request<BolnaAgent>(\"/v1/agents\", {\n      method: \"POST\",\n      body: JSON.stringify(config),\n    });\n  }\n\n  async updateAgent(\n    agentId: string,\n    updates: Partial<AiAgent>\n  ): Promise<BolnaAgent> {\n    this.ensureConfigured();\n    const config: Partial<BolnaAgentConfig> = {};\n\n    if (updates.name) config.agent_name = updates.name;\n    if (updates.systemPrompt) config.agent_welcome_message = updates.systemPrompt;\n\n    if (updates.model || updates.provider || updates.temperature || updates.maxTokens) {\n      config.llm_config = {\n        model: updates.model!,\n        provider: updates.provider || \"openai\",\n        temperature: updates.temperature,\n        max_tokens: updates.maxTokens,\n      };\n    }\n\n    if (updates.voiceId || updates.voiceProvider || updates.language) {\n      config.voice_config = {\n        provider: updates.voiceProvider || \"elevenlabs\",\n        voice_id: updates.voiceId!,\n        language: updates.language,\n      };\n    }\n\n    return await this.request<BolnaAgent>(`/v1/agents/${agentId}`, {\n      method: \"PATCH\",\n      body: JSON.stringify(config),\n    });\n  }\n\n  async deleteAgent(agentId: string): Promise<void> {\n    this.ensureConfigured();\n    await this.request<void>(`/v1/agents/${agentId}`, {\n      method: \"DELETE\",\n    });\n  }\n\n  async getAgent(agentId: string): Promise<BolnaAgent> {\n    this.ensureConfigured();\n    return await this.request<BolnaAgent>(`/v1/agents/${agentId}`);\n  }\n\n  async listAgents(): Promise<BolnaAgent[]> {\n    this.ensureConfigured();\n    const response = await this.request<{ agents: BolnaAgent[] }>(\"/v1/agents\");\n    return response.agents;\n  }\n\n  async initiateCall(callData: BolnaCallRequest): Promise<BolnaCallResponse> {\n    this.ensureConfigured();\n    return await this.request<BolnaCallResponse>(\"/v1/calls\", {\n      method: \"POST\",\n      body: JSON.stringify(callData),\n    });\n  }\n\n  async getCallStatus(callId: string): Promise<any> {\n    this.ensureConfigured();\n    return await this.request<any>(`/v1/calls/${callId}`);\n  }\n\n  async getCallTranscript(callId: string): Promise<string> {\n    this.ensureConfigured();\n    const response = await this.request<{ transcript: string }>(\n      `/v1/calls/${callId}/transcript`\n    );\n    return response.transcript;\n  }\n}\n\nexport const bolnaClient = new BolnaClient();\n","size_bytes":5904},"server/exotel.ts":{"content":"const EXOTEL_API_KEY = process.env.EXOTEL_API_KEY;\nconst EXOTEL_API_SECRET = process.env.EXOTEL_API_SECRET;\nconst EXOTEL_SID = process.env.EXOTEL_SID;\nconst EXOTEL_API_URL = `https://api.exotel.com/v1/Accounts/${EXOTEL_SID}`;\n\nif (!EXOTEL_API_KEY || !EXOTEL_API_SECRET || !EXOTEL_SID) {\n  console.error(\"Exotel environment variables are not set\");\n}\n\ninterface ExotelCallRequest {\n  From: string;\n  To: string;\n  CallerId: string;\n  CallType?: \"trans\" | \"promo\";\n  TimeLimit?: number;\n  TimeOut?: number;\n  StatusCallback?: string;\n  StatusCallbackEvents?: string[];\n  StatusCallbackContentType?: \"application/json\" | \"application/x-www-form-urlencoded\";\n  Record?: boolean;\n  RecordingStatusCallback?: string;\n  CustomField?: string;\n}\n\ninterface ExotelCallResponse {\n  Call: {\n    Sid: string;\n    ParentCallSid: string | null;\n    DateCreated: string;\n    DateUpdated: string;\n    AccountSid: string;\n    To: string;\n    From: string;\n    PhoneNumberSid: string;\n    Status: string;\n    StartTime: string | null;\n    EndTime: string | null;\n    Duration: number | null;\n    Price: number | null;\n    Direction: string;\n    AnsweredBy: string | null;\n    ForwardedFrom: string | null;\n    CallerName: string | null;\n    Uri: string;\n    RecordingUrl: string | null;\n  };\n}\n\ninterface ExotelPhoneNumber {\n  Sid: string;\n  AccountSid: string;\n  FriendlyName: string;\n  PhoneNumber: string;\n  VoiceUrl: string;\n  VoiceMethod: string;\n  VoiceFallbackUrl: string;\n  VoiceFallbackMethod: string;\n  StatusCallback: string;\n  StatusCallbackMethod: string;\n  VoiceCallerIdLookup: boolean;\n  DateCreated: string;\n  DateUpdated: string;\n  SmsUrl: string;\n  SmsMethod: string;\n  SmsFallbackUrl: string;\n  SmsFallbackMethod: string;\n  Uri: string;\n}\n\ninterface ExotelCallDetail {\n  Sid: string;\n  Status: string;\n  From: string;\n  To: string;\n  StartTime: string;\n  EndTime: string;\n  Duration: number;\n  RecordingUrl: string | null;\n  Price: number;\n}\n\nexport class ExotelClient {\n  private apiKey: string | null;\n  private apiSecret: string | null;\n  private sid: string | null;\n  private baseUrl: string;\n  private isConfigured: boolean;\n\n  constructor() {\n    this.apiKey = EXOTEL_API_KEY || null;\n    this.apiSecret = EXOTEL_API_SECRET || null;\n    this.sid = EXOTEL_SID || null;\n    this.baseUrl = EXOTEL_API_URL;\n    this.isConfigured = !!(EXOTEL_API_KEY && EXOTEL_API_SECRET && EXOTEL_SID);\n    \n    if (!this.isConfigured) {\n      console.warn(\"âš ï¸  Exotel API is not configured. Phone number management and call routing will be disabled.\");\n      console.warn(\"   Set EXOTEL_API_KEY, EXOTEL_API_SECRET, and EXOTEL_SID environment variables to enable Exotel features.\");\n    }\n  }\n  \n  private ensureConfigured(): void {\n    if (!this.isConfigured || !this.apiKey || !this.apiSecret || !this.sid) {\n      throw new Error(\"Exotel API is not configured. Set EXOTEL_API_KEY, EXOTEL_API_SECRET, and EXOTEL_SID to use Exotel features.\");\n    }\n  }\n\n  private getAuthHeader(): string {\n    const credentials = Buffer.from(`${this.apiKey}:${this.apiSecret}`).toString(\"base64\");\n    return `Basic ${credentials}`;\n  }\n\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<T> {\n    const url = `${this.baseUrl}${endpoint}`;\n    const headers = {\n      \"Authorization\": this.getAuthHeader(),\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      ...options.headers,\n    };\n\n    try {\n      const response = await fetch(url, {\n        ...options,\n        headers,\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(\n          `Exotel API error (${response.status}): ${errorText}`\n        );\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error(\"Exotel API request failed:\", error);\n      throw error;\n    }\n  }\n\n  private buildFormData(data: Record<string, any>): string {\n    return Object.entries(data)\n      .map(([key, value]) => {\n        if (Array.isArray(value)) {\n          return value.map(v => `${encodeURIComponent(key)}[]=${encodeURIComponent(v)}`).join('&');\n        }\n        return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n      })\n      .join('&');\n  }\n\n  async makeCall(callData: ExotelCallRequest): Promise<ExotelCallResponse> {\n    this.ensureConfigured();\n    const formData = this.buildFormData(callData);\n\n    return await this.request<ExotelCallResponse>(\"/Calls/connect.json\", {\n      method: \"POST\",\n      body: formData,\n    });\n  }\n\n  async getCallDetails(callSid: string): Promise<ExotelCallDetail> {\n    this.ensureConfigured();\n    return await this.request<ExotelCallDetail>(`/Calls/${callSid}.json`);\n  }\n\n  async listCalls(params?: {\n    StartTime?: string;\n    EndTime?: string;\n    From?: string;\n    To?: string;\n    Status?: string;\n    PageSize?: number;\n    Page?: number;\n  }): Promise<{ Calls: ExotelCallDetail[] }> {\n    this.ensureConfigured();\n    const queryParams = params ? `?${this.buildFormData(params)}` : \"\";\n    return await this.request<{ Calls: ExotelCallDetail[] }>(\n      `/Calls.json${queryParams}`\n    );\n  }\n\n  async getPhoneNumbers(): Promise<ExotelPhoneNumber[]> {\n    this.ensureConfigured();\n    const response = await this.request<{ IncomingPhoneNumbers: ExotelPhoneNumber[] }>(\n      \"/IncomingPhoneNumbers.json\"\n    );\n    return response.IncomingPhoneNumbers;\n  }\n\n  async getPhoneNumber(phoneSid: string): Promise<ExotelPhoneNumber> {\n    this.ensureConfigured();\n    return await this.request<ExotelPhoneNumber>(\n      `/IncomingPhoneNumbers/${phoneSid}.json`\n    );\n  }\n\n  async updatePhoneNumber(\n    phoneSid: string,\n    updates: {\n      FriendlyName?: string;\n      VoiceUrl?: string;\n      VoiceMethod?: string;\n      StatusCallback?: string;\n    }\n  ): Promise<ExotelPhoneNumber> {\n    this.ensureConfigured();\n    const formData = this.buildFormData(updates);\n\n    return await this.request<ExotelPhoneNumber>(\n      `/IncomingPhoneNumbers/${phoneSid}.json`,\n      {\n        method: \"POST\",\n        body: formData,\n      }\n    );\n  }\n\n  async getRecording(callSid: string): Promise<string | null> {\n    try {\n      const callDetails = await this.getCallDetails(callSid);\n      return callDetails.RecordingUrl;\n    } catch (error) {\n      console.error(\"Error fetching recording:\", error);\n      return null;\n    }\n  }\n}\n\nexport const exotelClient = new ExotelClient();\n","size_bytes":6399},"replit.md":{"content":"# AI Voice Agent Platform\n\n## Overview\n\nThis is a multi-tenant SaaS platform for AI-powered voice and chat automation. The system enables organizations to manage AI voice agents, make automated calls, track leads, manage campaigns, and analyze performance through role-based dashboards. The platform integrates with third-party services like Bolna (AI voice agents), Exotel (telephony), and OpenAI (GPT-5 for AI summaries and analysis).\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Technology Stack:**\n- React 18 with TypeScript\n- Vite as the build tool and dev server\n- Wouter for client-side routing (lightweight alternative to React Router)\n- TanStack Query v5 for server state management and data fetching\n- Shadcn UI component library with Radix UI primitives\n- Tailwind CSS for styling with a strict minimal black & white theme\n\n**Design System:**\n- Strict monochrome aesthetic (pure black, white, and grayscale only)\n- Light mode: white backgrounds (#FFFFFF) with black primary actions (#000000)\n- Dark mode: true black backgrounds (#000000) with white primary actions (#FFFFFF)\n- Inter font family for all typography\n- No decorative colors - hierarchy created through typography and whitespace\n- Fully responsive with mobile-first approach\n\n**State Management:**\n- TanStack Query for all server data with aggressive caching (staleTime: Infinity)\n- React Context for theme management (light/dark mode toggle)\n- WebSocket context for real-time updates via Socket.IO\n- Custom hooks pattern for auth (`useAuth`), mobile detection (`useIsMobile`), and toast notifications\n\n**Key Architectural Decisions:**\n- Single-page application with client-side routing to avoid full page reloads\n- Optimistic UI updates with mutation callbacks to invalidate queries\n- Role-based page access controlled through user.role from auth context\n- Virtual scrolling (TanStack Virtual) for large datasets like channel partners (60,000+ records)\n- Real-time updates via WebSocket for live call status and metrics\n- Dashboard Quick Actions with query parameter-based dialog auto-opening and clean URL handling\n\n### Backend Architecture\n\n**Technology Stack:**\n- Node.js with Express.js server\n- TypeScript throughout for type safety\n- Drizzle ORM for database operations\n- Neon serverless PostgreSQL database\n- OpenID Connect (OIDC) with Replit Auth for authentication\n- Socket.IO for WebSocket communication\n\n**Authentication & Multi-tenancy:**\n- Replit Auth (OpenID Connect) for SSO - auto-provisions users on first login\n- Session-based auth with PostgreSQL session store (connect-pg-simple)\n- Organization-based tenant isolation - all queries filtered by organizationId\n- Middleware ensures authenticated routes require valid session\n- User roles: admin, agent_manager, analyst, developer\n\n**API Design:**\n- RESTful API structure with `/api/*` routes\n- Request/response pattern: JSON bodies with credentials included\n- Error handling: 401 redirects to login, other errors return JSON with message\n- File upload support via multer for CSV/Excel lead and partner imports\n- Query invalidation pattern: mutations trigger queryClient.invalidateQueries\n\n**Database Schema (Drizzle ORM):**\n- Multi-tenant isolation via `organizationId` foreign key on all tables\n- Core tables: users, organizations, aiAgents, phoneNumbers, leads, calls, knowledgeBase, usageTracking\n- Relations defined using Drizzle relations API for type-safe joins\n- Timestamps (createdAt, updatedAt) on all tables with automatic defaults\n- Session storage table required for Replit Auth integration\n\n**Type Safety:**\n- Shared schema types between client and server in `/shared/schema.ts`\n- Zod schemas for runtime validation (createAiAgentSchema, etc.)\n- Drizzle insert/select types auto-generated from schema\n- Path aliases: `@/` for client, `@shared/` for shared code\n\n### External Dependencies\n\n**Third-Party Services:**\n\n1. **Bolna AI (Voice Agents):**\n   - API integration for creating and managing AI voice agents\n   - Agent configuration: model, provider, voice settings, tasks\n   - Outbound call initiation with agent_id and recipient phone number\n   - Requires BOLNA_API_KEY environment variable\n\n2. **Exotel (Telephony Provider):**\n   - Call initiation and management API\n   - Recording and transcript retrieval\n   - Webhook callbacks for call status updates\n   - Requires EXOTEL_API_KEY, EXOTEL_API_SECRET, EXOTEL_SID environment variables\n\n3. **OpenAI GPT-5:**\n   - AI-powered conversation summaries\n   - Lead qualification analysis\n   - Meeting summary generation\n   - Uses latest gpt-5 model (released August 7, 2025)\n   - Requires OPENAI_API_KEY environment variable\n\n4. **Neon Serverless PostgreSQL:**\n   - Managed PostgreSQL database with serverless architecture\n   - WebSocket support via ws library for connection pooling\n   - Requires DATABASE_URL environment variable\n   - Connection via @neondatabase/serverless package\n\n**Development Tools:**\n- Replit-specific plugins: vite-plugin-runtime-error-modal, vite-plugin-cartographer, vite-plugin-dev-banner (dev only)\n- Drizzle Kit for database migrations and schema push\n- ESBuild for production server bundling\n- TSX for development server hot-reload\n\n**File Processing:**\n- Papa Parse for CSV parsing (lead and partner uploads)\n- Multer for multipart/form-data file uploads\n- Support for CSV, XLSX, and XLS file formats\n\n**Real-time Communication:**\n- Socket.IO for WebSocket connections\n- Organization-scoped rooms for multi-tenant message isolation\n- Event types: call_status_update, new_lead, agent_update\n\n**Session Management:**\n- Express session with PostgreSQL storage\n- Cookie-based sessions with httpOnly flag\n- 7-day session TTL with automatic cleanup\n- Secure cookies in production (secure: true when NODE_ENV=production)\n\n## Features\n\n### Dashboard Quick Actions (Nov 18, 2025)\n**Implementation:**\n- Dashboard provides one-click shortcuts to create common resources\n- Quick Actions: Create Agent, Make Call, Add Knowledge\n- Uses query parameter navigation (e.g., `/agents?action=create`)\n- Auto-opens creation dialogs on destination pages\n- Robust URL cleanup preserves pathname and other query params using window.history.replaceState\n- Prevents back-button navigation loops\n- Supports sub-path deployments\n\n**Technical Details:**\n- Dashboard Quick Action buttons use wouter Link components with query parameters\n- Destination pages (AIAgents, CallHistory, KnowledgeBase) detect action parameter in useEffect\n- URL cleanup removes only the action parameter while preserving base path\n- Empty dependency array ensures effect runs once on mount\n- Architect-approved as production-ready","size_bytes":6702},"client/src/lib/useWebSocket.tsx":{"content":"import { createContext, useContext, useEffect, useRef, useState, ReactNode } from 'react';\nimport { io, Socket } from 'socket.io-client';\nimport { useQuery } from '@tanstack/react-query';\n\ninterface WebSocketContextValue {\n  socket: Socket | null;\n  isConnected: boolean;\n}\n\nconst WebSocketContext = createContext<WebSocketContextValue>({\n  socket: null,\n  isConnected: false,\n});\n\nexport function WebSocketProvider({ children }: { children: ReactNode }) {\n  const socketRef = useRef<Socket | null>(null);\n  const [isConnected, setIsConnected] = useState(false);\n\n  const { data: user } = useQuery({\n    queryKey: ['/api/auth/user'],\n  });\n\n  useEffect(() => {\n    // Wait for user data to be available\n    if (!user?.organizationId) {\n      // Disconnect if user logs out\n      if (socketRef.current) {\n        socketRef.current.disconnect();\n        socketRef.current = null;\n        setIsConnected(false);\n      }\n      return;\n    }\n\n    // Only create one socket connection\n    if (socketRef.current) {\n      // If socket exists but org changed, disconnect and reconnect\n      if (socketRef.current.connected) {\n        return;\n      }\n    }\n\n    // Connect to WebSocket server\n    const socket = io({\n      path: '/socket.io',\n      transports: ['websocket', 'polling'],\n    });\n\n    socketRef.current = socket;\n\n    socket.on('connect', () => {\n      console.log('WebSocket connected');\n      setIsConnected(true);\n      \n      // Join organization-specific room for multi-tenant isolation\n      if (user.organizationId) {\n        socket.emit('join:organization', user.organizationId);\n      }\n    });\n\n    socket.on('disconnect', () => {\n      console.log('WebSocket disconnected');\n      setIsConnected(false);\n    });\n\n    socket.on('connect_error', (error) => {\n      console.error('WebSocket connection error:', error);\n      setIsConnected(false);\n    });\n\n    return () => {\n      if (socket && user.organizationId) {\n        socket.emit('leave:organization', user.organizationId);\n        socket.disconnect();\n        socketRef.current = null;\n      }\n    };\n  }, [user]);\n\n  return (\n    <WebSocketContext.Provider value={{ socket: socketRef.current, isConnected }}>\n      {children}\n    </WebSocketContext.Provider>\n  );\n}\n\n// Hook to access the shared WebSocket connection\nexport function useWebSocket() {\n  const context = useContext(WebSocketContext);\n  if (context === undefined) {\n    throw new Error('useWebSocket must be used within a WebSocketProvider');\n  }\n  return context;\n}\n\n// Hook for listening to specific events\nexport function useWebSocketEvent<T = any>(\n  eventName: string,\n  handler: (data: T) => void\n) {\n  const { socket, isConnected } = useWebSocket();\n\n  useEffect(() => {\n    if (!socket || !isConnected) return;\n\n    socket.on(eventName, handler);\n\n    return () => {\n      socket.off(eventName, handler);\n    };\n  }, [socket, isConnected, eventName, handler]);\n\n  return { isConnected };\n}\n","size_bytes":2935}},"version":2}